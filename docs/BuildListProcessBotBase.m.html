<!doctype html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />

    <title>BuildListProcessBotBase API documentation</title>
    <meta name="description" content="" />

  <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,300' rel='stylesheet' type='text/css'>
  
  <style type="text/css">
  
* {
  box-sizing: border-box;
}
/*! normalize.css v1.1.1 | MIT License | git.io/normalize */

/* ==========================================================================
   HTML5 display definitions
   ========================================================================== */

/**
 * Correct `block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

article,
aside,
details,
figcaption,
figure,
footer,
header,
hgroup,
main,
nav,
section,
summary {
    display: block;
}

/**
 * Correct `inline-block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

audio,
canvas,
video {
    display: inline-block;
    *display: inline;
    *zoom: 1;
}

/**
 * Prevent modern browsers from displaying `audio` without controls.
 * Remove excess height in iOS 5 devices.
 */

audio:not([controls]) {
    display: none;
    height: 0;
}

/**
 * Address styling not present in IE 7/8/9, Firefox 3, and Safari 4.
 * Known issue: no IE 6 support.
 */

[hidden] {
    display: none;
}

/* ==========================================================================
   Base
   ========================================================================== */

/**
 * 1. Prevent system color scheme's background color being used in Firefox, IE,
 *    and Opera.
 * 2. Prevent system color scheme's text color being used in Firefox, IE, and
 *    Opera.
 * 3. Correct text resizing oddly in IE 6/7 when body `font-size` is set using
 *    `em` units.
 * 4. Prevent iOS text size adjust after orientation change, without disabling
 *    user zoom.
 */

html {
    background: #fff; /* 1 */
    color: #000; /* 2 */
    font-size: 100%; /* 3 */
    -webkit-text-size-adjust: 100%; /* 4 */
    -ms-text-size-adjust: 100%; /* 4 */
}

/**
 * Address `font-family` inconsistency between `textarea` and other form
 * elements.
 */

html,
button,
input,
select,
textarea {
    font-family: sans-serif;
}

/**
 * Address margins handled incorrectly in IE 6/7.
 */

body {
    margin: 0;
}

/* ==========================================================================
   Links
   ========================================================================== */

/**
 * Address `outline` inconsistency between Chrome and other browsers.
 */

a:focus {
    outline: thin dotted;
}

/**
 * Improve readability when focused and also mouse hovered in all browsers.
 */

a:active,
a:hover {
    outline: 0;
}

/* ==========================================================================
   Typography
   ========================================================================== */

/**
 * Address font sizes and margins set differently in IE 6/7.
 * Address font sizes within `section` and `article` in Firefox 4+, Safari 5,
 * and Chrome.
 */

h1 {
    font-size: 2em;
    margin: 0.67em 0;
}

h2 {
    font-size: 1.5em;
    margin: 0.83em 0;
}

h3 {
    font-size: 1.17em;
    margin: 1em 0;
}

h4 {
    font-size: 1em;
    margin: 1.33em 0;
}

h5 {
    font-size: 0.83em;
    margin: 1.67em 0;
}

h6 {
    font-size: 0.67em;
    margin: 2.33em 0;
}

/**
 * Address styling not present in IE 7/8/9, Safari 5, and Chrome.
 */

abbr[title] {
    border-bottom: 1px dotted;
}

/**
 * Address style set to `bolder` in Firefox 3+, Safari 4/5, and Chrome.
 */

b,
strong {
    font-weight: bold;
}

blockquote {
    margin: 1em 40px;
}

/**
 * Address styling not present in Safari 5 and Chrome.
 */

dfn {
    font-style: italic;
}

/**
 * Address differences between Firefox and other browsers.
 * Known issue: no IE 6/7 normalization.
 */

hr {
    -moz-box-sizing: content-box;
    box-sizing: content-box;
    height: 0;
}

/**
 * Address styling not present in IE 6/7/8/9.
 */

mark {
    background: #ff0;
    color: #000;
}

/**
 * Address margins set differently in IE 6/7.
 */

p,
pre {
    margin: 1em 0;
}

/**
 * Correct font family set oddly in IE 6, Safari 4/5, and Chrome.
 */

code,
kbd,
pre,
samp {
    font-family: monospace, serif;
    _font-family: 'courier new', monospace;
    font-size: 1em;
}

/**
 * Improve readability of pre-formatted text in all browsers.
 */

pre {
    white-space: pre;
    white-space: pre-wrap;
    word-wrap: break-word;
}

/**
 * Address CSS quotes not supported in IE 6/7.
 */

q {
    quotes: none;
}

/**
 * Address `quotes` property not supported in Safari 4.
 */

q:before,
q:after {
    content: '';
    content: none;
}

/**
 * Address inconsistent and variable font size in all browsers.
 */

small {
    font-size: 80%;
}

/**
 * Prevent `sub` and `sup` affecting `line-height` in all browsers.
 */

sub,
sup {
    font-size: 75%;
    line-height: 0;
    position: relative;
    vertical-align: baseline;
}

sup {
    top: -0.5em;
}

sub {
    bottom: -0.25em;
}

/* ==========================================================================
   Lists
   ========================================================================== */

/**
 * Address margins set differently in IE 6/7.
 */

dl,
menu,
ol,
ul {
    margin: 1em 0;
}

dd {
    margin: 0 0 0 40px;
}

/**
 * Address paddings set differently in IE 6/7.
 */

menu,
ol,
ul {
    padding: 0 0 0 40px;
}

/**
 * Correct list images handled incorrectly in IE 7.
 */

nav ul,
nav ol {
    list-style: none;
    list-style-image: none;
}

/* ==========================================================================
   Embedded content
   ========================================================================== */

/**
 * 1. Remove border when inside `a` element in IE 6/7/8/9 and Firefox 3.
 * 2. Improve image quality when scaled in IE 7.
 */

img {
    border: 0; /* 1 */
    -ms-interpolation-mode: bicubic; /* 2 */
}

/**
 * Correct overflow displayed oddly in IE 9.
 */

svg:not(:root) {
    overflow: hidden;
}

/* ==========================================================================
   Figures
   ========================================================================== */

/**
 * Address margin not present in IE 6/7/8/9, Safari 5, and Opera 11.
 */

figure {
    margin: 0;
}

/* ==========================================================================
   Forms
   ========================================================================== */

/**
 * Correct margin displayed oddly in IE 6/7.
 */

form {
    margin: 0;
}

/**
 * Define consistent border, margin, and padding.
 */

fieldset {
    border: 1px solid #c0c0c0;
    margin: 0 2px;
    padding: 0.35em 0.625em 0.75em;
}

/**
 * 1. Correct color not being inherited in IE 6/7/8/9.
 * 2. Correct text not wrapping in Firefox 3.
 * 3. Correct alignment displayed oddly in IE 6/7.
 */

legend {
    border: 0; /* 1 */
    padding: 0;
    white-space: normal; /* 2 */
    *margin-left: -7px; /* 3 */
}

/**
 * 1. Correct font size not being inherited in all browsers.
 * 2. Address margins set differently in IE 6/7, Firefox 3+, Safari 5,
 *    and Chrome.
 * 3. Improve appearance and consistency in all browsers.
 */

button,
input,
select,
textarea {
    font-size: 100%; /* 1 */
    margin: 0; /* 2 */
    vertical-align: baseline; /* 3 */
    *vertical-align: middle; /* 3 */
}

/**
 * Address Firefox 3+ setting `line-height` on `input` using `!important` in
 * the UA stylesheet.
 */

button,
input {
    line-height: normal;
}

/**
 * Address inconsistent `text-transform` inheritance for `button` and `select`.
 * All other form control elements do not inherit `text-transform` values.
 * Correct `button` style inheritance in Chrome, Safari 5+, and IE 6+.
 * Correct `select` style inheritance in Firefox 4+ and Opera.
 */

button,
select {
    text-transform: none;
}

/**
 * 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio`
 *    and `video` controls.
 * 2. Correct inability to style clickable `input` types in iOS.
 * 3. Improve usability and consistency of cursor style between image-type
 *    `input` and others.
 * 4. Remove inner spacing in IE 7 without affecting normal text inputs.
 *    Known issue: inner spacing remains in IE 6.
 */

button,
html input[type="button"], /* 1 */
input[type="reset"],
input[type="submit"] {
    -webkit-appearance: button; /* 2 */
    cursor: pointer; /* 3 */
    *overflow: visible;  /* 4 */
}

/**
 * Re-set default cursor for disabled elements.
 */

button[disabled],
html input[disabled] {
    cursor: default;
}

/**
 * 1. Address box sizing set to content-box in IE 8/9.
 * 2. Remove excess padding in IE 8/9.
 * 3. Remove excess padding in IE 7.
 *    Known issue: excess padding remains in IE 6.
 */

input[type="checkbox"],
input[type="radio"] {
    box-sizing: border-box; /* 1 */
    padding: 0; /* 2 */
    *height: 13px; /* 3 */
    *width: 13px; /* 3 */
}

/**
 * 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome.
 * 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome
 *    (include `-moz` to future-proof).
 */

input[type="search"] {
    -webkit-appearance: textfield; /* 1 */
    -moz-box-sizing: content-box;
    -webkit-box-sizing: content-box; /* 2 */
    box-sizing: content-box;
}

/**
 * Remove inner padding and search cancel button in Safari 5 and Chrome
 * on OS X.
 */

input[type="search"]::-webkit-search-cancel-button,
input[type="search"]::-webkit-search-decoration {
    -webkit-appearance: none;
}

/**
 * Remove inner padding and border in Firefox 3+.
 */

button::-moz-focus-inner,
input::-moz-focus-inner {
    border: 0;
    padding: 0;
}

/**
 * 1. Remove default vertical scrollbar in IE 6/7/8/9.
 * 2. Improve readability and alignment in all browsers.
 */

textarea {
    overflow: auto; /* 1 */
    vertical-align: top; /* 2 */
}

/* ==========================================================================
   Tables
   ========================================================================== */

/**
 * Remove most spacing between table cells.
 */

table {
    border-collapse: collapse;
    border-spacing: 0;
}

  </style>

  <style type="text/css">
  
  html, body {
    margin: 0;
    padding: 0;
    min-height: 100%;
  }
  body {
    background: #fff;
    font-family: "Source Sans Pro", "Helvetica Neueue", Helvetica, sans;
    font-weight: 300;
    font-size: 16px;
    line-height: 1.6em;
  }
  #content {
    width: 70%;
    max-width: 850px;
    float: left;
    padding: 30px 60px;
    border-left: 1px solid #ddd;
  }
  #sidebar {
    width: 25%;
    float: left;
    padding: 30px;
    overflow: hidden;
  }
  #nav {
    font-size: 130%;
    margin: 0 0 15px 0;
  }

  #top {
    display: block;
    position: fixed;
    bottom: 5px;
    left: 5px;
    font-size: .85em;
    text-transform: uppercase;
  }

  #footer {
    font-size: .75em;
    padding: 5px 30px;
    border-top: 1px solid #ddd;
    text-align: right;
  }
    #footer p {
      margin: 0 0 0 30px;
      display: inline-block;
    }

  h1, h2, h3, h4, h5 {
    font-weight: 300;
  }
  h1 {
    font-size: 2.5em;
    line-height: 1.1em;
    margin: 0 0 .50em 0;
  }

  h2 {
    font-size: 1.75em;
    margin: 1em 0 .50em 0;
  }

  h3 {
    margin: 25px 0 10px 0;
  }

  h4 {
    margin: 0;
    font-size: 105%;
  }

  a {
    color: #058;
    text-decoration: none;
    transition: color .3s ease-in-out;
  }

  a:hover {
    color: #e08524;
    transition: color .3s ease-in-out;
  }

  pre, code, .mono, .name {
    font-family: "Ubuntu Mono", "Cousine", "DejaVu Sans Mono", monospace;
  }

  .title .name {
    font-weight: bold;
  }
  .section-title {
    margin-top: 2em;
  }
  .ident {
    color: #900;
  }

  code {
    background: #f9f9f9;
  } 

  pre {
    background: #fefefe;
    border: 1px solid #ddd;
    box-shadow: 2px 2px 0 #f3f3f3;
    margin: 0 30px;
    padding: 15px 30px;
  }

  .codehilite {
    margin: 0 30px 10px 30px;
  }

    .codehilite pre {
      margin: 0;
    }
    .codehilite .err { background: #ff3300; color: #fff !important; } 

  table#module-list {
    font-size: 110%;
  }

    table#module-list tr td:first-child {
      padding-right: 10px;
      white-space: nowrap;
    }

    table#module-list td {
      vertical-align: top;
      padding-bottom: 8px;
    }

      table#module-list td p {
        margin: 0 0 7px 0;
      }

  .def {
    display: table;
  }

    .def p {
      display: table-cell;
      vertical-align: top;
      text-align: left;
    }

    .def p:first-child {
      white-space: nowrap;
    }

    .def p:last-child {
      width: 100%;
    }


  #index {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }
    ul#index .class_name {
      /* font-size: 110%; */
      font-weight: bold;
    }
    #index ul {
      margin: 0;
    }

  .item {
    margin: 0 0 15px 0;
  }

    .item .class {
      margin: 0 0 25px 30px;
    }

      .item .class ul.class_list {
        margin: 0 0 20px 0;
      }

    .item .name {
      background: #fafafa;
      margin: 0;
      font-weight: bold;
      padding: 5px 10px;
      border-radius: 3px;
      display: inline-block;
      min-width: 40%;
    }
      .item .name:hover {
        background: #f6f6f6;
      }

    .item .empty_desc {
      margin: 0 0 5px 0;
      padding: 0;
    }

    .item .inheritance {
      margin: 3px 0 0 30px;
    }

    .item .inherited {
      color: #666;
    }

    .item .desc {
      padding: 0 8px;
      margin: 0;
    }

      .item .desc p {
        margin: 0 0 10px 0;
      }

    .source_cont {
      margin: 0;
      padding: 0;
    }

    .source_link a {
      background: #ffc300;
      font-weight: 400;
      font-size: .75em;
      text-transform: uppercase;
      color: #fff;
      text-shadow: 1px 1px 0 #f4b700;
      
      padding: 3px 8px;
      border-radius: 2px;
      transition: background .3s ease-in-out;
    }
      .source_link a:hover {
        background: #FF7200;
        text-shadow: none;
        transition: background .3s ease-in-out;
      }

    .source {
      display: none;
      max-height: 600px;
      overflow-y: scroll;
      margin-bottom: 15px;
    }

      .source .codehilite {
        margin: 0;
      }

  .desc h1, .desc h2, .desc h3 {
    font-size: 100% !important;
  }
  .clear {
    clear: both;
  }

  @media all and (max-width: 950px) {
    #sidebar {
      width: 35%;
    }
    #content {
      width: 65%;
    }
  }
  @media all and (max-width: 650px) {
    #top {
      display: none;
    }
    #sidebar {
      float: none;
      width: auto;
    }
    #content {
      float: none;
      width: auto;
      padding: 30px;
    }

    #index ul {
      padding: 0;
      margin-bottom: 15px;
    }
    #index ul li {
      display: inline-block;
      margin-right: 30px;
    }
    #footer {
      text-align: left;
    }
    #footer p {
      display: block;
      margin: inherit;
    }
  }

  /*****************************/

  </style>

  <style type="text/css">
  pre { line-height: 125%; margin: 0; }
td.linenos pre { color: #000000; background-color: #f0f0f0; padding: 0 5px 0 5px; }
span.linenos { color: #000000; background-color: #f0f0f0; padding: 0 5px 0 5px; }
td.linenos pre.special { color: #000000; background-color: #ffffc0; padding: 0 5px 0 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding: 0 5px 0 5px; }
.codehilite .hll { background-color: #ffffcc }
.codehilite { background: #f8f8f8; }
.codehilite .c { color: #408080; font-style: italic } /* Comment */
.codehilite .err { border: 1px solid #FF0000 } /* Error */
.codehilite .k { color: #008000; font-weight: bold } /* Keyword */
.codehilite .o { color: #666666 } /* Operator */
.codehilite .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.codehilite .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.codehilite .cp { color: #BC7A00 } /* Comment.Preproc */
.codehilite .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.codehilite .c1 { color: #408080; font-style: italic } /* Comment.Single */
.codehilite .cs { color: #408080; font-style: italic } /* Comment.Special */
.codehilite .gd { color: #A00000 } /* Generic.Deleted */
.codehilite .ge { font-style: italic } /* Generic.Emph */
.codehilite .gr { color: #FF0000 } /* Generic.Error */
.codehilite .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.codehilite .gi { color: #00A000 } /* Generic.Inserted */
.codehilite .go { color: #888888 } /* Generic.Output */
.codehilite .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.codehilite .gs { font-weight: bold } /* Generic.Strong */
.codehilite .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.codehilite .gt { color: #0044DD } /* Generic.Traceback */
.codehilite .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.codehilite .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.codehilite .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.codehilite .kp { color: #008000 } /* Keyword.Pseudo */
.codehilite .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.codehilite .kt { color: #B00040 } /* Keyword.Type */
.codehilite .m { color: #666666 } /* Literal.Number */
.codehilite .s { color: #BA2121 } /* Literal.String */
.codehilite .na { color: #7D9029 } /* Name.Attribute */
.codehilite .nb { color: #008000 } /* Name.Builtin */
.codehilite .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.codehilite .no { color: #880000 } /* Name.Constant */
.codehilite .nd { color: #AA22FF } /* Name.Decorator */
.codehilite .ni { color: #999999; font-weight: bold } /* Name.Entity */
.codehilite .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.codehilite .nf { color: #0000FF } /* Name.Function */
.codehilite .nl { color: #A0A000 } /* Name.Label */
.codehilite .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.codehilite .nt { color: #008000; font-weight: bold } /* Name.Tag */
.codehilite .nv { color: #19177C } /* Name.Variable */
.codehilite .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.codehilite .w { color: #bbbbbb } /* Text.Whitespace */
.codehilite .mb { color: #666666 } /* Literal.Number.Bin */
.codehilite .mf { color: #666666 } /* Literal.Number.Float */
.codehilite .mh { color: #666666 } /* Literal.Number.Hex */
.codehilite .mi { color: #666666 } /* Literal.Number.Integer */
.codehilite .mo { color: #666666 } /* Literal.Number.Oct */
.codehilite .sa { color: #BA2121 } /* Literal.String.Affix */
.codehilite .sb { color: #BA2121 } /* Literal.String.Backtick */
.codehilite .sc { color: #BA2121 } /* Literal.String.Char */
.codehilite .dl { color: #BA2121 } /* Literal.String.Delimiter */
.codehilite .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.codehilite .s2 { color: #BA2121 } /* Literal.String.Double */
.codehilite .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.codehilite .sh { color: #BA2121 } /* Literal.String.Heredoc */
.codehilite .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.codehilite .sx { color: #008000 } /* Literal.String.Other */
.codehilite .sr { color: #BB6688 } /* Literal.String.Regex */
.codehilite .s1 { color: #BA2121 } /* Literal.String.Single */
.codehilite .ss { color: #19177C } /* Literal.String.Symbol */
.codehilite .bp { color: #008000 } /* Name.Builtin.Pseudo */
.codehilite .fm { color: #0000FF } /* Name.Function.Magic */
.codehilite .vc { color: #19177C } /* Name.Variable.Class */
.codehilite .vg { color: #19177C } /* Name.Variable.Global */
.codehilite .vi { color: #19177C } /* Name.Variable.Instance */
.codehilite .vm { color: #19177C } /* Name.Variable.Magic */
.codehilite .il { color: #666666 } /* Literal.Number.Integer.Long */
  </style>

  <style type="text/css">
  
/* ==========================================================================
   EXAMPLE Media Queries for Responsive Design.
   These examples override the primary ('mobile first') styles.
   Modify as content requires.
   ========================================================================== */

@media only screen and (min-width: 35em) {
    /* Style adjustments for viewports that meet the condition */
}

@media print,
       (-o-min-device-pixel-ratio: 5/4),
       (-webkit-min-device-pixel-ratio: 1.25),
       (min-resolution: 120dpi) {
    /* Style adjustments for high resolution devices */
}

/* ==========================================================================
   Print styles.
   Inlined to avoid required HTTP connection: h5bp.com/r
   ========================================================================== */

@media print {
    * {
        background: transparent !important;
        color: #000 !important; /* Black prints faster: h5bp.com/s */
        box-shadow: none !important;
        text-shadow: none !important;
    }

    a,
    a:visited {
        text-decoration: underline;
    }

    a[href]:after {
        content: " (" attr(href) ")";
    }

    abbr[title]:after {
        content: " (" attr(title) ")";
    }

    /*
     * Don't show links for images, or javascript/internal links
     */

    .ir a:after,
    a[href^="javascript:"]:after,
    a[href^="#"]:after {
        content: "";
    }

    pre,
    blockquote {
        border: 1px solid #999;
        page-break-inside: avoid;
    }

    thead {
        display: table-header-group; /* h5bp.com/t */
    }

    tr,
    img {
        page-break-inside: avoid;
    }

    img {
        max-width: 100% !important;
    }

    @page {
        margin: 0.5cm;
    }

    p,
    h2,
    h3 {
        orphans: 3;
        widows: 3;
    }

    h2,
    h3 {
        page-break-after: avoid;
    }
}

  </style>

  <script type="text/javascript">
  function toggle(id, $link) {
    $node = document.getElementById(id);
    if (!$node)
    return;
    if (!$node.style.display || $node.style.display == 'none') {
    $node.style.display = 'block';
    $link.innerHTML = 'Hide source &nequiv;';
    } else {
    $node.style.display = 'none';
    $link.innerHTML = 'Show source &equiv;';
    }
  }
  </script>
</head>
<body>
<a href="#" id="top">Top</a>

<div id="container">
    
  
  <div id="sidebar">
    <h1>Index</h1>
    <ul id="index">
    <li class="set"><h3><a href="#header-variables">Module variables</a></h3>
      
  <ul>
    <li class="mono"><a href="#BuildListProcessBotBase.ALL_GAS">ALL_GAS</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BASE_BUILDINGS">BASE_BUILDINGS</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.CONVERT_TO_ID">CONVERT_TO_ID</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.EQUIVALENTS_FOR_TECH_PROGRESS">EQUIVALENTS_FOR_TECH_PROGRESS</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.IS_STRUCTURE">IS_STRUCTURE</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.PROTOSS_TECH_REQUIREMENT">PROTOSS_TECH_REQUIREMENT</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.TERRAN_TECH_REQUIREMENT">TERRAN_TECH_REQUIREMENT</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.UNIT_TRAINED_FROM">UNIT_TRAINED_FROM</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.ZERG_TECH_REQUIREMENT">ZERG_TECH_REQUIREMENT</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.raceBasicTownhall">raceBasicTownhall</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.race_gas">race_gas</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.race_supplyUnit">race_supplyUnit</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.race_townhalls">race_townhalls</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.race_worker">race_worker</a></li>
  </ul>

    </li>


    <li class="set"><h3><a href="#header-classes">Classes</a></h3>
      <ul>
        <li class="mono">
        <span class="class_name"><a href="#BuildListProcessBotBase.BuildListProcessBotBase">BuildListProcessBotBase</a></span>
        
          
  <ul>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.__init__">__init__</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.alert">alert</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.already_pending">already_pending</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.already_pending_upgrade">already_pending_upgrade</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.attackMapCenterWithArmy">attackMapCenterWithArmy</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.build">build</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.buildBase">buildBase</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.buildGasBuilding">buildGasBuilding</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.buildGasBuildingAtTownhall">buildGasBuildingAtTownhall</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.calculate_cost">calculate_cost</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.calculate_supply_cost">calculate_supply_cost</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.calculate_unit_value">calculate_unit_value</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.can_afford">can_afford</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.can_cast">can_cast</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.can_feed">can_feed</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.can_place">can_place</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.can_place_single">can_place_single</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.chat_send">chat_send</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.checkAndAdvance">checkAndAdvance</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.checkBuildListCompleted">checkBuildListCompleted</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.checkCosts">checkCosts</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.checkIfProducerExists">checkIfProducerExists</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.checkIfTechRequirementFulfilled">checkIfTechRequirementFulfilled</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.checkPreconditions">checkPreconditions</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.computeExpansionLocations">computeExpansionLocations</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.convert_tuple_to_numpy_array">convert_tuple_to_numpy_array</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.distance_math_hypot">distance_math_hypot</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.distance_math_hypot_squared">distance_math_hypot_squared</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.distribute_workers">distribute_workers</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.do">do</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.expand_now">expand_now</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.fillExpansionLocations">fillExpansionLocations</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.findNextExpansion">findNextExpansion</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.find_placement">find_placement</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.finishedCurrentTask">finishedCurrentTask</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.getCorrespondingStartLocation">getCorrespondingStartLocation</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.getLocationFromStartLocation">getLocationFromStartLocation</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.getProducerIdsForCurrentTask">getProducerIdsForCurrentTask</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.getProducerUnitsForCurrentTask">getProducerUnitsForCurrentTask</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.getWorker">getWorker</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.get_available_abilities">get_available_abilities</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.get_next_expansion">get_next_expansion</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.get_terrain_height">get_terrain_height</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.get_terrain_z_height">get_terrain_z_height</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.has_creep">has_creep</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.in_map_bounds">in_map_bounds</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.in_pathing_grid">in_pathing_grid</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.in_placement_grid">in_placement_grid</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.isWorker">isWorker</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.is_visible">is_visible</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.issue_events">issue_events</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.myWorkerDistribution">myWorkerDistribution</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.onStartBase">onStartBase</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.onStepBase">onStepBase</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.on_before_start">on_before_start</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.on_building_construction_complete">on_building_construction_complete</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.on_building_construction_started">on_building_construction_started</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.on_end">on_end</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.on_enemy_unit_entered_vision">on_enemy_unit_entered_vision</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.on_enemy_unit_left_vision">on_enemy_unit_left_vision</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.on_start">on_start</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.on_step">on_step</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.on_unit_created">on_unit_created</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.on_unit_destroyed">on_unit_destroyed</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.on_unit_took_damage">on_unit_took_damage</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.on_unit_type_changed">on_unit_type_changed</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.on_upgrade_complete">on_upgrade_complete</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.prepareBuildListCompletedCheck">prepareBuildListCompletedCheck</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.prevent_double_actions">prevent_double_actions</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.raceSpecificStructureCompletedIgnore">raceSpecificStructureCompletedIgnore</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.raceSpecificUnitAndStructureCreations">raceSpecificUnitAndStructureCreations</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.raceSpecificUnitCompletedIgnore">raceSpecificUnitCompletedIgnore</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.research">research</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.scanBuildList">scanBuildList</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.select_build_worker">select_build_worker</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.setSelfStartLocation">setSelfStartLocation</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.square_to_condensed">square_to_condensed</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.structure_type_build_progress">structure_type_build_progress</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.synchronous_do">synchronous_do</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.tech_requirement_progress">tech_requirement_progress</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.train">train</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.unitToId">unitToId</a></li>
    <li class="mono"><a href="#BuildListProcessBotBase.BuildListProcessBotBase.worker_en_route_to_build">worker_en_route_to_build</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#BuildListProcessBotBase.Player">Player</a></span>
        
        </li>
        <li class="mono">
        <span class="class_name"><a href="#BuildListProcessBotBase.Winner">Winner</a></span>
        
        </li>
      </ul>
    </li>

    </ul>
  </div>

    <article id="content">
      
  

  


  <header id="section-intro">
  <h1 class="title"><span class="name">BuildListProcessBotBase</span> module</h1>
  
  
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase" class="source">
    <div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Union</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Set</span>
<span class="kn">from</span> <span class="nn">enum</span> <span class="kn">import</span> <span class="n">Enum</span>
<span class="kn">import</span> <span class="nn">threading</span>

<span class="kn">import</span> <span class="nn">sc2</span>
<span class="kn">from</span> <span class="nn">sc2</span> <span class="kn">import</span> <span class="n">run_game</span><span class="p">,</span> <span class="n">maps</span><span class="p">,</span> <span class="n">Race</span><span class="p">,</span> <span class="n">Difficulty</span>
<span class="kn">from</span> <span class="nn">sc2.player</span> <span class="kn">import</span> <span class="n">Bot</span><span class="p">,</span> <span class="n">Computer</span>
<span class="kn">from</span> <span class="nn">sc2.units</span> <span class="kn">import</span> <span class="n">Units</span>
<span class="kn">from</span> <span class="nn">sc2.unit</span> <span class="kn">import</span> <span class="n">Unit</span>
<span class="kn">from</span> <span class="nn">sc2.dicts.unit_trained_from</span> <span class="kn">import</span> <span class="n">UNIT_TRAINED_FROM</span>
<span class="kn">from</span> <span class="nn">sc2.game_data</span> <span class="kn">import</span> <span class="n">AbilityData</span><span class="p">,</span> <span class="n">GameData</span><span class="p">,</span> <span class="n">UnitTypeData</span>
<span class="kn">from</span> <span class="nn">sc2.data</span> <span class="kn">import</span> <span class="n">race_worker</span>
<span class="kn">from</span> <span class="nn">sc2.data</span> <span class="kn">import</span> <span class="n">race_townhalls</span>
<span class="kn">from</span> <span class="nn">sc2.data</span> <span class="kn">import</span> <span class="n">race_gas</span>
<span class="kn">from</span> <span class="nn">sc2.data</span> <span class="kn">import</span> <span class="n">Race</span>
<span class="kn">from</span> <span class="nn">sc2.position</span> <span class="kn">import</span> <span class="n">Point2</span><span class="p">,</span> <span class="n">Point3</span>
<span class="kn">from</span> <span class="nn">sc2.ids.ability_id</span> <span class="kn">import</span> <span class="n">AbilityId</span>
<span class="kn">from</span> <span class="nn">sc2.ids.unit_typeid</span> <span class="kn">import</span> <span class="n">UnitTypeId</span>
<span class="kn">from</span> <span class="nn">sc2.ids.upgrade_id</span> <span class="kn">import</span> <span class="n">UpgradeId</span>
<span class="kn">from</span> <span class="nn">sc2.constants</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">IS_STRUCTURE</span><span class="p">,</span>
    <span class="n">TERRAN_TECH_REQUIREMENT</span><span class="p">,</span>
    <span class="n">PROTOSS_TECH_REQUIREMENT</span><span class="p">,</span>
    <span class="n">ZERG_TECH_REQUIREMENT</span><span class="p">,</span>
    <span class="n">EQUIVALENTS_FOR_TECH_PROGRESS</span><span class="p">,</span>
    <span class="n">ALL_GAS</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">BuildListProcessorDicts</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">BASE_BUILDINGS</span><span class="p">,</span>
    <span class="n">CONVERT_TO_ID</span><span class="p">,</span>
    <span class="n">StartLocation</span>
<span class="p">)</span>

<span class="c1"># Definitions</span>
<span class="c1"># ----------------------------------------</span>


<span class="n">race_supplyUnit</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Race</span><span class="p">,</span> <span class="n">UnitTypeId</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">Race</span><span class="o">.</span><span class="n">Protoss</span><span class="p">:</span> <span class="n">UnitTypeId</span><span class="o">.</span><span class="n">PYLON</span><span class="p">,</span>
    <span class="n">Race</span><span class="o">.</span><span class="n">Terran</span><span class="p">:</span> <span class="n">UnitTypeId</span><span class="o">.</span><span class="n">SUPPLYDEPOT</span><span class="p">,</span>
    <span class="n">Race</span><span class="o">.</span><span class="n">Zerg</span><span class="p">:</span> <span class="n">UnitTypeId</span><span class="o">.</span><span class="n">OVERLORD</span><span class="p">,</span>
<span class="p">}</span>


<span class="n">raceBasicTownhall</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">Race</span><span class="o">.</span><span class="n">Terran</span><span class="p">:</span> <span class="n">UnitTypeId</span><span class="o">.</span><span class="n">COMMANDCENTER</span><span class="p">,</span>
    <span class="n">Race</span><span class="o">.</span><span class="n">Zerg</span><span class="p">:</span> <span class="n">UnitTypeId</span><span class="o">.</span><span class="n">HATCHERY</span><span class="p">,</span>
    <span class="n">Race</span><span class="o">.</span><span class="n">Protoss</span><span class="p">:</span> <span class="n">UnitTypeId</span><span class="o">.</span><span class="n">NEXUS</span>
<span class="p">}</span>

<span class="k">class</span> <span class="nc">Player</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A way of differentiating players.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">PLAYER_ONE</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">PLAYER_TWO</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>

<span class="k">class</span> <span class="nc">Winner</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A way of differentiating winners.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">PLAYER_ONE</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">PLAYER_TWO</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">UNKNOWN</span> <span class="o">=</span> <span class="mi">3</span>

<span class="c1"># Class</span>
<span class="c1"># ----------------------------------------</span>

<span class="k">class</span> <span class="nc">BuildListProcessBotBase</span><span class="p">(</span><span class="n">sc2</span><span class="o">.</span><span class="n">BotAI</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Base Class for different race specific bots.</span>

<span class="sd">    Combines functionality for clean race specific implementations. It</span>
<span class="sd">    combines buildlist processing capability and precondition checking. </span>
<span class="sd">    There is a lot more functionality in here to ease implementation.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Constructor</span>
    <span class="c1"># ----------------------------------------</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputBuildList</span><span class="p">,</span> <span class="n">player</span><span class="p">:</span> <span class="n">Player</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize the bot.</span>
<span class="sd">        </span>
<span class="sd">        Provide a buildlist as a list of build tasks. Strings must be</span>
<span class="sd">        written as in CONVERT_TO_ID from BuildListProcessorDicts.py.</span>

<span class="sd">        Player param must be either player one or player two.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># player as string</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">playerString</span> <span class="o">=</span> <span class="s2">&quot;UNKNOWN&quot;</span>
        <span class="k">if</span> <span class="n">player</span> <span class="o">==</span> <span class="n">Player</span><span class="o">.</span><span class="n">PLAYER_ONE</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">playerString</span> <span class="o">=</span> <span class="s2">&quot;PlayerOne&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">playerString</span> <span class="o">=</span> <span class="s2">&quot;PlayerTwo&quot;</span>
        <span class="c1"># logging</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;BuildListProcessBotBase&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">playerString</span><span class="p">)</span>
        <span class="c1"># player</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="p">:</span> <span class="n">Player</span> <span class="o">=</span> <span class="n">player</span>
        <span class="c1"># start locations of both players</span>
        <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_ONE_START_LOCATION</span><span class="p">:</span> <span class="n">StartLocation</span> <span class="o">=</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">UNKNOWN</span>
        <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_TWO_START_LOCATION</span><span class="p">:</span> <span class="n">StartLocation</span> <span class="o">=</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">UNKNOWN</span>
        <span class="c1"># my start location</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">startLocation</span><span class="p">:</span> <span class="n">StartLocation</span> <span class="o">=</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">UNKNOWN</span>
        <span class="c1"># communication between bots</span>
        <span class="c1"># will be set when player one has set his start location</span>
        <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_ONE_START_LOCATION_EVENT</span><span class="p">:</span> <span class="n">threading</span><span class="o">.</span><span class="n">Event</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>
        <span class="c1"># will be set when player two has set his start location</span>
        <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_TWO_START_LOCATION_EVENT</span><span class="p">:</span> <span class="n">threading</span><span class="o">.</span><span class="n">Event</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>
        <span class="c1"># expansion locations (different datastructures for computing the expansion locations)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">expansionLocationsComputed</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bottomExpansions</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">topExpansions</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">leftExpansions</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rightExpansions</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_ONE_EXPANSION_LOCATIONS</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_TWO_EXPANSION_LOCATIONS</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">expansionLocations</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="c1"># build list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buildList</span> <span class="o">=</span> <span class="n">inputBuildList</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span> <span class="o">=</span> <span class="n">UnitTypeId</span><span class="o">.</span><span class="n">NOTAUNIT</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">done</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remainingBuildTasks</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

        <span class="c1"># gas building locations</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">occupiedGeysers</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

        <span class="c1"># attacking</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attacking</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_ONE_READY_TO_ATTACK</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_TWO_READY_TO_ATTACK</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attackDone</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_ONE_ARMY_COUNT</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_TWO_ARMY_COUNT</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">WINNER</span><span class="p">:</span> <span class="n">Winner</span> <span class="o">=</span> <span class="n">Winner</span><span class="o">.</span><span class="n">UNKNOWN</span>


    <span class="c1"># Startup Preparation</span>
    <span class="c1"># ----------------------------------------</span>
    
    <span class="k">def</span> <span class="nf">setSelfStartLocation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Derive start location from coordinates.</span>

<span class="sd">        Sets the bots start location (enum StartLocation in BuildListProcesserDicts.py)</span>
<span class="sd">        based on the start location coordinates.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game_info</span><span class="o">.</span><span class="n">player_start_location</span><span class="o">.</span><span class="n">x</span> <span class="o">==</span> <span class="mf">24.5</span><span class="p">):</span>
            <span class="c1"># left side of map</span>
            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game_info</span><span class="o">.</span><span class="n">player_start_location</span><span class="o">.</span><span class="n">y</span> <span class="o">==</span> <span class="mf">22.5</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">startLocation</span> <span class="o">=</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">BOTTOM_LEFT</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">startLocation</span> <span class="o">=</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">TOP_LEFT</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># right side of map</span>
            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game_info</span><span class="o">.</span><span class="n">player_start_location</span><span class="o">.</span><span class="n">y</span> <span class="o">==</span> <span class="mf">22.5</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">startLocation</span> <span class="o">=</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">BOTTOM_RIGHT</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">startLocation</span> <span class="o">=</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">TOP_RIGHT</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Start location is &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">startLocation</span><span class="p">))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span> <span class="o">==</span> <span class="n">Player</span><span class="o">.</span><span class="n">PLAYER_ONE</span><span class="p">:</span>
            <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_ONE_START_LOCATION</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">startLocation</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_TWO_START_LOCATION</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">startLocation</span>

    <span class="k">def</span> <span class="nf">getCorrespondingStartLocation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">point</span><span class="p">:</span> <span class="n">Point2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;For a point get the start location.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mf">24.5</span><span class="p">):</span>
            <span class="c1"># left side of map</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mf">22.5</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">BOTTOM_LEFT</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">TOP_LEFT</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># right side of map</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mf">22.5</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">BOTTOM_RIGHT</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">TOP_RIGHT</span>

    <span class="k">def</span> <span class="nf">getLocationFromStartLocation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">startLocation</span><span class="p">:</span> <span class="n">StartLocation</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the coordinates for a start location.</span>
<span class="sd">        </span>
<span class="sd">        Counterpart to getCorrespondingStartLocation().</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">startLocation</span> <span class="o">==</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">BOTTOM_LEFT</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Point2</span><span class="p">((</span><span class="mf">24.5</span><span class="p">,</span> <span class="mf">22.5</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">startLocation</span> <span class="o">==</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">BOTTOM_RIGHT</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Point2</span><span class="p">((</span><span class="mf">127.5</span><span class="p">,</span> <span class="mf">22.5</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">startLocation</span> <span class="o">==</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">TOP_RIGHT</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Point2</span><span class="p">((</span><span class="mf">127.5</span><span class="p">,</span> <span class="mf">125.5</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">startLocation</span> <span class="o">==</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">TOP_LEFT</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Point2</span><span class="p">((</span><span class="mf">24.5</span><span class="p">,</span> <span class="mf">125.5</span><span class="p">))</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Location is not a start location! &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">startLocation</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">findNextExpansion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">current</span><span class="p">:</span> <span class="n">Point2</span><span class="p">,</span> <span class="n">ccwDirection</span><span class="p">:</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the next expansion in a certain direction.</span>

<span class="sd">        Only works on simple map. This is used in determining the expansions for</span>
<span class="sd">        each bot on the map.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">current</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">game_info</span><span class="o">.</span><span class="n">start_locations</span> <span class="o">+</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">game_info</span><span class="o">.</span><span class="n">player_start_location</span><span class="p">]:</span>
            <span class="c1"># first need to check if current is one of the start locations</span>
            <span class="c1"># &quot;corners of map&quot;</span>
            <span class="n">correspondingStartLocation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getCorrespondingStartLocation</span><span class="p">(</span><span class="n">current</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">correspondingStartLocation</span> <span class="o">==</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">UNKNOWN</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Could not find start location for &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">current</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">ccwDirection</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">correspondingStartLocation</span> <span class="o">==</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">BOTTOM_LEFT</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bottomExpansions</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># they are sorted from low to high x so this is fine</span>
                <span class="k">if</span> <span class="n">correspondingStartLocation</span> <span class="o">==</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">BOTTOM_RIGHT</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rightExpansions</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">correspondingStartLocation</span> <span class="o">==</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">TOP_RIGHT</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">topExpansions</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">topExpansions</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">correspondingStartLocation</span> <span class="o">==</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">TOP_LEFT</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">leftExpansions</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">leftExpansions</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># cw direction</span>
                <span class="k">if</span> <span class="n">correspondingStartLocation</span> <span class="o">==</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">BOTTOM_LEFT</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">leftExpansions</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">correspondingStartLocation</span> <span class="o">==</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">BOTTOM_RIGHT</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bottomExpansions</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bottomExpansions</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">correspondingStartLocation</span> <span class="o">==</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">TOP_RIGHT</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rightExpansions</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rightExpansions</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">correspondingStartLocation</span> <span class="o">==</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">TOP_LEFT</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">topExpansions</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># not in one of the corners</span>
            <span class="k">if</span> <span class="n">current</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bottomExpansions</span><span class="p">:</span>
                <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bottomExpansions</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">current</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ccwDirection</span><span class="p">:</span>
                    <span class="c1"># go right</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bottomExpansions</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># go left</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bottomExpansions</span><span class="p">[</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">current</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rightExpansions</span><span class="p">:</span>
                <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rightExpansions</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">current</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ccwDirection</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rightExpansions</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rightExpansions</span><span class="p">[</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">current</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">topExpansions</span><span class="p">:</span>
                <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">topExpansions</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">current</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ccwDirection</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">topExpansions</span><span class="p">[</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">topExpansions</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">current</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">leftExpansions</span><span class="p">:</span>
                <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">leftExpansions</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">current</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ccwDirection</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">leftExpansions</span><span class="p">[</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">leftExpansions</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">computeExpansionLocations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Computes expansion locations.</span>
<span class="sd">        </span>
<span class="sd">        Only works on simple map. This is used in determining the expansions for</span>
<span class="sd">        each bot on the map.&quot;&quot;&quot;</span>
        <span class="n">possibleExpansionLocations</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

        <span class="c1"># add all expansions including player start locations to the set</span>
        <span class="k">for</span> <span class="n">expansionLocation</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">expansion_locations_list</span><span class="p">:</span>
            <span class="n">possibleExpansionLocations</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">expansionLocation</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">expansionLocation</span> <span class="ow">in</span> <span class="n">possibleExpansionLocations</span><span class="p">:</span>
            <span class="c1"># the bottom row of expansions is roughly at 22.5</span>
            <span class="c1"># use a threshhold to ensure every single one is in</span>
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">expansionLocation</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mf">22.5</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">2.0</span><span class="p">:</span> 
                <span class="bp">self</span><span class="o">.</span><span class="n">bottomExpansions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">expansionLocation</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bottomExpansions</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">expansionLocation</span> <span class="ow">in</span> <span class="n">possibleExpansionLocations</span><span class="p">:</span>
            <span class="c1"># the top row of expansions is roughly at 125.5</span>
            <span class="c1"># use a threshhold to ensure every single one is in</span>
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">expansionLocation</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mf">125.5</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">2.0</span><span class="p">:</span> 
                <span class="bp">self</span><span class="o">.</span><span class="n">topExpansions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">expansionLocation</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">topExpansions</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">expansionLocation</span> <span class="ow">in</span> <span class="n">possibleExpansionLocations</span><span class="p">:</span>
            <span class="c1"># the left column of expansions is roughly at 24.5</span>
            <span class="c1"># use a threshhold to ensure every single one is in</span>
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">expansionLocation</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">24.5</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">2.0</span><span class="p">:</span> 
                <span class="bp">self</span><span class="o">.</span><span class="n">leftExpansions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">expansionLocation</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">leftExpansions</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">expansionLocation</span> <span class="ow">in</span> <span class="n">possibleExpansionLocations</span><span class="p">:</span>
            <span class="c1"># the right column of expansions is roughly at 24.5</span>
            <span class="c1"># use a threshhold to ensure every single one is in</span>
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">expansionLocation</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">127.5</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">2.0</span><span class="p">:</span> 
                <span class="bp">self</span><span class="o">.</span><span class="n">rightExpansions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">expansionLocation</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rightExpansions</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="c1"># there is always two directions in which we could go to find expansions:</span>
        <span class="c1"># in ccw and in cw direction</span>
        <span class="c1"># we always prefer ccw direction but alternate between the two to stay close to our main</span>

        <span class="c1"># my side:</span>
        <span class="c1"># --------------------</span>

        <span class="n">playerOnePreferredExpansionCCWDirection</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="n">playerOnePreferredExpansionCWDirection</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>

        <span class="n">currentCCW</span><span class="p">:</span> <span class="n">Point2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getLocationFromStartLocation</span><span class="p">(</span><span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_ONE_START_LOCATION</span><span class="p">)</span>
        <span class="n">currentCW</span><span class="p">:</span> <span class="n">Point2</span> <span class="o">=</span> <span class="n">currentCCW</span>

        <span class="n">currentCCW</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">findNextExpansion</span><span class="p">(</span><span class="n">currentCCW</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">currentCW</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">findNextExpansion</span><span class="p">(</span><span class="n">currentCW</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

        <span class="k">while</span> <span class="n">currentCW</span> <span class="o">!=</span> <span class="n">currentCCW</span><span class="p">:</span>
            <span class="c1"># store</span>
            <span class="n">playerOnePreferredExpansionCCWDirection</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">currentCCW</span><span class="p">)</span>
            <span class="n">playerOnePreferredExpansionCWDirection</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">currentCW</span><span class="p">)</span>
            <span class="c1"># advance</span>
            <span class="n">currentCCW</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">findNextExpansion</span><span class="p">(</span><span class="n">currentCCW</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
            <span class="n">currentCW</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">findNextExpansion</span><span class="p">(</span><span class="n">currentCW</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        
        <span class="c1"># append one last time</span>
        <span class="n">playerOnePreferredExpansionCCWDirection</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">currentCCW</span><span class="p">)</span>
        <span class="n">playerOnePreferredExpansionCWDirection</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">currentCW</span><span class="p">)</span>

        <span class="c1"># opponents side side:</span>
        <span class="c1"># --------------------</span>

        <span class="n">playerTwoPreferredExpansionCCWDirection</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="n">playerTwoPreferredExpansionCWDirection</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>

        <span class="n">currentCCW</span><span class="p">:</span> <span class="n">Point2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getLocationFromStartLocation</span><span class="p">(</span><span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_TWO_START_LOCATION</span><span class="p">)</span>
        <span class="n">currentCW</span><span class="p">:</span> <span class="n">Point2</span> <span class="o">=</span> <span class="n">currentCCW</span>

        <span class="n">currentCCW</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">findNextExpansion</span><span class="p">(</span><span class="n">currentCCW</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">currentCW</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">findNextExpansion</span><span class="p">(</span><span class="n">currentCW</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

        <span class="k">while</span> <span class="n">currentCW</span> <span class="o">!=</span> <span class="n">currentCCW</span><span class="p">:</span>
            <span class="c1"># store</span>
            <span class="n">playerTwoPreferredExpansionCCWDirection</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">currentCCW</span><span class="p">)</span>
            <span class="n">playerTwoPreferredExpansionCWDirection</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">currentCW</span><span class="p">)</span>
            <span class="c1"># advance</span>
            <span class="n">currentCCW</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">findNextExpansion</span><span class="p">(</span><span class="n">currentCCW</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
            <span class="n">currentCW</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">findNextExpansion</span><span class="p">(</span><span class="n">currentCW</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        
        <span class="c1"># append one last time</span>
        <span class="n">playerTwoPreferredExpansionCCWDirection</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">currentCCW</span><span class="p">)</span>
        <span class="n">playerTwoPreferredExpansionCWDirection</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">currentCW</span><span class="p">)</span>

        <span class="c1"># now of both players the preferences of expansions in both possible directions are known</span>
        
        <span class="c1"># remove both start locations from possibleExpansionLocations</span>
        <span class="n">possibleExpansionLocations</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getLocationFromStartLocation</span><span class="p">(</span><span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_ONE_START_LOCATION</span><span class="p">))</span>
        <span class="n">possibleExpansionLocations</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getLocationFromStartLocation</span><span class="p">(</span><span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_TWO_START_LOCATION</span><span class="p">))</span>

        <span class="n">playerOneExpansionLocations</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="n">playerTwoExpansionLocations</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>

        <span class="c1"># ccw direction is always taken first</span>
        <span class="n">ccwRoundPlayerOne</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">ccwRoundPlayerTwo</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">while</span> <span class="nb">bool</span><span class="p">(</span><span class="n">possibleExpansionLocations</span><span class="p">):</span>
            <span class="c1"># player one goes first</span>
            <span class="k">if</span> <span class="n">ccwRoundPlayerOne</span><span class="p">:</span>  
                <span class="n">playerOneSelectedExpansion</span> <span class="o">=</span> <span class="n">playerOnePreferredExpansionCCWDirection</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">playerOneSelectedExpansion</span> <span class="ow">in</span> <span class="n">possibleExpansionLocations</span><span class="p">:</span>
                    <span class="n">playerOneExpansionLocations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">playerOneSelectedExpansion</span><span class="p">)</span>
                    <span class="n">possibleExpansionLocations</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">playerOneSelectedExpansion</span><span class="p">)</span>
                    <span class="n">ccwRoundPlayerOne</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">playerOneSelectedExpansion</span> <span class="o">=</span> <span class="n">playerOnePreferredExpansionCWDirection</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">playerOneSelectedExpansion</span> <span class="ow">in</span> <span class="n">possibleExpansionLocations</span><span class="p">:</span>
                        <span class="n">playerOneExpansionLocations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">playerOneSelectedExpansion</span><span class="p">)</span>
                        <span class="n">possibleExpansionLocations</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">playerOneSelectedExpansion</span><span class="p">)</span>
                        <span class="n">ccwRoundPlayerOne</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;There are no expansion locations left for player one even though there is still locations available!&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">playerOneSelectedExpansion</span> <span class="o">=</span> <span class="n">playerOnePreferredExpansionCWDirection</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">playerOneSelectedExpansion</span> <span class="ow">in</span> <span class="n">possibleExpansionLocations</span><span class="p">:</span>
                    <span class="n">playerOneExpansionLocations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">playerOneSelectedExpansion</span><span class="p">)</span>
                    <span class="n">possibleExpansionLocations</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">playerOneSelectedExpansion</span><span class="p">)</span>
                    <span class="n">ccwRoundPlayerOne</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">playerOneSelectedExpansion</span> <span class="o">=</span> <span class="n">playerOnePreferredExpansionCCWDirection</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">playerOneSelectedExpansion</span> <span class="ow">in</span> <span class="n">possibleExpansionLocations</span><span class="p">:</span>
                        <span class="n">playerOneExpansionLocations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">playerOneSelectedExpansion</span><span class="p">)</span>
                        <span class="n">possibleExpansionLocations</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">playerOneSelectedExpansion</span><span class="p">)</span>
                        <span class="n">ccwRoundPlayerOne</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;There are no expansion locations left for player one even though there is still locations available!&quot;</span><span class="p">)</span>
            <span class="c1"># player two goes second</span>
            <span class="k">if</span> <span class="n">ccwRoundPlayerTwo</span><span class="p">:</span>
                <span class="n">playerTwoSelectedExpansion</span> <span class="o">=</span> <span class="n">playerTwoPreferredExpansionCCWDirection</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">playerTwoSelectedExpansion</span> <span class="ow">in</span> <span class="n">possibleExpansionLocations</span><span class="p">:</span>
                    <span class="n">playerTwoExpansionLocations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">playerTwoSelectedExpansion</span><span class="p">)</span>
                    <span class="n">possibleExpansionLocations</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">playerTwoSelectedExpansion</span><span class="p">)</span>
                    <span class="n">ccwRoundPlayerTwo</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">playerTwoSelectedExpansion</span> <span class="o">=</span> <span class="n">playerTwoPreferredExpansionCWDirection</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">playerTwoSelectedExpansion</span> <span class="ow">in</span> <span class="n">possibleExpansionLocations</span><span class="p">:</span>
                        <span class="n">playerTwoExpansionLocations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">playerTwoSelectedExpansion</span><span class="p">)</span>
                        <span class="n">possibleExpansionLocations</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">playerTwoSelectedExpansion</span><span class="p">)</span>
                        <span class="n">ccwRoundPlayerTwo</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;There are no expansion locations left for player one even though there is still locations available!&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">playerTwoSelectedExpansion</span> <span class="o">=</span> <span class="n">playerTwoPreferredExpansionCWDirection</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">playerTwoSelectedExpansion</span> <span class="ow">in</span> <span class="n">possibleExpansionLocations</span><span class="p">:</span>
                    <span class="n">playerTwoExpansionLocations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">playerTwoSelectedExpansion</span><span class="p">)</span>
                    <span class="n">possibleExpansionLocations</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">playerTwoSelectedExpansion</span><span class="p">)</span>
                    <span class="n">ccwRoundPlayerTwo</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">playerTwoSelectedExpansion</span> <span class="o">=</span> <span class="n">playerTwoPreferredExpansionCCWDirection</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">playerTwoSelectedExpansion</span> <span class="ow">in</span> <span class="n">possibleExpansionLocations</span><span class="p">:</span>
                        <span class="n">playerTwoExpansionLocations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">playerTwoSelectedExpansion</span><span class="p">)</span>
                        <span class="n">possibleExpansionLocations</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">playerTwoSelectedExpansion</span><span class="p">)</span>
                        <span class="n">ccwRoundPlayerTwo</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;There are no expansion locations left for player one even though there is still locations available!&quot;</span><span class="p">)</span>

        
        
        


        <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_ONE_EXPANSION_LOCATIONS</span> <span class="o">=</span> <span class="n">playerOneExpansionLocations</span>
        <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_TWO_EXPANSION_LOCATIONS</span> <span class="o">=</span> <span class="n">playerTwoExpansionLocations</span>   

        <span class="k">return</span>

    <span class="k">def</span> <span class="nf">fillExpansionLocations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Wrapper for calling computeExpansionLocations() and doing some logging.</span>

<span class="sd">        Only works on simple map. This is used in determining the expansions for</span>
<span class="sd">        each bot on the map.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span><span class="p">(</span><span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_TWO_START_LOCATION</span> <span class="o">!=</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">UNKNOWN</span><span class="p">)</span>
        <span class="k">assert</span><span class="p">(</span><span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_ONE_START_LOCATION</span> <span class="o">!=</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">UNKNOWN</span><span class="p">)</span>
        <span class="c1"># compute expansions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Computing expansion locations...&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">computeExpansionLocations</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Player one expansion locations: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_ONE_EXPANSION_LOCATIONS</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Player two expansion locations: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_TWO_EXPANSION_LOCATIONS</span><span class="p">))</span>
    
    <span class="k">def</span> <span class="nf">onStartBase</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Call this from implementing bot in on_start().</span>

<span class="sd">        startup routine. Should prepare:</span>
<span class="sd">           - enemy location </span>
<span class="sd">           - scan the buildlist</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setSelfStartLocation</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Available start locations: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game_info</span><span class="o">.</span><span class="n">start_locations</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scanBuildList</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prepareBuildListCompletedCheck</span><span class="p">()</span>
    
    <span class="c1"># BuildList</span>
    <span class="c1"># ----------------------------------------</span>

    <span class="k">def</span> <span class="nf">checkAndAdvance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Checks buildlist progress and advances it.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">done</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span> <span class="o">==</span> <span class="n">UnitTypeId</span><span class="o">.</span><span class="n">NOTAUNIT</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buildList</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="c1"># extract first build list element and set as current task</span>
                    <span class="n">nextTaskName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">buildList</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">unitToId</span><span class="p">(</span><span class="n">nextTaskName</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Beginning next task: &quot;</span> <span class="o">+</span> <span class="n">nextTaskName</span> <span class="o">+</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">done</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">finishedCurrentTask</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Advance buildlist by one task.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Finished task: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span> <span class="o">=</span> <span class="n">UnitTypeId</span><span class="o">.</span><span class="n">NOTAUNIT</span>

    <span class="k">def</span> <span class="nf">scanBuildList</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Preprocess/check of buildlist.</span>

<span class="sd">        Checks: </span>
<span class="sd">        - number of expansions must be smaller or equal to seven</span>
<span class="sd">        - number of gas buildings must be smaller or equal to 2*(numberOfExpansions+1)</span>
<span class="sd">        - everything in buildlist is known to the bot</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">buildListCopy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">buildList</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="n">expansionCount</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">gasBuildingCount</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">buildListCopy</span><span class="p">:</span>
            <span class="n">unitId</span><span class="p">:</span> <span class="n">UnitTypeId</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">unitToId</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">unitId</span> <span class="o">==</span> <span class="n">raceBasicTownhall</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">race</span><span class="p">]:</span>
                <span class="n">expansionCount</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="n">unitId</span> <span class="o">==</span> <span class="n">race_gas</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">race</span><span class="p">]:</span>
                <span class="n">gasBuildingCount</span> <span class="o">+=</span> <span class="mi">1</span>
        
        <span class="k">if</span> <span class="n">expansionCount</span> <span class="o">&gt;</span> <span class="mi">7</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;BuildList is invalid! To many expansions. Max: 7; Have: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">expansionCount</span><span class="p">))</span>

        <span class="c1"># add one to expansion count (natural)</span>
        <span class="n">expansionCount</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">maxNumberOfGas</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">expansionCount</span> <span class="o">*</span> <span class="mi">2</span>

        <span class="k">if</span> <span class="n">gasBuildingCount</span> <span class="o">&gt;</span> <span class="n">maxNumberOfGas</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;BuildList is invalid! To many gas buildings. Max:&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">maxNumberOfGas</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;; Have: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">gasBuildingCount</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;BuildList has no errors.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">prepareBuildListCompletedCheck</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Setup check when buildlist is completed that everything was built.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remainingBuildTasks</span><span class="p">[</span><span class="n">race_worker</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">race</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">12</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remainingBuildTasks</span><span class="p">[</span><span class="n">raceBasicTownhall</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">race</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">raceSpecificUnitAndStructureCreations</span><span class="p">()</span>
        <span class="c1"># add everything from build list</span>
        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">buildList</span><span class="p">:</span>
            <span class="c1"># convert to id</span>
            <span class="n">unitId</span><span class="p">:</span> <span class="n">UnitTypeId</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">unitToId</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">unitId</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">remainingBuildTasks</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">remainingBuildTasks</span><span class="p">[</span><span class="n">unitId</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">remainingBuildTasks</span><span class="p">[</span><span class="n">unitId</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Created remaining build tasks data structure: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">remainingBuildTasks</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">raceSpecificUnitAndStructureCreations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Add certain unit creations to build list completed check.</span>

<span class="sd">        Thhis has to be implemented by a child class to avoid counting initial units </span>
<span class="sd">        (automatically given at the start of the game) as units that were created</span>
<span class="sd">        use self.remainingBuildTasks to include them</span>
<span class="sd">        an example for workers is given in self.prepareBuildListCompletedCheck()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Has to be implemented by race specific class!&quot;</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">on_building_construction_complete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unit</span><span class="p">:</span> <span class="n">Unit</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;When building is completed store that for later checks.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">raceSpecificStructureCompletedIgnore</span><span class="p">(</span><span class="n">unit</span><span class="o">.</span><span class="n">type_id</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Structure &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">unit</span><span class="o">.</span><span class="n">type_id</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; completed!&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remainingBuildTasks</span><span class="p">[</span><span class="n">unit</span><span class="o">.</span><span class="n">type_id</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">on_unit_created</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unit</span><span class="p">:</span> <span class="n">Unit</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;When unit is created store that for later checks.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">raceSpecificUnitCompletedIgnore</span><span class="p">(</span><span class="n">unit</span><span class="o">.</span><span class="n">type_id</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Unit &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">unit</span><span class="o">.</span><span class="n">type_id</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; completed!&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remainingBuildTasks</span><span class="p">[</span><span class="n">unit</span><span class="o">.</span><span class="n">type_id</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">raceSpecificStructureCompletedIgnore</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unit</span><span class="p">:</span> <span class="n">UnitTypeId</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Some structures need to be ignored by races.&quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Has to be implemented by race specific bot!&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">raceSpecificUnitCompletedIgnore</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unit</span><span class="p">:</span> <span class="n">UnitTypeId</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Some units need to be ignored by races.&quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Has to be implemented by race specific bot!&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">checkBuildListCompleted</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Post buildlist completed check.</span>

<span class="sd">        This does not check if the list of build tasks is empty but it checks</span>
<span class="sd">        if all buildings are ready and idle and if all remaining build tasks</span>
<span class="sd">        have been completed</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">done</span><span class="p">:</span>

            <span class="n">allStructuresReady</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">allStructuresIdle</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="k">for</span> <span class="n">structure</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">structures</span><span class="p">:</span>
                <span class="n">allStructuresReady</span> <span class="o">=</span> <span class="n">allStructuresReady</span> <span class="ow">and</span> <span class="n">structure</span><span class="o">.</span><span class="n">is_ready</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">structure</span><span class="o">.</span><span class="n">is_ready</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">structure</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; is not ready&quot;</span><span class="p">)</span>
                <span class="n">allStructuresIdle</span> <span class="o">=</span> <span class="n">allStructuresIdle</span> <span class="ow">and</span> <span class="n">structure</span><span class="o">.</span><span class="n">is_idle</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">structure</span><span class="o">.</span><span class="n">is_idle</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">structure</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; is not idle&quot;</span><span class="p">)</span>
        
            <span class="n">allUnitsReady</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">for</span> <span class="n">unit</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">:</span>
                <span class="n">allUnitsReady</span> <span class="o">=</span> <span class="n">allUnitsReady</span> <span class="ow">and</span> <span class="n">unit</span><span class="o">.</span><span class="n">is_ready</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">unit</span><span class="o">.</span><span class="n">is_ready</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; is not ready!&quot;</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">race</span> <span class="o">==</span> <span class="n">Race</span><span class="o">.</span><span class="n">Zerg</span><span class="p">:</span>
                <span class="n">allUnitsReady</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">unit</span><span class="p">:</span> <span class="n">unit</span><span class="o">.</span><span class="n">type_id</span> <span class="o">==</span> <span class="n">UnitTypeId</span><span class="o">.</span><span class="n">EGG</span><span class="p">)</span><span class="o">.</span><span class="n">empty</span>


            <span class="k">if</span> <span class="ow">not</span> <span class="n">allStructuresReady</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Buildlist is done but not all structures are ready!&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">allStructuresIdle</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Buildlist is done but not all structures are idle!&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">allUnitsReady</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Buildlist is done but not all units are ready!&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">allStructuresReady</span> <span class="ow">and</span> <span class="n">allStructuresIdle</span> <span class="ow">and</span> <span class="n">allUnitsReady</span><span class="p">:</span>
                <span class="c1"># the final check of remainingBuildTasks if everything was built</span>
                <span class="k">for</span> <span class="n">unitId</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">remainingBuildTasks</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="c1"># safety net for terran (and protoss)</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">already_pending</span><span class="p">(</span><span class="n">unitId</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="k">return</span> <span class="kc">False</span> <span class="c1"># the building is pending --&gt; worker walking to build etc.</span>
                    <span class="k">if</span> <span class="n">unitId</span> <span class="ow">in</span> <span class="n">BASE_BUILDINGS</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;All units: </span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">all_units</span><span class="p">))</span>
                    <span class="k">if</span> <span class="n">count</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">unitId</span> <span class="o">==</span> <span class="n">race_worker</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">race</span><span class="p">]:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;The bot did not produce the correct number of workers. Timings will not be correct but the army strength can still be compared!&quot;</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Everything should be done but &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">unitId</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; was not build as many times as it was supposed to!&quot;</span><span class="p">)</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Everything should be done but &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">unitId</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; was build more than it was supposed to!&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>


        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        
    <span class="c1"># Units</span>
    <span class="c1"># ----------------------------------------</span>
    
    <span class="k">def</span> <span class="nf">unitToId</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unitName</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Convert unit name to id.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">unitName</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">CONVERT_TO_ID</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">unitName</span> <span class="o">+</span> <span class="s2">&quot; is not available in CONVERT_TO_ID!&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">CONVERT_TO_ID</span><span class="p">[</span><span class="n">unitName</span><span class="p">]</span>

    <span class="c1"># returns the ids of producers for the current task</span>
    <span class="k">def</span> <span class="nf">getProducerIdsForCurrentTask</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get producer ids for current task.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span> <span class="ow">in</span> <span class="n">UNIT_TRAINED_FROM</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">UNIT_TRAINED_FROM</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span> <span class="ow">in</span> <span class="n">BASE_BUILDINGS</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">BASE_BUILDINGS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; is not available in UNIT_TRAINED_FROM and not in BASE_BUILDINGS (only terran)!&quot;</span><span class="p">)</span>

    <span class="c1"># returns actual units of producers for the current task</span>
    <span class="k">def</span> <span class="nf">getProducerUnitsForCurrentTask</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the units (actual units in the game) that could produce the current task.</span>

<span class="sd">        Does not check if these units are busy.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">producerIds</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="n">UnitTypeId</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getProducerIdsForCurrentTask</span><span class="p">()</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">structures</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">unit</span><span class="p">:</span> <span class="n">unit</span><span class="o">.</span><span class="n">type_id</span> <span class="ow">in</span> <span class="n">producerIds</span><span class="p">)</span>

    <span class="c1"># returns true if the given unit id is a worker of the currently played race</span>
    <span class="k">def</span> <span class="nf">isWorker</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unitId</span><span class="p">:</span> <span class="n">UnitTypeId</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Checks if a certain unit is a worker.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">race_worker</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">race</span><span class="p">]</span> <span class="o">==</span> <span class="n">unitId</span>

    <span class="c1"># Building/Training Conditions</span>
    <span class="c1"># ----------------------------------------</span>

    <span class="k">def</span> <span class="nf">checkIfProducerExists</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check if a producer for the current task exists.</span>
<span class="sd">        </span>
<span class="sd">        returns a pair of bools stating if a producer is currently available and</span>
<span class="sd">        if we can wait such that it becomes available.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="n">producersAvailable</span><span class="p">:</span> <span class="n">Units</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getProducerUnitsForCurrentTask</span><span class="p">()</span>
        <span class="n">producersAvailable</span> <span class="o">=</span> <span class="n">producersAvailable</span><span class="o">.</span><span class="n">ready</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">producersAvailable</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
            <span class="c1"># is any of these available producers idle</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">producer</span><span class="o">.</span><span class="n">is_idle</span> <span class="ow">or</span> <span class="n">producer</span><span class="o">.</span><span class="n">is_gathering</span> <span class="k">for</span> <span class="n">producer</span> <span class="ow">in</span> <span class="n">producersAvailable</span><span class="p">):</span>
                <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># is any of the unit ids being produced or queued?</span>
            <span class="n">producerIds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getProducerIdsForCurrentTask</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">already_pending</span><span class="p">(</span><span class="n">producerId</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0</span> <span class="k">for</span> <span class="n">producerId</span> <span class="ow">in</span> <span class="n">producerIds</span><span class="p">):</span>
                <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
            <span class="c1"># for zerg producer might be larva. already_pending will not account for that</span>
            <span class="c1"># as long as we have a least one Hatchery/Lair/Hive</span>
            <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">race</span> <span class="o">==</span> <span class="n">Race</span><span class="o">.</span><span class="n">Zerg</span> <span class="ow">and</span> <span class="n">UnitTypeId</span><span class="o">.</span><span class="n">LARVA</span> <span class="ow">in</span> <span class="n">producerIds</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">townhalls</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">checkCosts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check if the current task is affordable.</span>
<span class="sd">        </span>
<span class="sd">        returns a pair of bools stating if the task is currently affordable and</span>
<span class="sd">        if we can wait such that it becomes affordable.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cost</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_cost</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span><span class="p">)</span>

        <span class="c1"># TODO: the check here (self.workers.gathering &gt; 0) does not work for terran and protoss</span>

        <span class="n">minerals</span> <span class="o">=</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cost</span><span class="o">.</span><span class="n">minerals</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">minerals</span><span class="p">:</span>
            <span class="c1"># not enough right now but maybe later?</span>
            <span class="c1"># at least some workers and</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workers</span><span class="o">.</span><span class="n">gathering</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">townhalls</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">minerals</span> <span class="o">=</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">minerals</span> <span class="o">=</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;There are not enough minerals to build &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; and waiting does not help!&quot;</span><span class="p">)</span>
        
        <span class="n">vespene</span> <span class="o">=</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cost</span><span class="o">.</span><span class="n">vespene</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">vespene</span><span class="p">:</span>
            <span class="c1"># not enough right now but maybe later?</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workers</span><span class="o">.</span><span class="n">gathering</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gas_buildings</span><span class="o">.</span><span class="n">ready</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">already_pending</span><span class="p">(</span><span class="n">race_gas</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">race</span><span class="p">]):</span>
                <span class="c1"># waiting helps</span>
                <span class="n">vespene</span> <span class="o">=</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">vespene</span> <span class="o">=</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;There are not enough vespene to build &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; and waiting does not help!&quot;</span><span class="p">)</span>

        <span class="n">supply</span> <span class="o">=</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">supply_cost</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_supply_cost</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span><span class="p">)</span>
        <span class="c1"># make sure this thing actually has supply cost</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span><span class="p">,</span> <span class="n">UnitTypeId</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">supply_cost</span> <span class="ow">and</span> <span class="n">supply_cost</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">supply_left</span><span class="p">:</span>
                <span class="c1"># we dont have enough supply right now but maybe later?</span>
                <span class="n">supply</span> <span class="o">=</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
                <span class="c1"># check if supply building is being built</span>
                <span class="c1"># already pending checks everything: check its documentation</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">already_pending</span><span class="p">(</span><span class="n">race_supplyUnit</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">race</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">supply</span> <span class="o">=</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;There is not enough supply to build &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; and waiting does not help!&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">minerals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">vespene</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">supply</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">minerals</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">and</span> <span class="n">vespene</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">and</span> <span class="n">supply</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">checkIfTechRequirementFulfilled</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check if the tech requirement for the current task is fulfilled.</span>
<span class="sd">        </span>
<span class="sd">        returns a pair of bools stating if the requirement is currently fulfilled and</span>
<span class="sd">        if we can wait such that it becomes fulfilled.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">race_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">Race</span><span class="o">.</span><span class="n">Protoss</span><span class="p">:</span> <span class="n">PROTOSS_TECH_REQUIREMENT</span><span class="p">,</span>
            <span class="n">Race</span><span class="o">.</span><span class="n">Terran</span><span class="p">:</span> <span class="n">TERRAN_TECH_REQUIREMENT</span><span class="p">,</span>
            <span class="n">Race</span><span class="o">.</span><span class="n">Zerg</span><span class="p">:</span> <span class="n">ZERG_TECH_REQUIREMENT</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="c1"># this gets the requirement for the unit we are checking</span>
        <span class="n">requirement</span> <span class="o">=</span> <span class="n">race_dict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">race</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span><span class="p">]</span>
        <span class="c1"># if there is no requirement we can just skip the remaining stuff</span>
        <span class="k">if</span> <span class="n">UnitTypeId</span><span class="o">.</span><span class="n">NOTAUNIT</span> <span class="o">==</span> <span class="n">requirement</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="c1"># </span>
        <span class="n">requirementEquivalents</span> <span class="o">=</span> <span class="p">{</span><span class="n">requirement</span><span class="p">}</span>
        <span class="k">for</span> <span class="n">equiv_structure</span> <span class="ow">in</span> <span class="n">EQUIVALENTS_FOR_TECH_PROGRESS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">requirement</span><span class="p">,</span> <span class="p">[]):</span>
            <span class="n">requirementEquivalents</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">equiv_structure</span><span class="p">)</span>

        <span class="n">correspondingStructures</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structures</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">unit</span><span class="p">:</span> <span class="n">unit</span><span class="o">.</span><span class="n">type_id</span> <span class="ow">in</span> <span class="n">requirementEquivalents</span><span class="p">)</span>

        <span class="c1"># any of them already existing?</span>
        <span class="n">fulfilled</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">correspondingStructures</span><span class="o">.</span><span class="n">ready</span><span class="p">)</span>
            
        <span class="c1"># is any of these pending?</span>
        <span class="c1"># if yes waiting helps</span>
        <span class="c1"># waiting is also fine if it already exists</span>
        <span class="n">waitingHelps</span> <span class="o">=</span> <span class="n">fulfilled</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">fulfilled</span><span class="p">:</span>
            <span class="n">waitingHelps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">already_pending</span><span class="p">(</span><span class="n">requirement</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> 

        <span class="k">return</span> <span class="p">(</span><span class="n">fulfilled</span><span class="p">,</span> <span class="n">waitingHelps</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">checkPreconditions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Combine producer, cost and tech requirement check.</span>
<span class="sd">        </span>
<span class="sd">        returns a bool if the current task can be built right now.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check if the producer exists or is under construction and if the producer is idle</span>
        <span class="n">producerExists</span><span class="p">,</span> <span class="n">canWaitProducer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkIfProducerExists</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">producerExists</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">canWaitProducer</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;There must be a producer for &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span><span class="p">))</span>
        <span class="c1"># check if we can afford the unit/structure</span>
        <span class="n">resourcesExist</span><span class="p">,</span> <span class="n">canWaitResources</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkCosts</span><span class="p">()</span> 
        <span class="k">if</span> <span class="ow">not</span> <span class="n">resourcesExist</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">canWaitResources</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;There is not enough minerals, vespene or supply and waiting for it will not help!&quot;</span><span class="p">)</span>
        <span class="c1"># check if tech requirement is fullfilled only if the resources exist</span>
        <span class="n">requirementFulfilled</span><span class="p">,</span> <span class="n">canWaitRequirement</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkIfTechRequirementFulfilled</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">requirementFulfilled</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">canWaitRequirement</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;The requirement for &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; is not fullfilled!&quot;</span><span class="p">)</span>

        <span class="c1"># just return if we are able to build immediately --&gt; if not that means we have to wait</span>
        <span class="k">return</span> <span class="n">producerExists</span> <span class="ow">and</span> <span class="n">resourcesExist</span> <span class="ow">and</span> <span class="n">requirementFulfilled</span>


        <span class="c1"># finds an appropriate worker (closest to position or unit)</span>
    
    <span class="c1"># Building</span>
    <span class="c1"># ----------------------------------------</span>
    <span class="k">def</span> <span class="nf">getWorker</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Unit</span><span class="p">,</span> <span class="n">Point2</span><span class="p">,</span> <span class="n">Point3</span><span class="p">]):</span>
        <span class="sd">&quot;&quot;&quot;Get a worker closest to a certain point on the map.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">workersGathering</span><span class="p">:</span> <span class="n">Units</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">workers</span><span class="o">.</span><span class="n">gathering</span>

        <span class="k">if</span> <span class="n">workersGathering</span><span class="p">:</span>
            <span class="c1"># select worker closest to pos or unit</span>
            <span class="k">return</span> <span class="n">workersGathering</span><span class="o">.</span><span class="n">closest_to</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;There are no gathering workers which could be used to build &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">buildGasBuildingAtTownhall</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">townhall</span><span class="p">:</span> <span class="n">Unit</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Build gas building at a certain townhall.</span>
<span class="sd">        </span>
<span class="sd">        Needs storage for occupied geysers as library function can_place does not</span>
<span class="sd">        work in that case.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># all vespene geysers closer than distance ten to the current townhall</span>
        <span class="n">vespeneGeysers</span><span class="p">:</span> <span class="n">Units</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vespene_geyser</span><span class="o">.</span><span class="n">closer_than</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">townhall</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Found &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">vespeneGeysers</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot; vespene geyser locations!&quot;</span><span class="p">)</span>
        <span class="c1"># check all locations</span>
        <span class="c1">#  apparently can_place does not work in this situation. it will say that a second refinery can be placed on the occupied geyser</span>
        <span class="k">for</span> <span class="n">vespeneGeyser</span> <span class="ow">in</span> <span class="n">vespeneGeysers</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">vespeneGeyser</span><span class="o">.</span><span class="n">position</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">occupiedGeysers</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">can_place</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span><span class="p">,</span> <span class="p">(</span><span class="n">vespeneGeyser</span><span class="o">.</span><span class="n">position</span><span class="p">)):</span>
                    <span class="n">worker</span><span class="p">:</span> <span class="n">Unit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getWorker</span><span class="p">(</span><span class="n">vespeneGeyser</span><span class="p">)</span>
                    <span class="n">worker</span><span class="o">.</span><span class="n">build_gas</span><span class="p">(</span><span class="n">vespeneGeyser</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">occupiedGeysers</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">vespeneGeyser</span><span class="o">.</span><span class="n">position</span><span class="p">)</span>
                    <span class="k">return</span> <span class="kc">True</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Can place stated not possible to place even though according to self.occupiedGeysers it should be free!&quot;</span><span class="p">)</span>
        
        <span class="c1"># if we reach this we have not found a building location</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">buildGasBuilding</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Build a gas building by selecting a townhall.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># cant build more gas buildings than townhalls</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gas_buildings</span><span class="o">.</span><span class="n">ready</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">already_pending</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">townhalls</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span><span class="p">:</span>
            
            <span class="c1"># prefer townhalls that are ready</span>
            <span class="k">for</span> <span class="n">townhall</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">townhalls</span><span class="o">.</span><span class="n">ready</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">buildGasBuildingAtTownhall</span><span class="p">(</span><span class="n">townhall</span><span class="p">)</span>
            <span class="c1"># townhalls that are not ready</span>
            <span class="k">for</span> <span class="n">townhall</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">townhalls</span><span class="o">.</span><span class="n">not_ready</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">buildGasBuildingAtTownhall</span><span class="p">(</span><span class="n">townhall</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">buildBase</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Build base.</span>
<span class="sd">        </span>
<span class="sd">        Uses the pre computed expansion locations. Only works for simple map.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">expansionLocations</span><span class="p">):</span>
            <span class="n">location</span><span class="p">:</span> <span class="n">Point2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">expansionLocations</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">worker</span><span class="p">:</span> <span class="n">Unit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">workers</span><span class="o">.</span><span class="n">gathering</span><span class="o">.</span><span class="n">closest_to</span><span class="p">(</span><span class="n">location</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">can_place</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span><span class="p">,</span> <span class="n">location</span><span class="p">):</span>
                <span class="n">worker</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span><span class="p">,</span> <span class="n">location</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;could not build the command center where it was supposed to be built!&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;No more places to build command expansions!&quot;</span><span class="p">)</span>

    <span class="c1"># Worker Distribution</span>
    <span class="c1"># ----------------------------------------</span>

    <span class="k">def</span> <span class="nf">myWorkerDistribution</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Redistributes workers to geysers and mineral fields.</span>
<span class="sd">        </span>
<span class="sd">        Redistributes:</span>
<span class="sd">            - idle workers</span>
<span class="sd">            - surplus on townhalls/geysers</span>

<span class="sd">        Taken from https://github.com/BurnySc2/python-sc2/blob/develop/examples/terran/mass_reaper.py and modified.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">mineralTags</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">tag</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mineral_field</span><span class="p">]</span>
        <span class="n">gas_buildingTags</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">tag</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_buildings</span><span class="p">]</span>

        <span class="n">workerPool</span> <span class="o">=</span> <span class="n">Units</span><span class="p">([],</span> <span class="bp">self</span><span class="p">)</span>
        <span class="n">workerPoolTags</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

        <span class="c1"># # Find all gas_buildings that have surplus or deficit</span>
        <span class="n">deficit_gas_buildings</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">surplusgas_buildings</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_buildings</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">vespene_contents</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="c1"># Only loop over gas_buildings that have still gas in them</span>
            <span class="n">deficit</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">ideal_harvesters</span> <span class="o">-</span> <span class="n">g</span><span class="o">.</span><span class="n">assigned_harvesters</span>
            <span class="k">if</span> <span class="n">deficit</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">deficit_gas_buildings</span><span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">tag</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;unit&quot;</span><span class="p">:</span> <span class="n">g</span><span class="p">,</span> <span class="s2">&quot;deficit&quot;</span><span class="p">:</span> <span class="n">deficit</span><span class="p">}</span>
            <span class="k">elif</span> <span class="n">deficit</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">surplusWorkers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">workers</span><span class="o">.</span><span class="n">closer_than</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">w</span><span class="p">:</span> <span class="n">w</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">workerPoolTags</span>
                    <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">orders</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
                    <span class="ow">and</span> <span class="n">w</span><span class="o">.</span><span class="n">orders</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">ability</span><span class="o">.</span><span class="n">id</span> <span class="ow">in</span> <span class="p">[</span><span class="n">AbilityId</span><span class="o">.</span><span class="n">HARVEST_GATHER</span><span class="p">]</span>
                    <span class="ow">and</span> <span class="n">w</span><span class="o">.</span><span class="n">orders</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">target</span> <span class="ow">in</span> <span class="n">gas_buildingTags</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="n">deficit</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">surplusWorkers</span><span class="o">.</span><span class="n">amount</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">w</span> <span class="o">=</span> <span class="n">surplusWorkers</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                        <span class="n">workerPool</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
                        <span class="n">workerPoolTags</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">tag</span><span class="p">)</span>
                <span class="n">surplusgas_buildings</span><span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">tag</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;unit&quot;</span><span class="p">:</span> <span class="n">g</span><span class="p">,</span> <span class="s2">&quot;deficit&quot;</span><span class="p">:</span> <span class="n">deficit</span><span class="p">}</span>

        <span class="c1"># # Find all townhalls that have surplus or deficit</span>
        <span class="n">deficitTownhalls</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">surplusTownhalls</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">th</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">townhalls</span><span class="p">:</span>
            <span class="n">deficit</span> <span class="o">=</span> <span class="n">th</span><span class="o">.</span><span class="n">ideal_harvesters</span> <span class="o">-</span> <span class="n">th</span><span class="o">.</span><span class="n">assigned_harvesters</span>
            <span class="k">if</span> <span class="n">deficit</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">deficitTownhalls</span><span class="p">[</span><span class="n">th</span><span class="o">.</span><span class="n">tag</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;unit&quot;</span><span class="p">:</span> <span class="n">th</span><span class="p">,</span> <span class="s2">&quot;deficit&quot;</span><span class="p">:</span> <span class="n">deficit</span><span class="p">}</span>
            <span class="k">elif</span> <span class="n">deficit</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">surplusWorkers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">workers</span><span class="o">.</span><span class="n">closer_than</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">th</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">w</span><span class="p">:</span> <span class="n">w</span><span class="o">.</span><span class="n">tag</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">workerPoolTags</span>
                    <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">orders</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
                    <span class="ow">and</span> <span class="n">w</span><span class="o">.</span><span class="n">orders</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">ability</span><span class="o">.</span><span class="n">id</span> <span class="ow">in</span> <span class="p">[</span><span class="n">AbilityId</span><span class="o">.</span><span class="n">HARVEST_GATHER</span><span class="p">]</span>
                    <span class="ow">and</span> <span class="n">w</span><span class="o">.</span><span class="n">orders</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">target</span> <span class="ow">in</span> <span class="n">mineralTags</span>
                <span class="p">)</span>
                <span class="c1"># workerPool.extend(surplusWorkers)</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="n">deficit</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">surplusWorkers</span><span class="o">.</span><span class="n">amount</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">w</span> <span class="o">=</span> <span class="n">surplusWorkers</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                        <span class="n">workerPool</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
                        <span class="n">workerPoolTags</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">tag</span><span class="p">)</span>
                <span class="n">surplusTownhalls</span><span class="p">[</span><span class="n">th</span><span class="o">.</span><span class="n">tag</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;unit&quot;</span><span class="p">:</span> <span class="n">th</span><span class="p">,</span> <span class="s2">&quot;deficit&quot;</span><span class="p">:</span> <span class="n">deficit</span><span class="p">}</span>
        
        <span class="c1"># ---------------------------------------------</span>

        <span class="c1"># We now know which building has a deficit and which one has a surplus. If a building has a surplus</span>
        <span class="c1"># the workers are added to the worker pool. Whenever we have anything in the worker pool we want to</span>
        <span class="c1"># distribute those first.</span>

        <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="n">workerPool</span><span class="p">):</span>

            <span class="c1"># iterate deficit townhalls</span>
            <span class="k">for</span> <span class="n">townhallTag</span><span class="p">,</span> <span class="n">info</span> <span class="ow">in</span> <span class="n">deficitTownhalls</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="c1"># get the minerals close to the current townhall</span>
                <span class="n">mineralFields</span><span class="p">:</span> <span class="n">Units</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mineral_field</span><span class="o">.</span><span class="n">closer_than</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">info</span><span class="p">[</span><span class="s2">&quot;unit&quot;</span><span class="p">])</span>
                <span class="c1"># if there are any</span>
                <span class="k">if</span> <span class="n">mineralFields</span><span class="p">:</span>
                    <span class="c1"># get the deficit (missing worker to optimal performance)</span>
                    <span class="n">deficit</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="s2">&quot;deficit&quot;</span><span class="p">]</span>
                    <span class="c1"># check if the worker pool does contain anything</span>
                    <span class="n">workersLeft</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">workerPool</span><span class="p">)</span>
                    <span class="c1"># if there is a deficit move one worker to the townhall from the worker pool</span>
                    <span class="k">if</span> <span class="n">deficit</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">workersLeft</span><span class="p">:</span>
                        <span class="n">worker</span><span class="p">:</span> <span class="n">Unit</span> <span class="o">=</span> <span class="n">workerPool</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                        <span class="n">mineralField</span><span class="p">:</span> <span class="n">Unit</span> <span class="o">=</span> <span class="n">mineralFields</span><span class="o">.</span><span class="n">closest_to</span><span class="p">(</span><span class="n">worker</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Moving one worker to harvest minerals at &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;unit&quot;</span><span class="p">]))</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">worker</span><span class="o">.</span><span class="n">orders</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">worker</span><span class="o">.</span><span class="n">orders</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">ability</span><span class="o">.</span><span class="n">id</span> <span class="ow">in</span> <span class="p">[</span><span class="n">AbilityId</span><span class="o">.</span><span class="n">HARVEST_RETURN</span><span class="p">]:</span>
                            <span class="n">worker</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="n">mineralField</span><span class="p">,</span> <span class="n">queue</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">worker</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="n">mineralField</span><span class="p">)</span>
            <span class="c1"># iterate deficit gas buildings</span>
            <span class="k">for</span> <span class="n">gasTag</span><span class="p">,</span> <span class="n">info</span> <span class="ow">in</span> <span class="n">deficit_gas_buildings</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="c1"># get the deficit (missing worker to optimal performance)</span>
                <span class="n">deficit</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="s2">&quot;deficit&quot;</span><span class="p">]</span>
                <span class="c1"># check if the worker pool does contain anything</span>
                <span class="n">workersLeft</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">workerPool</span><span class="p">)</span>
                <span class="c1"># if there is a deficit move one worker to the townhall from the worker pool</span>
                <span class="k">if</span> <span class="n">deficit</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">workersLeft</span><span class="p">:</span>
                    <span class="n">worker</span><span class="p">:</span> <span class="n">Unit</span> <span class="o">=</span> <span class="n">workerPool</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Moving one worker to harvest gas at &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;unit&quot;</span><span class="p">]))</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">worker</span><span class="o">.</span><span class="n">orders</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">worker</span><span class="o">.</span><span class="n">orders</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">ability</span><span class="o">.</span><span class="n">id</span> <span class="ow">in</span> <span class="p">[</span><span class="n">AbilityId</span><span class="o">.</span><span class="n">HARVEST_RETURN</span><span class="p">]:</span>
                        <span class="n">worker</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;unit&quot;</span><span class="p">],</span> <span class="n">queue</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">worker</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;unit&quot;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Whenever we do not have worker in the worker pool we want to move some workers to harvest gas but only if a certain ratio between</span>
            <span class="c1"># total vespene workers and total mineral workers is not exceeded.</span>

            <span class="n">totalMineralWorkers</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">totalVespeneWorkers</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="k">for</span> <span class="n">townhall</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">townhalls</span><span class="o">.</span><span class="n">ready</span><span class="p">:</span>
                <span class="n">totalMineralWorkers</span> <span class="o">+=</span> <span class="n">townhall</span><span class="o">.</span><span class="n">assigned_harvesters</span>
            <span class="k">for</span> <span class="n">gasBuilding</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_buildings</span><span class="o">.</span><span class="n">ready</span><span class="p">:</span>
                <span class="n">totalVespeneWorkers</span> <span class="o">+=</span> <span class="n">gasBuilding</span><span class="o">.</span><span class="n">assigned_harvesters</span>

            <span class="c1"># only if less than 33% workers are on vespene</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">totalVespeneWorkers</span> <span class="o">/</span> <span class="p">(</span><span class="n">totalMineralWorkers</span> <span class="o">+</span> <span class="n">totalVespeneWorkers</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mf">0.34</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">gasTag</span><span class="p">,</span> <span class="n">info</span> <span class="ow">in</span> <span class="n">deficit_gas_buildings</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">worker</span><span class="p">:</span> <span class="n">Unit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">workers</span><span class="o">.</span><span class="n">gathering</span><span class="o">.</span><span class="n">closest_to</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;unit&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">position</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Moving one worker to &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;unit&quot;</span><span class="p">]))</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">worker</span><span class="o">.</span><span class="n">orders</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">worker</span><span class="o">.</span><span class="n">orders</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">ability</span><span class="o">.</span><span class="n">id</span> <span class="ow">in</span> <span class="p">[</span><span class="n">AbilityId</span><span class="o">.</span><span class="n">HARVEST_RETURN</span><span class="p">]:</span>
                        <span class="n">worker</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;unit&quot;</span><span class="p">],</span> <span class="n">queue</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">worker</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;unit&quot;</span><span class="p">])</span>
        
        <span class="c1"># redistribute idle workers</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workers</span><span class="o">.</span><span class="n">idle</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">townhalls</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">worker</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">workers</span><span class="o">.</span><span class="n">idle</span><span class="p">:</span>
                    <span class="n">townhall</span><span class="p">:</span> <span class="n">Unit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">townhalls</span><span class="o">.</span><span class="n">closest_to</span><span class="p">(</span><span class="n">worker</span><span class="p">)</span>
                    <span class="n">mineralFields</span><span class="p">:</span> <span class="n">Units</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mineral_field</span><span class="o">.</span><span class="n">closer_than</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">townhall</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">mineralFields</span><span class="p">:</span>
                        <span class="n">mineralField</span><span class="p">:</span> <span class="n">Unit</span> <span class="o">=</span> <span class="n">mineralFields</span><span class="o">.</span><span class="n">closest_to</span><span class="p">(</span><span class="n">worker</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Moving one worker to harvest minerals at &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">mineralField</span><span class="p">))</span>
                        <span class="n">worker</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="n">mineralField</span><span class="p">)</span>

    <span class="c1"># Attack</span>
    <span class="c1"># ----------------------------------------</span>

    <span class="k">def</span> <span class="nf">attackMapCenterWithArmy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Has to be implemented by race specific bot.</span>

<span class="sd">        Gather bots army and then move to map center with attack move.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Must be implemented by race specific Bot!&quot;</span><span class="p">)</span>

    <span class="c1"># Run</span>
    <span class="c1"># ----------------------------------------</span>

    <span class="c1"># finishes preprocessing:</span>
    <span class="c1">#   - compute expansion locations</span>
    <span class="k">def</span> <span class="nf">onStepBase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">iteration</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Neeeds to be called from race specific bot.</span>

<span class="sd">        Finishes the preprocessing that could not be done in on_start.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">expansionLocationsComputed</span><span class="p">:</span>
            <span class="c1"># player one will compute for both</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span> <span class="o">==</span> <span class="n">Player</span><span class="o">.</span><span class="n">PLAYER_ONE</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_TWO_START_LOCATION</span> <span class="o">!=</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">UNKNOWN</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">fillExpansionLocations</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">expansionLocationsComputed</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Expansion locations computed at iteration: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">iteration</span><span class="p">))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">expansionLocations</span> <span class="o">=</span> <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_ONE_EXPANSION_LOCATIONS</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_TWO_EXPANSION_LOCATIONS</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Expansion locations available at iteration: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">iteration</span><span class="p">))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">expansionLocations</span> <span class="o">=</span> <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_TWO_EXPANSION_LOCATIONS</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">expansionLocationsComputed</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1"># it is important do to this b4 checking and advancing</span>
        <span class="c1"># because orders will be processed after one step is finished</span>
        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">attacking</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBuildListCompleted</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;All tasks in buildlist are finished and ready to fight!&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span> <span class="o">==</span> <span class="n">Player</span><span class="o">.</span><span class="n">PLAYER_ONE</span><span class="p">:</span>
                <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_ONE_READY_TO_ATTACK</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_TWO_READY_TO_ATTACK</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">attacking</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_TWO_READY_TO_ATTACK</span> <span class="ow">and</span> <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_ONE_READY_TO_ATTACK</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">attackDone</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Attacking the map center with all available units!&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">attackMapCenterWithArmy</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">attackDone</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">attackDone</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span> <span class="o">==</span> <span class="n">Player</span><span class="o">.</span><span class="n">PLAYER_ONE</span><span class="p">:</span>
                <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_ONE_ARMY_COUNT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">army_count</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_TWO_ARMY_COUNT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">army_count</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span> <span class="o">==</span> <span class="n">Player</span><span class="o">.</span><span class="n">PLAYER_ONE</span> <span class="ow">and</span> <span class="p">(</span><span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_ONE_ARMY_COUNT</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_TWO_ARMY_COUNT</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_ONE_ARMY_COUNT</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_TWO_ARMY_COUNT</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Its a tie!&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_ONE_ARMY_COUNT</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Player two won the match!&quot;</span><span class="p">)</span>
                <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">WINNER</span> <span class="o">=</span> <span class="n">Winner</span><span class="o">.</span><span class="n">PLAYER_TWO</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Player one won the match!&quot;</span><span class="p">)</span>
                <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">WINNER</span> <span class="o">=</span> <span class="n">Winner</span><span class="o">.</span><span class="n">PLAYER_ONE</span>

        <span class="k">if</span> <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">WINNER</span> <span class="o">!=</span> <span class="n">Winner</span><span class="o">.</span><span class="n">UNKNOWN</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span> <span class="o">==</span> <span class="n">Player</span><span class="o">.</span><span class="n">PLAYER_ONE</span> <span class="ow">and</span> <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">WINNER</span> <span class="o">==</span> <span class="n">Winner</span><span class="o">.</span><span class="n">PLAYER_TWO</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Player one should surrender now!&quot;</span><span class="p">)</span>
                <span class="c1">#self.client.leave()</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Player one lost the game and surrendered!&quot;</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span> <span class="o">==</span> <span class="n">Player</span><span class="o">.</span><span class="n">PLAYER_TWO</span> <span class="ow">and</span> <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">WINNER</span> <span class="o">==</span> <span class="n">Winner</span><span class="o">.</span><span class="n">PLAYER_ONE</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Player two should surrender now!&quot;</span><span class="p">)</span>
                <span class="c1">#self.client.leave()</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Player two lost the game and surrendered!&quot;</span><span class="p">)</span>
            

        
        <span class="bp">self</span><span class="o">.</span><span class="n">checkAndAdvance</span><span class="p">()</span>
        
        <span class="c1"># distribute workers</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">myWorkerDistribution</span><span class="p">()</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">expansionLocationsComputed</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">done</span>

        
</pre></div>

  </div>

  </header>

  <section id="section-items">
    <h2 class="section-title" id="header-variables">Module variables</h2>
      <div class="item">
      <p id="BuildListProcessBotBase.ALL_GAS" class="name">var <span class="ident">ALL_GAS</span></p>
      
  
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="BuildListProcessBotBase.BASE_BUILDINGS" class="name">var <span class="ident">BASE_BUILDINGS</span></p>
      
  
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="BuildListProcessBotBase.CONVERT_TO_ID" class="name">var <span class="ident">CONVERT_TO_ID</span></p>
      
  
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="BuildListProcessBotBase.EQUIVALENTS_FOR_TECH_PROGRESS" class="name">var <span class="ident">EQUIVALENTS_FOR_TECH_PROGRESS</span></p>
      
  
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="BuildListProcessBotBase.IS_STRUCTURE" class="name">var <span class="ident">IS_STRUCTURE</span></p>
      
  
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="BuildListProcessBotBase.PROTOSS_TECH_REQUIREMENT" class="name">var <span class="ident">PROTOSS_TECH_REQUIREMENT</span></p>
      
  
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="BuildListProcessBotBase.TERRAN_TECH_REQUIREMENT" class="name">var <span class="ident">TERRAN_TECH_REQUIREMENT</span></p>
      
  
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="BuildListProcessBotBase.UNIT_TRAINED_FROM" class="name">var <span class="ident">UNIT_TRAINED_FROM</span></p>
      
  
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="BuildListProcessBotBase.ZERG_TECH_REQUIREMENT" class="name">var <span class="ident">ZERG_TECH_REQUIREMENT</span></p>
      
  
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="BuildListProcessBotBase.raceBasicTownhall" class="name">var <span class="ident">raceBasicTownhall</span></p>
      
  
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="BuildListProcessBotBase.race_gas" class="name">var <span class="ident">race_gas</span></p>
      
  
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="BuildListProcessBotBase.race_supplyUnit" class="name">var <span class="ident">race_supplyUnit</span></p>
      
  
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="BuildListProcessBotBase.race_townhalls" class="name">var <span class="ident">race_townhalls</span></p>
      
  
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="BuildListProcessBotBase.race_worker" class="name">var <span class="ident">race_worker</span></p>
      
  
  <div class="source_cont">
</div>

      </div>


    <h2 class="section-title" id="header-classes">Classes</h2>
      
      <div class="item">
      <p id="BuildListProcessBotBase.BuildListProcessBotBase" class="name">class <span class="ident">BuildListProcessBotBase</span></p>
      
  
    <div class="desc"><p>Base Class for different race specific bots.</p>
<p>Combines functionality for clean race specific implementations. It
combines buildlist processing capability and precondition checking. 
There is a lot more functionality in here to ease implementation.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">BuildListProcessBotBase</span><span class="p">(</span><span class="n">sc2</span><span class="o">.</span><span class="n">BotAI</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Base Class for different race specific bots.</span>

<span class="sd">    Combines functionality for clean race specific implementations. It</span>
<span class="sd">    combines buildlist processing capability and precondition checking. </span>
<span class="sd">    There is a lot more functionality in here to ease implementation.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Constructor</span>
    <span class="c1"># ----------------------------------------</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputBuildList</span><span class="p">,</span> <span class="n">player</span><span class="p">:</span> <span class="n">Player</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize the bot.</span>
<span class="sd">        </span>
<span class="sd">        Provide a buildlist as a list of build tasks. Strings must be</span>
<span class="sd">        written as in CONVERT_TO_ID from BuildListProcessorDicts.py.</span>

<span class="sd">        Player param must be either player one or player two.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># player as string</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">playerString</span> <span class="o">=</span> <span class="s2">&quot;UNKNOWN&quot;</span>
        <span class="k">if</span> <span class="n">player</span> <span class="o">==</span> <span class="n">Player</span><span class="o">.</span><span class="n">PLAYER_ONE</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">playerString</span> <span class="o">=</span> <span class="s2">&quot;PlayerOne&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">playerString</span> <span class="o">=</span> <span class="s2">&quot;PlayerTwo&quot;</span>
        <span class="c1"># logging</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;BuildListProcessBotBase&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">playerString</span><span class="p">)</span>
        <span class="c1"># player</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="p">:</span> <span class="n">Player</span> <span class="o">=</span> <span class="n">player</span>
        <span class="c1"># start locations of both players</span>
        <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_ONE_START_LOCATION</span><span class="p">:</span> <span class="n">StartLocation</span> <span class="o">=</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">UNKNOWN</span>
        <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_TWO_START_LOCATION</span><span class="p">:</span> <span class="n">StartLocation</span> <span class="o">=</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">UNKNOWN</span>
        <span class="c1"># my start location</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">startLocation</span><span class="p">:</span> <span class="n">StartLocation</span> <span class="o">=</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">UNKNOWN</span>
        <span class="c1"># communication between bots</span>
        <span class="c1"># will be set when player one has set his start location</span>
        <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_ONE_START_LOCATION_EVENT</span><span class="p">:</span> <span class="n">threading</span><span class="o">.</span><span class="n">Event</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>
        <span class="c1"># will be set when player two has set his start location</span>
        <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_TWO_START_LOCATION_EVENT</span><span class="p">:</span> <span class="n">threading</span><span class="o">.</span><span class="n">Event</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>
        <span class="c1"># expansion locations (different datastructures for computing the expansion locations)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">expansionLocationsComputed</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bottomExpansions</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">topExpansions</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">leftExpansions</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rightExpansions</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_ONE_EXPANSION_LOCATIONS</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_TWO_EXPANSION_LOCATIONS</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">expansionLocations</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="c1"># build list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buildList</span> <span class="o">=</span> <span class="n">inputBuildList</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span> <span class="o">=</span> <span class="n">UnitTypeId</span><span class="o">.</span><span class="n">NOTAUNIT</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">done</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remainingBuildTasks</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

        <span class="c1"># gas building locations</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">occupiedGeysers</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

        <span class="c1"># attacking</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attacking</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_ONE_READY_TO_ATTACK</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_TWO_READY_TO_ATTACK</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attackDone</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_ONE_ARMY_COUNT</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_TWO_ARMY_COUNT</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">WINNER</span><span class="p">:</span> <span class="n">Winner</span> <span class="o">=</span> <span class="n">Winner</span><span class="o">.</span><span class="n">UNKNOWN</span>


    <span class="c1"># Startup Preparation</span>
    <span class="c1"># ----------------------------------------</span>
    
    <span class="k">def</span> <span class="nf">setSelfStartLocation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Derive start location from coordinates.</span>

<span class="sd">        Sets the bots start location (enum StartLocation in BuildListProcesserDicts.py)</span>
<span class="sd">        based on the start location coordinates.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game_info</span><span class="o">.</span><span class="n">player_start_location</span><span class="o">.</span><span class="n">x</span> <span class="o">==</span> <span class="mf">24.5</span><span class="p">):</span>
            <span class="c1"># left side of map</span>
            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game_info</span><span class="o">.</span><span class="n">player_start_location</span><span class="o">.</span><span class="n">y</span> <span class="o">==</span> <span class="mf">22.5</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">startLocation</span> <span class="o">=</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">BOTTOM_LEFT</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">startLocation</span> <span class="o">=</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">TOP_LEFT</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># right side of map</span>
            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game_info</span><span class="o">.</span><span class="n">player_start_location</span><span class="o">.</span><span class="n">y</span> <span class="o">==</span> <span class="mf">22.5</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">startLocation</span> <span class="o">=</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">BOTTOM_RIGHT</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">startLocation</span> <span class="o">=</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">TOP_RIGHT</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Start location is &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">startLocation</span><span class="p">))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span> <span class="o">==</span> <span class="n">Player</span><span class="o">.</span><span class="n">PLAYER_ONE</span><span class="p">:</span>
            <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_ONE_START_LOCATION</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">startLocation</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_TWO_START_LOCATION</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">startLocation</span>

    <span class="k">def</span> <span class="nf">getCorrespondingStartLocation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">point</span><span class="p">:</span> <span class="n">Point2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;For a point get the start location.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mf">24.5</span><span class="p">):</span>
            <span class="c1"># left side of map</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mf">22.5</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">BOTTOM_LEFT</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">TOP_LEFT</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># right side of map</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mf">22.5</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">BOTTOM_RIGHT</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">TOP_RIGHT</span>

    <span class="k">def</span> <span class="nf">getLocationFromStartLocation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">startLocation</span><span class="p">:</span> <span class="n">StartLocation</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the coordinates for a start location.</span>
<span class="sd">        </span>
<span class="sd">        Counterpart to getCorrespondingStartLocation().</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">startLocation</span> <span class="o">==</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">BOTTOM_LEFT</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Point2</span><span class="p">((</span><span class="mf">24.5</span><span class="p">,</span> <span class="mf">22.5</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">startLocation</span> <span class="o">==</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">BOTTOM_RIGHT</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Point2</span><span class="p">((</span><span class="mf">127.5</span><span class="p">,</span> <span class="mf">22.5</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">startLocation</span> <span class="o">==</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">TOP_RIGHT</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Point2</span><span class="p">((</span><span class="mf">127.5</span><span class="p">,</span> <span class="mf">125.5</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">startLocation</span> <span class="o">==</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">TOP_LEFT</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Point2</span><span class="p">((</span><span class="mf">24.5</span><span class="p">,</span> <span class="mf">125.5</span><span class="p">))</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Location is not a start location! &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">startLocation</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">findNextExpansion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">current</span><span class="p">:</span> <span class="n">Point2</span><span class="p">,</span> <span class="n">ccwDirection</span><span class="p">:</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the next expansion in a certain direction.</span>

<span class="sd">        Only works on simple map. This is used in determining the expansions for</span>
<span class="sd">        each bot on the map.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">current</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">game_info</span><span class="o">.</span><span class="n">start_locations</span> <span class="o">+</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">game_info</span><span class="o">.</span><span class="n">player_start_location</span><span class="p">]:</span>
            <span class="c1"># first need to check if current is one of the start locations</span>
            <span class="c1"># &quot;corners of map&quot;</span>
            <span class="n">correspondingStartLocation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getCorrespondingStartLocation</span><span class="p">(</span><span class="n">current</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">correspondingStartLocation</span> <span class="o">==</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">UNKNOWN</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Could not find start location for &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">current</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">ccwDirection</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">correspondingStartLocation</span> <span class="o">==</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">BOTTOM_LEFT</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bottomExpansions</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># they are sorted from low to high x so this is fine</span>
                <span class="k">if</span> <span class="n">correspondingStartLocation</span> <span class="o">==</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">BOTTOM_RIGHT</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rightExpansions</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">correspondingStartLocation</span> <span class="o">==</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">TOP_RIGHT</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">topExpansions</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">topExpansions</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">correspondingStartLocation</span> <span class="o">==</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">TOP_LEFT</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">leftExpansions</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">leftExpansions</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># cw direction</span>
                <span class="k">if</span> <span class="n">correspondingStartLocation</span> <span class="o">==</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">BOTTOM_LEFT</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">leftExpansions</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">correspondingStartLocation</span> <span class="o">==</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">BOTTOM_RIGHT</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bottomExpansions</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bottomExpansions</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">correspondingStartLocation</span> <span class="o">==</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">TOP_RIGHT</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rightExpansions</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rightExpansions</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">correspondingStartLocation</span> <span class="o">==</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">TOP_LEFT</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">topExpansions</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># not in one of the corners</span>
            <span class="k">if</span> <span class="n">current</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bottomExpansions</span><span class="p">:</span>
                <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bottomExpansions</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">current</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ccwDirection</span><span class="p">:</span>
                    <span class="c1"># go right</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bottomExpansions</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># go left</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bottomExpansions</span><span class="p">[</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">current</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rightExpansions</span><span class="p">:</span>
                <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rightExpansions</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">current</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ccwDirection</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rightExpansions</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rightExpansions</span><span class="p">[</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">current</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">topExpansions</span><span class="p">:</span>
                <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">topExpansions</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">current</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ccwDirection</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">topExpansions</span><span class="p">[</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">topExpansions</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">current</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">leftExpansions</span><span class="p">:</span>
                <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">leftExpansions</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">current</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ccwDirection</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">leftExpansions</span><span class="p">[</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">leftExpansions</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">computeExpansionLocations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Computes expansion locations.</span>
<span class="sd">        </span>
<span class="sd">        Only works on simple map. This is used in determining the expansions for</span>
<span class="sd">        each bot on the map.&quot;&quot;&quot;</span>
        <span class="n">possibleExpansionLocations</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

        <span class="c1"># add all expansions including player start locations to the set</span>
        <span class="k">for</span> <span class="n">expansionLocation</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">expansion_locations_list</span><span class="p">:</span>
            <span class="n">possibleExpansionLocations</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">expansionLocation</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">expansionLocation</span> <span class="ow">in</span> <span class="n">possibleExpansionLocations</span><span class="p">:</span>
            <span class="c1"># the bottom row of expansions is roughly at 22.5</span>
            <span class="c1"># use a threshhold to ensure every single one is in</span>
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">expansionLocation</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mf">22.5</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">2.0</span><span class="p">:</span> 
                <span class="bp">self</span><span class="o">.</span><span class="n">bottomExpansions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">expansionLocation</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bottomExpansions</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">expansionLocation</span> <span class="ow">in</span> <span class="n">possibleExpansionLocations</span><span class="p">:</span>
            <span class="c1"># the top row of expansions is roughly at 125.5</span>
            <span class="c1"># use a threshhold to ensure every single one is in</span>
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">expansionLocation</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mf">125.5</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">2.0</span><span class="p">:</span> 
                <span class="bp">self</span><span class="o">.</span><span class="n">topExpansions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">expansionLocation</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">topExpansions</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">expansionLocation</span> <span class="ow">in</span> <span class="n">possibleExpansionLocations</span><span class="p">:</span>
            <span class="c1"># the left column of expansions is roughly at 24.5</span>
            <span class="c1"># use a threshhold to ensure every single one is in</span>
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">expansionLocation</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">24.5</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">2.0</span><span class="p">:</span> 
                <span class="bp">self</span><span class="o">.</span><span class="n">leftExpansions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">expansionLocation</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">leftExpansions</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">expansionLocation</span> <span class="ow">in</span> <span class="n">possibleExpansionLocations</span><span class="p">:</span>
            <span class="c1"># the right column of expansions is roughly at 24.5</span>
            <span class="c1"># use a threshhold to ensure every single one is in</span>
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">expansionLocation</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">127.5</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">2.0</span><span class="p">:</span> 
                <span class="bp">self</span><span class="o">.</span><span class="n">rightExpansions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">expansionLocation</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rightExpansions</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="c1"># there is always two directions in which we could go to find expansions:</span>
        <span class="c1"># in ccw and in cw direction</span>
        <span class="c1"># we always prefer ccw direction but alternate between the two to stay close to our main</span>

        <span class="c1"># my side:</span>
        <span class="c1"># --------------------</span>

        <span class="n">playerOnePreferredExpansionCCWDirection</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="n">playerOnePreferredExpansionCWDirection</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>

        <span class="n">currentCCW</span><span class="p">:</span> <span class="n">Point2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getLocationFromStartLocation</span><span class="p">(</span><span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_ONE_START_LOCATION</span><span class="p">)</span>
        <span class="n">currentCW</span><span class="p">:</span> <span class="n">Point2</span> <span class="o">=</span> <span class="n">currentCCW</span>

        <span class="n">currentCCW</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">findNextExpansion</span><span class="p">(</span><span class="n">currentCCW</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">currentCW</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">findNextExpansion</span><span class="p">(</span><span class="n">currentCW</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

        <span class="k">while</span> <span class="n">currentCW</span> <span class="o">!=</span> <span class="n">currentCCW</span><span class="p">:</span>
            <span class="c1"># store</span>
            <span class="n">playerOnePreferredExpansionCCWDirection</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">currentCCW</span><span class="p">)</span>
            <span class="n">playerOnePreferredExpansionCWDirection</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">currentCW</span><span class="p">)</span>
            <span class="c1"># advance</span>
            <span class="n">currentCCW</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">findNextExpansion</span><span class="p">(</span><span class="n">currentCCW</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
            <span class="n">currentCW</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">findNextExpansion</span><span class="p">(</span><span class="n">currentCW</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        
        <span class="c1"># append one last time</span>
        <span class="n">playerOnePreferredExpansionCCWDirection</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">currentCCW</span><span class="p">)</span>
        <span class="n">playerOnePreferredExpansionCWDirection</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">currentCW</span><span class="p">)</span>

        <span class="c1"># opponents side side:</span>
        <span class="c1"># --------------------</span>

        <span class="n">playerTwoPreferredExpansionCCWDirection</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="n">playerTwoPreferredExpansionCWDirection</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>

        <span class="n">currentCCW</span><span class="p">:</span> <span class="n">Point2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getLocationFromStartLocation</span><span class="p">(</span><span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_TWO_START_LOCATION</span><span class="p">)</span>
        <span class="n">currentCW</span><span class="p">:</span> <span class="n">Point2</span> <span class="o">=</span> <span class="n">currentCCW</span>

        <span class="n">currentCCW</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">findNextExpansion</span><span class="p">(</span><span class="n">currentCCW</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">currentCW</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">findNextExpansion</span><span class="p">(</span><span class="n">currentCW</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

        <span class="k">while</span> <span class="n">currentCW</span> <span class="o">!=</span> <span class="n">currentCCW</span><span class="p">:</span>
            <span class="c1"># store</span>
            <span class="n">playerTwoPreferredExpansionCCWDirection</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">currentCCW</span><span class="p">)</span>
            <span class="n">playerTwoPreferredExpansionCWDirection</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">currentCW</span><span class="p">)</span>
            <span class="c1"># advance</span>
            <span class="n">currentCCW</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">findNextExpansion</span><span class="p">(</span><span class="n">currentCCW</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
            <span class="n">currentCW</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">findNextExpansion</span><span class="p">(</span><span class="n">currentCW</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        
        <span class="c1"># append one last time</span>
        <span class="n">playerTwoPreferredExpansionCCWDirection</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">currentCCW</span><span class="p">)</span>
        <span class="n">playerTwoPreferredExpansionCWDirection</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">currentCW</span><span class="p">)</span>

        <span class="c1"># now of both players the preferences of expansions in both possible directions are known</span>
        
        <span class="c1"># remove both start locations from possibleExpansionLocations</span>
        <span class="n">possibleExpansionLocations</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getLocationFromStartLocation</span><span class="p">(</span><span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_ONE_START_LOCATION</span><span class="p">))</span>
        <span class="n">possibleExpansionLocations</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getLocationFromStartLocation</span><span class="p">(</span><span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_TWO_START_LOCATION</span><span class="p">))</span>

        <span class="n">playerOneExpansionLocations</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="n">playerTwoExpansionLocations</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>

        <span class="c1"># ccw direction is always taken first</span>
        <span class="n">ccwRoundPlayerOne</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">ccwRoundPlayerTwo</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">while</span> <span class="nb">bool</span><span class="p">(</span><span class="n">possibleExpansionLocations</span><span class="p">):</span>
            <span class="c1"># player one goes first</span>
            <span class="k">if</span> <span class="n">ccwRoundPlayerOne</span><span class="p">:</span>  
                <span class="n">playerOneSelectedExpansion</span> <span class="o">=</span> <span class="n">playerOnePreferredExpansionCCWDirection</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">playerOneSelectedExpansion</span> <span class="ow">in</span> <span class="n">possibleExpansionLocations</span><span class="p">:</span>
                    <span class="n">playerOneExpansionLocations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">playerOneSelectedExpansion</span><span class="p">)</span>
                    <span class="n">possibleExpansionLocations</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">playerOneSelectedExpansion</span><span class="p">)</span>
                    <span class="n">ccwRoundPlayerOne</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">playerOneSelectedExpansion</span> <span class="o">=</span> <span class="n">playerOnePreferredExpansionCWDirection</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">playerOneSelectedExpansion</span> <span class="ow">in</span> <span class="n">possibleExpansionLocations</span><span class="p">:</span>
                        <span class="n">playerOneExpansionLocations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">playerOneSelectedExpansion</span><span class="p">)</span>
                        <span class="n">possibleExpansionLocations</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">playerOneSelectedExpansion</span><span class="p">)</span>
                        <span class="n">ccwRoundPlayerOne</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;There are no expansion locations left for player one even though there is still locations available!&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">playerOneSelectedExpansion</span> <span class="o">=</span> <span class="n">playerOnePreferredExpansionCWDirection</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">playerOneSelectedExpansion</span> <span class="ow">in</span> <span class="n">possibleExpansionLocations</span><span class="p">:</span>
                    <span class="n">playerOneExpansionLocations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">playerOneSelectedExpansion</span><span class="p">)</span>
                    <span class="n">possibleExpansionLocations</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">playerOneSelectedExpansion</span><span class="p">)</span>
                    <span class="n">ccwRoundPlayerOne</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">playerOneSelectedExpansion</span> <span class="o">=</span> <span class="n">playerOnePreferredExpansionCCWDirection</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">playerOneSelectedExpansion</span> <span class="ow">in</span> <span class="n">possibleExpansionLocations</span><span class="p">:</span>
                        <span class="n">playerOneExpansionLocations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">playerOneSelectedExpansion</span><span class="p">)</span>
                        <span class="n">possibleExpansionLocations</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">playerOneSelectedExpansion</span><span class="p">)</span>
                        <span class="n">ccwRoundPlayerOne</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;There are no expansion locations left for player one even though there is still locations available!&quot;</span><span class="p">)</span>
            <span class="c1"># player two goes second</span>
            <span class="k">if</span> <span class="n">ccwRoundPlayerTwo</span><span class="p">:</span>
                <span class="n">playerTwoSelectedExpansion</span> <span class="o">=</span> <span class="n">playerTwoPreferredExpansionCCWDirection</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">playerTwoSelectedExpansion</span> <span class="ow">in</span> <span class="n">possibleExpansionLocations</span><span class="p">:</span>
                    <span class="n">playerTwoExpansionLocations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">playerTwoSelectedExpansion</span><span class="p">)</span>
                    <span class="n">possibleExpansionLocations</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">playerTwoSelectedExpansion</span><span class="p">)</span>
                    <span class="n">ccwRoundPlayerTwo</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">playerTwoSelectedExpansion</span> <span class="o">=</span> <span class="n">playerTwoPreferredExpansionCWDirection</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">playerTwoSelectedExpansion</span> <span class="ow">in</span> <span class="n">possibleExpansionLocations</span><span class="p">:</span>
                        <span class="n">playerTwoExpansionLocations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">playerTwoSelectedExpansion</span><span class="p">)</span>
                        <span class="n">possibleExpansionLocations</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">playerTwoSelectedExpansion</span><span class="p">)</span>
                        <span class="n">ccwRoundPlayerTwo</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;There are no expansion locations left for player one even though there is still locations available!&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">playerTwoSelectedExpansion</span> <span class="o">=</span> <span class="n">playerTwoPreferredExpansionCWDirection</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">playerTwoSelectedExpansion</span> <span class="ow">in</span> <span class="n">possibleExpansionLocations</span><span class="p">:</span>
                    <span class="n">playerTwoExpansionLocations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">playerTwoSelectedExpansion</span><span class="p">)</span>
                    <span class="n">possibleExpansionLocations</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">playerTwoSelectedExpansion</span><span class="p">)</span>
                    <span class="n">ccwRoundPlayerTwo</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">playerTwoSelectedExpansion</span> <span class="o">=</span> <span class="n">playerTwoPreferredExpansionCCWDirection</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">playerTwoSelectedExpansion</span> <span class="ow">in</span> <span class="n">possibleExpansionLocations</span><span class="p">:</span>
                        <span class="n">playerTwoExpansionLocations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">playerTwoSelectedExpansion</span><span class="p">)</span>
                        <span class="n">possibleExpansionLocations</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">playerTwoSelectedExpansion</span><span class="p">)</span>
                        <span class="n">ccwRoundPlayerTwo</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;There are no expansion locations left for player one even though there is still locations available!&quot;</span><span class="p">)</span>

        
        
        


        <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_ONE_EXPANSION_LOCATIONS</span> <span class="o">=</span> <span class="n">playerOneExpansionLocations</span>
        <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_TWO_EXPANSION_LOCATIONS</span> <span class="o">=</span> <span class="n">playerTwoExpansionLocations</span>   

        <span class="k">return</span>

    <span class="k">def</span> <span class="nf">fillExpansionLocations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Wrapper for calling computeExpansionLocations() and doing some logging.</span>

<span class="sd">        Only works on simple map. This is used in determining the expansions for</span>
<span class="sd">        each bot on the map.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span><span class="p">(</span><span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_TWO_START_LOCATION</span> <span class="o">!=</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">UNKNOWN</span><span class="p">)</span>
        <span class="k">assert</span><span class="p">(</span><span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_ONE_START_LOCATION</span> <span class="o">!=</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">UNKNOWN</span><span class="p">)</span>
        <span class="c1"># compute expansions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Computing expansion locations...&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">computeExpansionLocations</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Player one expansion locations: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_ONE_EXPANSION_LOCATIONS</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Player two expansion locations: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_TWO_EXPANSION_LOCATIONS</span><span class="p">))</span>
    
    <span class="k">def</span> <span class="nf">onStartBase</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Call this from implementing bot in on_start().</span>

<span class="sd">        startup routine. Should prepare:</span>
<span class="sd">           - enemy location </span>
<span class="sd">           - scan the buildlist</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setSelfStartLocation</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Available start locations: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game_info</span><span class="o">.</span><span class="n">start_locations</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scanBuildList</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prepareBuildListCompletedCheck</span><span class="p">()</span>
    
    <span class="c1"># BuildList</span>
    <span class="c1"># ----------------------------------------</span>

    <span class="k">def</span> <span class="nf">checkAndAdvance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Checks buildlist progress and advances it.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">done</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span> <span class="o">==</span> <span class="n">UnitTypeId</span><span class="o">.</span><span class="n">NOTAUNIT</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buildList</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="c1"># extract first build list element and set as current task</span>
                    <span class="n">nextTaskName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">buildList</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">unitToId</span><span class="p">(</span><span class="n">nextTaskName</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Beginning next task: &quot;</span> <span class="o">+</span> <span class="n">nextTaskName</span> <span class="o">+</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">done</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">finishedCurrentTask</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Advance buildlist by one task.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Finished task: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span> <span class="o">=</span> <span class="n">UnitTypeId</span><span class="o">.</span><span class="n">NOTAUNIT</span>

    <span class="k">def</span> <span class="nf">scanBuildList</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Preprocess/check of buildlist.</span>

<span class="sd">        Checks: </span>
<span class="sd">        - number of expansions must be smaller or equal to seven</span>
<span class="sd">        - number of gas buildings must be smaller or equal to 2*(numberOfExpansions+1)</span>
<span class="sd">        - everything in buildlist is known to the bot</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">buildListCopy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">buildList</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="n">expansionCount</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">gasBuildingCount</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">buildListCopy</span><span class="p">:</span>
            <span class="n">unitId</span><span class="p">:</span> <span class="n">UnitTypeId</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">unitToId</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">unitId</span> <span class="o">==</span> <span class="n">raceBasicTownhall</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">race</span><span class="p">]:</span>
                <span class="n">expansionCount</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="n">unitId</span> <span class="o">==</span> <span class="n">race_gas</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">race</span><span class="p">]:</span>
                <span class="n">gasBuildingCount</span> <span class="o">+=</span> <span class="mi">1</span>
        
        <span class="k">if</span> <span class="n">expansionCount</span> <span class="o">&gt;</span> <span class="mi">7</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;BuildList is invalid! To many expansions. Max: 7; Have: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">expansionCount</span><span class="p">))</span>

        <span class="c1"># add one to expansion count (natural)</span>
        <span class="n">expansionCount</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">maxNumberOfGas</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">expansionCount</span> <span class="o">*</span> <span class="mi">2</span>

        <span class="k">if</span> <span class="n">gasBuildingCount</span> <span class="o">&gt;</span> <span class="n">maxNumberOfGas</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;BuildList is invalid! To many gas buildings. Max:&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">maxNumberOfGas</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;; Have: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">gasBuildingCount</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;BuildList has no errors.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">prepareBuildListCompletedCheck</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Setup check when buildlist is completed that everything was built.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remainingBuildTasks</span><span class="p">[</span><span class="n">race_worker</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">race</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">12</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remainingBuildTasks</span><span class="p">[</span><span class="n">raceBasicTownhall</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">race</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">raceSpecificUnitAndStructureCreations</span><span class="p">()</span>
        <span class="c1"># add everything from build list</span>
        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">buildList</span><span class="p">:</span>
            <span class="c1"># convert to id</span>
            <span class="n">unitId</span><span class="p">:</span> <span class="n">UnitTypeId</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">unitToId</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">unitId</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">remainingBuildTasks</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">remainingBuildTasks</span><span class="p">[</span><span class="n">unitId</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">remainingBuildTasks</span><span class="p">[</span><span class="n">unitId</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Created remaining build tasks data structure: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">remainingBuildTasks</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">raceSpecificUnitAndStructureCreations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Add certain unit creations to build list completed check.</span>

<span class="sd">        Thhis has to be implemented by a child class to avoid counting initial units </span>
<span class="sd">        (automatically given at the start of the game) as units that were created</span>
<span class="sd">        use self.remainingBuildTasks to include them</span>
<span class="sd">        an example for workers is given in self.prepareBuildListCompletedCheck()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Has to be implemented by race specific class!&quot;</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">on_building_construction_complete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unit</span><span class="p">:</span> <span class="n">Unit</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;When building is completed store that for later checks.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">raceSpecificStructureCompletedIgnore</span><span class="p">(</span><span class="n">unit</span><span class="o">.</span><span class="n">type_id</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Structure &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">unit</span><span class="o">.</span><span class="n">type_id</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; completed!&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remainingBuildTasks</span><span class="p">[</span><span class="n">unit</span><span class="o">.</span><span class="n">type_id</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">on_unit_created</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unit</span><span class="p">:</span> <span class="n">Unit</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;When unit is created store that for later checks.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">raceSpecificUnitCompletedIgnore</span><span class="p">(</span><span class="n">unit</span><span class="o">.</span><span class="n">type_id</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Unit &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">unit</span><span class="o">.</span><span class="n">type_id</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; completed!&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remainingBuildTasks</span><span class="p">[</span><span class="n">unit</span><span class="o">.</span><span class="n">type_id</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">raceSpecificStructureCompletedIgnore</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unit</span><span class="p">:</span> <span class="n">UnitTypeId</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Some structures need to be ignored by races.&quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Has to be implemented by race specific bot!&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">raceSpecificUnitCompletedIgnore</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unit</span><span class="p">:</span> <span class="n">UnitTypeId</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Some units need to be ignored by races.&quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Has to be implemented by race specific bot!&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">checkBuildListCompleted</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Post buildlist completed check.</span>

<span class="sd">        This does not check if the list of build tasks is empty but it checks</span>
<span class="sd">        if all buildings are ready and idle and if all remaining build tasks</span>
<span class="sd">        have been completed</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">done</span><span class="p">:</span>

            <span class="n">allStructuresReady</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">allStructuresIdle</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="k">for</span> <span class="n">structure</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">structures</span><span class="p">:</span>
                <span class="n">allStructuresReady</span> <span class="o">=</span> <span class="n">allStructuresReady</span> <span class="ow">and</span> <span class="n">structure</span><span class="o">.</span><span class="n">is_ready</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">structure</span><span class="o">.</span><span class="n">is_ready</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">structure</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; is not ready&quot;</span><span class="p">)</span>
                <span class="n">allStructuresIdle</span> <span class="o">=</span> <span class="n">allStructuresIdle</span> <span class="ow">and</span> <span class="n">structure</span><span class="o">.</span><span class="n">is_idle</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">structure</span><span class="o">.</span><span class="n">is_idle</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">structure</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; is not idle&quot;</span><span class="p">)</span>
        
            <span class="n">allUnitsReady</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">for</span> <span class="n">unit</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">:</span>
                <span class="n">allUnitsReady</span> <span class="o">=</span> <span class="n">allUnitsReady</span> <span class="ow">and</span> <span class="n">unit</span><span class="o">.</span><span class="n">is_ready</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">unit</span><span class="o">.</span><span class="n">is_ready</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; is not ready!&quot;</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">race</span> <span class="o">==</span> <span class="n">Race</span><span class="o">.</span><span class="n">Zerg</span><span class="p">:</span>
                <span class="n">allUnitsReady</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">unit</span><span class="p">:</span> <span class="n">unit</span><span class="o">.</span><span class="n">type_id</span> <span class="o">==</span> <span class="n">UnitTypeId</span><span class="o">.</span><span class="n">EGG</span><span class="p">)</span><span class="o">.</span><span class="n">empty</span>


            <span class="k">if</span> <span class="ow">not</span> <span class="n">allStructuresReady</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Buildlist is done but not all structures are ready!&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">allStructuresIdle</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Buildlist is done but not all structures are idle!&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">allUnitsReady</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Buildlist is done but not all units are ready!&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">allStructuresReady</span> <span class="ow">and</span> <span class="n">allStructuresIdle</span> <span class="ow">and</span> <span class="n">allUnitsReady</span><span class="p">:</span>
                <span class="c1"># the final check of remainingBuildTasks if everything was built</span>
                <span class="k">for</span> <span class="n">unitId</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">remainingBuildTasks</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="c1"># safety net for terran (and protoss)</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">already_pending</span><span class="p">(</span><span class="n">unitId</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="k">return</span> <span class="kc">False</span> <span class="c1"># the building is pending --&gt; worker walking to build etc.</span>
                    <span class="k">if</span> <span class="n">unitId</span> <span class="ow">in</span> <span class="n">BASE_BUILDINGS</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;All units: </span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">all_units</span><span class="p">))</span>
                    <span class="k">if</span> <span class="n">count</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">unitId</span> <span class="o">==</span> <span class="n">race_worker</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">race</span><span class="p">]:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;The bot did not produce the correct number of workers. Timings will not be correct but the army strength can still be compared!&quot;</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Everything should be done but &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">unitId</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; was not build as many times as it was supposed to!&quot;</span><span class="p">)</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Everything should be done but &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">unitId</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; was build more than it was supposed to!&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>


        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        
    <span class="c1"># Units</span>
    <span class="c1"># ----------------------------------------</span>
    
    <span class="k">def</span> <span class="nf">unitToId</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unitName</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Convert unit name to id.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">unitName</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">CONVERT_TO_ID</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">unitName</span> <span class="o">+</span> <span class="s2">&quot; is not available in CONVERT_TO_ID!&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">CONVERT_TO_ID</span><span class="p">[</span><span class="n">unitName</span><span class="p">]</span>

    <span class="c1"># returns the ids of producers for the current task</span>
    <span class="k">def</span> <span class="nf">getProducerIdsForCurrentTask</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get producer ids for current task.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span> <span class="ow">in</span> <span class="n">UNIT_TRAINED_FROM</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">UNIT_TRAINED_FROM</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span> <span class="ow">in</span> <span class="n">BASE_BUILDINGS</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">BASE_BUILDINGS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; is not available in UNIT_TRAINED_FROM and not in BASE_BUILDINGS (only terran)!&quot;</span><span class="p">)</span>

    <span class="c1"># returns actual units of producers for the current task</span>
    <span class="k">def</span> <span class="nf">getProducerUnitsForCurrentTask</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the units (actual units in the game) that could produce the current task.</span>

<span class="sd">        Does not check if these units are busy.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">producerIds</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="n">UnitTypeId</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getProducerIdsForCurrentTask</span><span class="p">()</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">structures</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">unit</span><span class="p">:</span> <span class="n">unit</span><span class="o">.</span><span class="n">type_id</span> <span class="ow">in</span> <span class="n">producerIds</span><span class="p">)</span>

    <span class="c1"># returns true if the given unit id is a worker of the currently played race</span>
    <span class="k">def</span> <span class="nf">isWorker</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unitId</span><span class="p">:</span> <span class="n">UnitTypeId</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Checks if a certain unit is a worker.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">race_worker</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">race</span><span class="p">]</span> <span class="o">==</span> <span class="n">unitId</span>

    <span class="c1"># Building/Training Conditions</span>
    <span class="c1"># ----------------------------------------</span>

    <span class="k">def</span> <span class="nf">checkIfProducerExists</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check if a producer for the current task exists.</span>
<span class="sd">        </span>
<span class="sd">        returns a pair of bools stating if a producer is currently available and</span>
<span class="sd">        if we can wait such that it becomes available.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="n">producersAvailable</span><span class="p">:</span> <span class="n">Units</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getProducerUnitsForCurrentTask</span><span class="p">()</span>
        <span class="n">producersAvailable</span> <span class="o">=</span> <span class="n">producersAvailable</span><span class="o">.</span><span class="n">ready</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">producersAvailable</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
            <span class="c1"># is any of these available producers idle</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">producer</span><span class="o">.</span><span class="n">is_idle</span> <span class="ow">or</span> <span class="n">producer</span><span class="o">.</span><span class="n">is_gathering</span> <span class="k">for</span> <span class="n">producer</span> <span class="ow">in</span> <span class="n">producersAvailable</span><span class="p">):</span>
                <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># is any of the unit ids being produced or queued?</span>
            <span class="n">producerIds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getProducerIdsForCurrentTask</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">already_pending</span><span class="p">(</span><span class="n">producerId</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0</span> <span class="k">for</span> <span class="n">producerId</span> <span class="ow">in</span> <span class="n">producerIds</span><span class="p">):</span>
                <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
            <span class="c1"># for zerg producer might be larva. already_pending will not account for that</span>
            <span class="c1"># as long as we have a least one Hatchery/Lair/Hive</span>
            <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">race</span> <span class="o">==</span> <span class="n">Race</span><span class="o">.</span><span class="n">Zerg</span> <span class="ow">and</span> <span class="n">UnitTypeId</span><span class="o">.</span><span class="n">LARVA</span> <span class="ow">in</span> <span class="n">producerIds</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">townhalls</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">checkCosts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check if the current task is affordable.</span>
<span class="sd">        </span>
<span class="sd">        returns a pair of bools stating if the task is currently affordable and</span>
<span class="sd">        if we can wait such that it becomes affordable.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cost</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_cost</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span><span class="p">)</span>

        <span class="c1"># TODO: the check here (self.workers.gathering &gt; 0) does not work for terran and protoss</span>

        <span class="n">minerals</span> <span class="o">=</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cost</span><span class="o">.</span><span class="n">minerals</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">minerals</span><span class="p">:</span>
            <span class="c1"># not enough right now but maybe later?</span>
            <span class="c1"># at least some workers and</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workers</span><span class="o">.</span><span class="n">gathering</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">townhalls</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">minerals</span> <span class="o">=</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">minerals</span> <span class="o">=</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;There are not enough minerals to build &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; and waiting does not help!&quot;</span><span class="p">)</span>
        
        <span class="n">vespene</span> <span class="o">=</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cost</span><span class="o">.</span><span class="n">vespene</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">vespene</span><span class="p">:</span>
            <span class="c1"># not enough right now but maybe later?</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workers</span><span class="o">.</span><span class="n">gathering</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gas_buildings</span><span class="o">.</span><span class="n">ready</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">already_pending</span><span class="p">(</span><span class="n">race_gas</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">race</span><span class="p">]):</span>
                <span class="c1"># waiting helps</span>
                <span class="n">vespene</span> <span class="o">=</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">vespene</span> <span class="o">=</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;There are not enough vespene to build &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; and waiting does not help!&quot;</span><span class="p">)</span>

        <span class="n">supply</span> <span class="o">=</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">supply_cost</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_supply_cost</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span><span class="p">)</span>
        <span class="c1"># make sure this thing actually has supply cost</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span><span class="p">,</span> <span class="n">UnitTypeId</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">supply_cost</span> <span class="ow">and</span> <span class="n">supply_cost</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">supply_left</span><span class="p">:</span>
                <span class="c1"># we dont have enough supply right now but maybe later?</span>
                <span class="n">supply</span> <span class="o">=</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
                <span class="c1"># check if supply building is being built</span>
                <span class="c1"># already pending checks everything: check its documentation</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">already_pending</span><span class="p">(</span><span class="n">race_supplyUnit</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">race</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">supply</span> <span class="o">=</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;There is not enough supply to build &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; and waiting does not help!&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">minerals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">vespene</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">supply</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">minerals</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">and</span> <span class="n">vespene</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">and</span> <span class="n">supply</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">checkIfTechRequirementFulfilled</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check if the tech requirement for the current task is fulfilled.</span>
<span class="sd">        </span>
<span class="sd">        returns a pair of bools stating if the requirement is currently fulfilled and</span>
<span class="sd">        if we can wait such that it becomes fulfilled.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">race_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">Race</span><span class="o">.</span><span class="n">Protoss</span><span class="p">:</span> <span class="n">PROTOSS_TECH_REQUIREMENT</span><span class="p">,</span>
            <span class="n">Race</span><span class="o">.</span><span class="n">Terran</span><span class="p">:</span> <span class="n">TERRAN_TECH_REQUIREMENT</span><span class="p">,</span>
            <span class="n">Race</span><span class="o">.</span><span class="n">Zerg</span><span class="p">:</span> <span class="n">ZERG_TECH_REQUIREMENT</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="c1"># this gets the requirement for the unit we are checking</span>
        <span class="n">requirement</span> <span class="o">=</span> <span class="n">race_dict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">race</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span><span class="p">]</span>
        <span class="c1"># if there is no requirement we can just skip the remaining stuff</span>
        <span class="k">if</span> <span class="n">UnitTypeId</span><span class="o">.</span><span class="n">NOTAUNIT</span> <span class="o">==</span> <span class="n">requirement</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="c1"># </span>
        <span class="n">requirementEquivalents</span> <span class="o">=</span> <span class="p">{</span><span class="n">requirement</span><span class="p">}</span>
        <span class="k">for</span> <span class="n">equiv_structure</span> <span class="ow">in</span> <span class="n">EQUIVALENTS_FOR_TECH_PROGRESS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">requirement</span><span class="p">,</span> <span class="p">[]):</span>
            <span class="n">requirementEquivalents</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">equiv_structure</span><span class="p">)</span>

        <span class="n">correspondingStructures</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structures</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">unit</span><span class="p">:</span> <span class="n">unit</span><span class="o">.</span><span class="n">type_id</span> <span class="ow">in</span> <span class="n">requirementEquivalents</span><span class="p">)</span>

        <span class="c1"># any of them already existing?</span>
        <span class="n">fulfilled</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">correspondingStructures</span><span class="o">.</span><span class="n">ready</span><span class="p">)</span>
            
        <span class="c1"># is any of these pending?</span>
        <span class="c1"># if yes waiting helps</span>
        <span class="c1"># waiting is also fine if it already exists</span>
        <span class="n">waitingHelps</span> <span class="o">=</span> <span class="n">fulfilled</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">fulfilled</span><span class="p">:</span>
            <span class="n">waitingHelps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">already_pending</span><span class="p">(</span><span class="n">requirement</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> 

        <span class="k">return</span> <span class="p">(</span><span class="n">fulfilled</span><span class="p">,</span> <span class="n">waitingHelps</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">checkPreconditions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Combine producer, cost and tech requirement check.</span>
<span class="sd">        </span>
<span class="sd">        returns a bool if the current task can be built right now.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check if the producer exists or is under construction and if the producer is idle</span>
        <span class="n">producerExists</span><span class="p">,</span> <span class="n">canWaitProducer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkIfProducerExists</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">producerExists</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">canWaitProducer</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;There must be a producer for &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span><span class="p">))</span>
        <span class="c1"># check if we can afford the unit/structure</span>
        <span class="n">resourcesExist</span><span class="p">,</span> <span class="n">canWaitResources</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkCosts</span><span class="p">()</span> 
        <span class="k">if</span> <span class="ow">not</span> <span class="n">resourcesExist</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">canWaitResources</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;There is not enough minerals, vespene or supply and waiting for it will not help!&quot;</span><span class="p">)</span>
        <span class="c1"># check if tech requirement is fullfilled only if the resources exist</span>
        <span class="n">requirementFulfilled</span><span class="p">,</span> <span class="n">canWaitRequirement</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkIfTechRequirementFulfilled</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">requirementFulfilled</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">canWaitRequirement</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;The requirement for &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; is not fullfilled!&quot;</span><span class="p">)</span>

        <span class="c1"># just return if we are able to build immediately --&gt; if not that means we have to wait</span>
        <span class="k">return</span> <span class="n">producerExists</span> <span class="ow">and</span> <span class="n">resourcesExist</span> <span class="ow">and</span> <span class="n">requirementFulfilled</span>


        <span class="c1"># finds an appropriate worker (closest to position or unit)</span>
    
    <span class="c1"># Building</span>
    <span class="c1"># ----------------------------------------</span>
    <span class="k">def</span> <span class="nf">getWorker</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Unit</span><span class="p">,</span> <span class="n">Point2</span><span class="p">,</span> <span class="n">Point3</span><span class="p">]):</span>
        <span class="sd">&quot;&quot;&quot;Get a worker closest to a certain point on the map.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">workersGathering</span><span class="p">:</span> <span class="n">Units</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">workers</span><span class="o">.</span><span class="n">gathering</span>

        <span class="k">if</span> <span class="n">workersGathering</span><span class="p">:</span>
            <span class="c1"># select worker closest to pos or unit</span>
            <span class="k">return</span> <span class="n">workersGathering</span><span class="o">.</span><span class="n">closest_to</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;There are no gathering workers which could be used to build &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">buildGasBuildingAtTownhall</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">townhall</span><span class="p">:</span> <span class="n">Unit</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Build gas building at a certain townhall.</span>
<span class="sd">        </span>
<span class="sd">        Needs storage for occupied geysers as library function can_place does not</span>
<span class="sd">        work in that case.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># all vespene geysers closer than distance ten to the current townhall</span>
        <span class="n">vespeneGeysers</span><span class="p">:</span> <span class="n">Units</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vespene_geyser</span><span class="o">.</span><span class="n">closer_than</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">townhall</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Found &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">vespeneGeysers</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot; vespene geyser locations!&quot;</span><span class="p">)</span>
        <span class="c1"># check all locations</span>
        <span class="c1">#  apparently can_place does not work in this situation. it will say that a second refinery can be placed on the occupied geyser</span>
        <span class="k">for</span> <span class="n">vespeneGeyser</span> <span class="ow">in</span> <span class="n">vespeneGeysers</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">vespeneGeyser</span><span class="o">.</span><span class="n">position</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">occupiedGeysers</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">can_place</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span><span class="p">,</span> <span class="p">(</span><span class="n">vespeneGeyser</span><span class="o">.</span><span class="n">position</span><span class="p">)):</span>
                    <span class="n">worker</span><span class="p">:</span> <span class="n">Unit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getWorker</span><span class="p">(</span><span class="n">vespeneGeyser</span><span class="p">)</span>
                    <span class="n">worker</span><span class="o">.</span><span class="n">build_gas</span><span class="p">(</span><span class="n">vespeneGeyser</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">occupiedGeysers</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">vespeneGeyser</span><span class="o">.</span><span class="n">position</span><span class="p">)</span>
                    <span class="k">return</span> <span class="kc">True</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Can place stated not possible to place even though according to self.occupiedGeysers it should be free!&quot;</span><span class="p">)</span>
        
        <span class="c1"># if we reach this we have not found a building location</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">buildGasBuilding</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Build a gas building by selecting a townhall.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># cant build more gas buildings than townhalls</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gas_buildings</span><span class="o">.</span><span class="n">ready</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">already_pending</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">townhalls</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span><span class="p">:</span>
            
            <span class="c1"># prefer townhalls that are ready</span>
            <span class="k">for</span> <span class="n">townhall</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">townhalls</span><span class="o">.</span><span class="n">ready</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">buildGasBuildingAtTownhall</span><span class="p">(</span><span class="n">townhall</span><span class="p">)</span>
            <span class="c1"># townhalls that are not ready</span>
            <span class="k">for</span> <span class="n">townhall</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">townhalls</span><span class="o">.</span><span class="n">not_ready</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">buildGasBuildingAtTownhall</span><span class="p">(</span><span class="n">townhall</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">buildBase</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Build base.</span>
<span class="sd">        </span>
<span class="sd">        Uses the pre computed expansion locations. Only works for simple map.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">expansionLocations</span><span class="p">):</span>
            <span class="n">location</span><span class="p">:</span> <span class="n">Point2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">expansionLocations</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">worker</span><span class="p">:</span> <span class="n">Unit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">workers</span><span class="o">.</span><span class="n">gathering</span><span class="o">.</span><span class="n">closest_to</span><span class="p">(</span><span class="n">location</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">can_place</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span><span class="p">,</span> <span class="n">location</span><span class="p">):</span>
                <span class="n">worker</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span><span class="p">,</span> <span class="n">location</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;could not build the command center where it was supposed to be built!&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;No more places to build command expansions!&quot;</span><span class="p">)</span>

    <span class="c1"># Worker Distribution</span>
    <span class="c1"># ----------------------------------------</span>

    <span class="k">def</span> <span class="nf">myWorkerDistribution</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Redistributes workers to geysers and mineral fields.</span>
<span class="sd">        </span>
<span class="sd">        Redistributes:</span>
<span class="sd">            - idle workers</span>
<span class="sd">            - surplus on townhalls/geysers</span>

<span class="sd">        Taken from https://github.com/BurnySc2/python-sc2/blob/develop/examples/terran/mass_reaper.py and modified.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">mineralTags</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">tag</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mineral_field</span><span class="p">]</span>
        <span class="n">gas_buildingTags</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">tag</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_buildings</span><span class="p">]</span>

        <span class="n">workerPool</span> <span class="o">=</span> <span class="n">Units</span><span class="p">([],</span> <span class="bp">self</span><span class="p">)</span>
        <span class="n">workerPoolTags</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

        <span class="c1"># # Find all gas_buildings that have surplus or deficit</span>
        <span class="n">deficit_gas_buildings</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">surplusgas_buildings</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_buildings</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">vespene_contents</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="c1"># Only loop over gas_buildings that have still gas in them</span>
            <span class="n">deficit</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">ideal_harvesters</span> <span class="o">-</span> <span class="n">g</span><span class="o">.</span><span class="n">assigned_harvesters</span>
            <span class="k">if</span> <span class="n">deficit</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">deficit_gas_buildings</span><span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">tag</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;unit&quot;</span><span class="p">:</span> <span class="n">g</span><span class="p">,</span> <span class="s2">&quot;deficit&quot;</span><span class="p">:</span> <span class="n">deficit</span><span class="p">}</span>
            <span class="k">elif</span> <span class="n">deficit</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">surplusWorkers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">workers</span><span class="o">.</span><span class="n">closer_than</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">w</span><span class="p">:</span> <span class="n">w</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">workerPoolTags</span>
                    <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">orders</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
                    <span class="ow">and</span> <span class="n">w</span><span class="o">.</span><span class="n">orders</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">ability</span><span class="o">.</span><span class="n">id</span> <span class="ow">in</span> <span class="p">[</span><span class="n">AbilityId</span><span class="o">.</span><span class="n">HARVEST_GATHER</span><span class="p">]</span>
                    <span class="ow">and</span> <span class="n">w</span><span class="o">.</span><span class="n">orders</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">target</span> <span class="ow">in</span> <span class="n">gas_buildingTags</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="n">deficit</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">surplusWorkers</span><span class="o">.</span><span class="n">amount</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">w</span> <span class="o">=</span> <span class="n">surplusWorkers</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                        <span class="n">workerPool</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
                        <span class="n">workerPoolTags</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">tag</span><span class="p">)</span>
                <span class="n">surplusgas_buildings</span><span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">tag</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;unit&quot;</span><span class="p">:</span> <span class="n">g</span><span class="p">,</span> <span class="s2">&quot;deficit&quot;</span><span class="p">:</span> <span class="n">deficit</span><span class="p">}</span>

        <span class="c1"># # Find all townhalls that have surplus or deficit</span>
        <span class="n">deficitTownhalls</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">surplusTownhalls</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">th</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">townhalls</span><span class="p">:</span>
            <span class="n">deficit</span> <span class="o">=</span> <span class="n">th</span><span class="o">.</span><span class="n">ideal_harvesters</span> <span class="o">-</span> <span class="n">th</span><span class="o">.</span><span class="n">assigned_harvesters</span>
            <span class="k">if</span> <span class="n">deficit</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">deficitTownhalls</span><span class="p">[</span><span class="n">th</span><span class="o">.</span><span class="n">tag</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;unit&quot;</span><span class="p">:</span> <span class="n">th</span><span class="p">,</span> <span class="s2">&quot;deficit&quot;</span><span class="p">:</span> <span class="n">deficit</span><span class="p">}</span>
            <span class="k">elif</span> <span class="n">deficit</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">surplusWorkers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">workers</span><span class="o">.</span><span class="n">closer_than</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">th</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">w</span><span class="p">:</span> <span class="n">w</span><span class="o">.</span><span class="n">tag</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">workerPoolTags</span>
                    <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">orders</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
                    <span class="ow">and</span> <span class="n">w</span><span class="o">.</span><span class="n">orders</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">ability</span><span class="o">.</span><span class="n">id</span> <span class="ow">in</span> <span class="p">[</span><span class="n">AbilityId</span><span class="o">.</span><span class="n">HARVEST_GATHER</span><span class="p">]</span>
                    <span class="ow">and</span> <span class="n">w</span><span class="o">.</span><span class="n">orders</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">target</span> <span class="ow">in</span> <span class="n">mineralTags</span>
                <span class="p">)</span>
                <span class="c1"># workerPool.extend(surplusWorkers)</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="n">deficit</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">surplusWorkers</span><span class="o">.</span><span class="n">amount</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">w</span> <span class="o">=</span> <span class="n">surplusWorkers</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                        <span class="n">workerPool</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
                        <span class="n">workerPoolTags</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">tag</span><span class="p">)</span>
                <span class="n">surplusTownhalls</span><span class="p">[</span><span class="n">th</span><span class="o">.</span><span class="n">tag</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;unit&quot;</span><span class="p">:</span> <span class="n">th</span><span class="p">,</span> <span class="s2">&quot;deficit&quot;</span><span class="p">:</span> <span class="n">deficit</span><span class="p">}</span>
        
        <span class="c1"># ---------------------------------------------</span>

        <span class="c1"># We now know which building has a deficit and which one has a surplus. If a building has a surplus</span>
        <span class="c1"># the workers are added to the worker pool. Whenever we have anything in the worker pool we want to</span>
        <span class="c1"># distribute those first.</span>

        <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="n">workerPool</span><span class="p">):</span>

            <span class="c1"># iterate deficit townhalls</span>
            <span class="k">for</span> <span class="n">townhallTag</span><span class="p">,</span> <span class="n">info</span> <span class="ow">in</span> <span class="n">deficitTownhalls</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="c1"># get the minerals close to the current townhall</span>
                <span class="n">mineralFields</span><span class="p">:</span> <span class="n">Units</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mineral_field</span><span class="o">.</span><span class="n">closer_than</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">info</span><span class="p">[</span><span class="s2">&quot;unit&quot;</span><span class="p">])</span>
                <span class="c1"># if there are any</span>
                <span class="k">if</span> <span class="n">mineralFields</span><span class="p">:</span>
                    <span class="c1"># get the deficit (missing worker to optimal performance)</span>
                    <span class="n">deficit</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="s2">&quot;deficit&quot;</span><span class="p">]</span>
                    <span class="c1"># check if the worker pool does contain anything</span>
                    <span class="n">workersLeft</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">workerPool</span><span class="p">)</span>
                    <span class="c1"># if there is a deficit move one worker to the townhall from the worker pool</span>
                    <span class="k">if</span> <span class="n">deficit</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">workersLeft</span><span class="p">:</span>
                        <span class="n">worker</span><span class="p">:</span> <span class="n">Unit</span> <span class="o">=</span> <span class="n">workerPool</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                        <span class="n">mineralField</span><span class="p">:</span> <span class="n">Unit</span> <span class="o">=</span> <span class="n">mineralFields</span><span class="o">.</span><span class="n">closest_to</span><span class="p">(</span><span class="n">worker</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Moving one worker to harvest minerals at &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;unit&quot;</span><span class="p">]))</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">worker</span><span class="o">.</span><span class="n">orders</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">worker</span><span class="o">.</span><span class="n">orders</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">ability</span><span class="o">.</span><span class="n">id</span> <span class="ow">in</span> <span class="p">[</span><span class="n">AbilityId</span><span class="o">.</span><span class="n">HARVEST_RETURN</span><span class="p">]:</span>
                            <span class="n">worker</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="n">mineralField</span><span class="p">,</span> <span class="n">queue</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">worker</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="n">mineralField</span><span class="p">)</span>
            <span class="c1"># iterate deficit gas buildings</span>
            <span class="k">for</span> <span class="n">gasTag</span><span class="p">,</span> <span class="n">info</span> <span class="ow">in</span> <span class="n">deficit_gas_buildings</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="c1"># get the deficit (missing worker to optimal performance)</span>
                <span class="n">deficit</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="s2">&quot;deficit&quot;</span><span class="p">]</span>
                <span class="c1"># check if the worker pool does contain anything</span>
                <span class="n">workersLeft</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">workerPool</span><span class="p">)</span>
                <span class="c1"># if there is a deficit move one worker to the townhall from the worker pool</span>
                <span class="k">if</span> <span class="n">deficit</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">workersLeft</span><span class="p">:</span>
                    <span class="n">worker</span><span class="p">:</span> <span class="n">Unit</span> <span class="o">=</span> <span class="n">workerPool</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Moving one worker to harvest gas at &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;unit&quot;</span><span class="p">]))</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">worker</span><span class="o">.</span><span class="n">orders</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">worker</span><span class="o">.</span><span class="n">orders</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">ability</span><span class="o">.</span><span class="n">id</span> <span class="ow">in</span> <span class="p">[</span><span class="n">AbilityId</span><span class="o">.</span><span class="n">HARVEST_RETURN</span><span class="p">]:</span>
                        <span class="n">worker</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;unit&quot;</span><span class="p">],</span> <span class="n">queue</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">worker</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;unit&quot;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Whenever we do not have worker in the worker pool we want to move some workers to harvest gas but only if a certain ratio between</span>
            <span class="c1"># total vespene workers and total mineral workers is not exceeded.</span>

            <span class="n">totalMineralWorkers</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">totalVespeneWorkers</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="k">for</span> <span class="n">townhall</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">townhalls</span><span class="o">.</span><span class="n">ready</span><span class="p">:</span>
                <span class="n">totalMineralWorkers</span> <span class="o">+=</span> <span class="n">townhall</span><span class="o">.</span><span class="n">assigned_harvesters</span>
            <span class="k">for</span> <span class="n">gasBuilding</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_buildings</span><span class="o">.</span><span class="n">ready</span><span class="p">:</span>
                <span class="n">totalVespeneWorkers</span> <span class="o">+=</span> <span class="n">gasBuilding</span><span class="o">.</span><span class="n">assigned_harvesters</span>

            <span class="c1"># only if less than 33% workers are on vespene</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">totalVespeneWorkers</span> <span class="o">/</span> <span class="p">(</span><span class="n">totalMineralWorkers</span> <span class="o">+</span> <span class="n">totalVespeneWorkers</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mf">0.34</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">gasTag</span><span class="p">,</span> <span class="n">info</span> <span class="ow">in</span> <span class="n">deficit_gas_buildings</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">worker</span><span class="p">:</span> <span class="n">Unit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">workers</span><span class="o">.</span><span class="n">gathering</span><span class="o">.</span><span class="n">closest_to</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;unit&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">position</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Moving one worker to &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;unit&quot;</span><span class="p">]))</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">worker</span><span class="o">.</span><span class="n">orders</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">worker</span><span class="o">.</span><span class="n">orders</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">ability</span><span class="o">.</span><span class="n">id</span> <span class="ow">in</span> <span class="p">[</span><span class="n">AbilityId</span><span class="o">.</span><span class="n">HARVEST_RETURN</span><span class="p">]:</span>
                        <span class="n">worker</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;unit&quot;</span><span class="p">],</span> <span class="n">queue</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">worker</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;unit&quot;</span><span class="p">])</span>
        
        <span class="c1"># redistribute idle workers</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workers</span><span class="o">.</span><span class="n">idle</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">townhalls</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">worker</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">workers</span><span class="o">.</span><span class="n">idle</span><span class="p">:</span>
                    <span class="n">townhall</span><span class="p">:</span> <span class="n">Unit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">townhalls</span><span class="o">.</span><span class="n">closest_to</span><span class="p">(</span><span class="n">worker</span><span class="p">)</span>
                    <span class="n">mineralFields</span><span class="p">:</span> <span class="n">Units</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mineral_field</span><span class="o">.</span><span class="n">closer_than</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">townhall</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">mineralFields</span><span class="p">:</span>
                        <span class="n">mineralField</span><span class="p">:</span> <span class="n">Unit</span> <span class="o">=</span> <span class="n">mineralFields</span><span class="o">.</span><span class="n">closest_to</span><span class="p">(</span><span class="n">worker</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Moving one worker to harvest minerals at &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">mineralField</span><span class="p">))</span>
                        <span class="n">worker</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="n">mineralField</span><span class="p">)</span>

    <span class="c1"># Attack</span>
    <span class="c1"># ----------------------------------------</span>

    <span class="k">def</span> <span class="nf">attackMapCenterWithArmy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Has to be implemented by race specific bot.</span>

<span class="sd">        Gather bots army and then move to map center with attack move.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Must be implemented by race specific Bot!&quot;</span><span class="p">)</span>

    <span class="c1"># Run</span>
    <span class="c1"># ----------------------------------------</span>

    <span class="c1"># finishes preprocessing:</span>
    <span class="c1">#   - compute expansion locations</span>
    <span class="k">def</span> <span class="nf">onStepBase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">iteration</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Neeeds to be called from race specific bot.</span>

<span class="sd">        Finishes the preprocessing that could not be done in on_start.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">expansionLocationsComputed</span><span class="p">:</span>
            <span class="c1"># player one will compute for both</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span> <span class="o">==</span> <span class="n">Player</span><span class="o">.</span><span class="n">PLAYER_ONE</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_TWO_START_LOCATION</span> <span class="o">!=</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">UNKNOWN</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">fillExpansionLocations</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">expansionLocationsComputed</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Expansion locations computed at iteration: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">iteration</span><span class="p">))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">expansionLocations</span> <span class="o">=</span> <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_ONE_EXPANSION_LOCATIONS</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_TWO_EXPANSION_LOCATIONS</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Expansion locations available at iteration: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">iteration</span><span class="p">))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">expansionLocations</span> <span class="o">=</span> <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_TWO_EXPANSION_LOCATIONS</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">expansionLocationsComputed</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1"># it is important do to this b4 checking and advancing</span>
        <span class="c1"># because orders will be processed after one step is finished</span>
        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">attacking</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBuildListCompleted</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;All tasks in buildlist are finished and ready to fight!&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span> <span class="o">==</span> <span class="n">Player</span><span class="o">.</span><span class="n">PLAYER_ONE</span><span class="p">:</span>
                <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_ONE_READY_TO_ATTACK</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_TWO_READY_TO_ATTACK</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">attacking</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_TWO_READY_TO_ATTACK</span> <span class="ow">and</span> <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_ONE_READY_TO_ATTACK</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">attackDone</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Attacking the map center with all available units!&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">attackMapCenterWithArmy</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">attackDone</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">attackDone</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span> <span class="o">==</span> <span class="n">Player</span><span class="o">.</span><span class="n">PLAYER_ONE</span><span class="p">:</span>
                <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_ONE_ARMY_COUNT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">army_count</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_TWO_ARMY_COUNT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">army_count</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span> <span class="o">==</span> <span class="n">Player</span><span class="o">.</span><span class="n">PLAYER_ONE</span> <span class="ow">and</span> <span class="p">(</span><span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_ONE_ARMY_COUNT</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_TWO_ARMY_COUNT</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_ONE_ARMY_COUNT</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_TWO_ARMY_COUNT</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Its a tie!&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_ONE_ARMY_COUNT</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Player two won the match!&quot;</span><span class="p">)</span>
                <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">WINNER</span> <span class="o">=</span> <span class="n">Winner</span><span class="o">.</span><span class="n">PLAYER_TWO</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Player one won the match!&quot;</span><span class="p">)</span>
                <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">WINNER</span> <span class="o">=</span> <span class="n">Winner</span><span class="o">.</span><span class="n">PLAYER_ONE</span>

        <span class="k">if</span> <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">WINNER</span> <span class="o">!=</span> <span class="n">Winner</span><span class="o">.</span><span class="n">UNKNOWN</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span> <span class="o">==</span> <span class="n">Player</span><span class="o">.</span><span class="n">PLAYER_ONE</span> <span class="ow">and</span> <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">WINNER</span> <span class="o">==</span> <span class="n">Winner</span><span class="o">.</span><span class="n">PLAYER_TWO</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Player one should surrender now!&quot;</span><span class="p">)</span>
                <span class="c1">#self.client.leave()</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Player one lost the game and surrendered!&quot;</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span> <span class="o">==</span> <span class="n">Player</span><span class="o">.</span><span class="n">PLAYER_TWO</span> <span class="ow">and</span> <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">WINNER</span> <span class="o">==</span> <span class="n">Winner</span><span class="o">.</span><span class="n">PLAYER_ONE</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Player two should surrender now!&quot;</span><span class="p">)</span>
                <span class="c1">#self.client.leave()</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Player two lost the game and surrendered!&quot;</span><span class="p">)</span>
            

        
        <span class="bp">self</span><span class="o">.</span><span class="n">checkAndAdvance</span><span class="p">()</span>
        
        <span class="c1"># distribute workers</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">myWorkerDistribution</span><span class="p">()</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">expansionLocationsComputed</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">done</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#BuildListProcessBotBase.BuildListProcessBotBase">BuildListProcessBotBase</a></li>
          <li>sc2.bot_ai.BotAI</li>
          <li>sc2.distances.DistanceCalculation</li>
          <li>builtins.object</li>
          </ul>
          <h3>Class variables</h3>
            <div class="item">
            <p id="BuildListProcessBotBase.BuildListProcessBotBase.EXPANSION_GAP_THRESHOLD" class="name">var <span class="ident">EXPANSION_GAP_THRESHOLD</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, inputBuildList, player)</p>
    </div>
    

    
  
    <div class="desc"><p>Initialize the bot.</p>
<p>Provide a buildlist as a list of build tasks. Strings must be
written as in CONVERT_TO_ID from BuildListProcessorDicts.py.</p>
<p>Player param must be either player one or player two.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.__init__', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputBuildList</span><span class="p">,</span> <span class="n">player</span><span class="p">:</span> <span class="n">Player</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Initialize the bot.</span>
<span class="sd">    </span>
<span class="sd">    Provide a buildlist as a list of build tasks. Strings must be</span>
<span class="sd">    written as in CONVERT_TO_ID from BuildListProcessorDicts.py.</span>
<span class="sd">    Player param must be either player one or player two.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># player as string</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">playerString</span> <span class="o">=</span> <span class="s2">&quot;UNKNOWN&quot;</span>
    <span class="k">if</span> <span class="n">player</span> <span class="o">==</span> <span class="n">Player</span><span class="o">.</span><span class="n">PLAYER_ONE</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">playerString</span> <span class="o">=</span> <span class="s2">&quot;PlayerOne&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">playerString</span> <span class="o">=</span> <span class="s2">&quot;PlayerTwo&quot;</span>
    <span class="c1"># logging</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;BuildListProcessBotBase&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">playerString</span><span class="p">)</span>
    <span class="c1"># player</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="p">:</span> <span class="n">Player</span> <span class="o">=</span> <span class="n">player</span>
    <span class="c1"># start locations of both players</span>
    <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_ONE_START_LOCATION</span><span class="p">:</span> <span class="n">StartLocation</span> <span class="o">=</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">UNKNOWN</span>
    <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_TWO_START_LOCATION</span><span class="p">:</span> <span class="n">StartLocation</span> <span class="o">=</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">UNKNOWN</span>
    <span class="c1"># my start location</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startLocation</span><span class="p">:</span> <span class="n">StartLocation</span> <span class="o">=</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">UNKNOWN</span>
    <span class="c1"># communication between bots</span>
    <span class="c1"># will be set when player one has set his start location</span>
    <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_ONE_START_LOCATION_EVENT</span><span class="p">:</span> <span class="n">threading</span><span class="o">.</span><span class="n">Event</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>
    <span class="c1"># will be set when player two has set his start location</span>
    <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_TWO_START_LOCATION_EVENT</span><span class="p">:</span> <span class="n">threading</span><span class="o">.</span><span class="n">Event</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>
    <span class="c1"># expansion locations (different datastructures for computing the expansion locations)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">expansionLocationsComputed</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">bottomExpansions</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">topExpansions</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">leftExpansions</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">rightExpansions</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_ONE_EXPANSION_LOCATIONS</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_TWO_EXPANSION_LOCATIONS</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">expansionLocations</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="c1"># build list</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">buildList</span> <span class="o">=</span> <span class="n">inputBuildList</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span> <span class="o">=</span> <span class="n">UnitTypeId</span><span class="o">.</span><span class="n">NOTAUNIT</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">done</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">remainingBuildTasks</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="c1"># gas building locations</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">occupiedGeysers</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="c1"># attacking</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">attacking</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_ONE_READY_TO_ATTACK</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_TWO_READY_TO_ATTACK</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">attackDone</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_ONE_ARMY_COUNT</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_TWO_ARMY_COUNT</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">WINNER</span><span class="p">:</span> <span class="n">Winner</span> <span class="o">=</span> <span class="n">Winner</span><span class="o">.</span><span class="n">UNKNOWN</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.alert">
    <p>def <span class="ident">alert</span>(</p><p>self, alert_code)</p>
    </div>
    

    
  
    <div class="desc"><p>Check if alert is triggered in the current step.
Possible alerts are listed here https://github.com/Blizzard/s2client-proto/blob/e38efed74c03bec90f74b330ea1adda9215e655f/s2clientprotocol/sc2api.proto#L679-L702</p>
<p>Example use:</p>
<div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">sc2.data</span> <span class="kn">import</span> <span class="n">Alert</span>
<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">alert</span><span class="p">(</span><span class="n">Alert</span><span class="o">.</span><span class="n">AddOnComplete</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Addon Complete&quot;</span><span class="p">)</span>
</pre></div>


<p>Alert codes::</p>
<div class="codehilite"><pre><span></span><span class="err">AlertError</span>
<span class="err">AddOnComplete</span>
<span class="err">BuildingComplete</span>
<span class="err">BuildingUnderAttack</span>
<span class="err">LarvaHatched</span>
<span class="err">MergeComplete</span>
<span class="err">MineralsExhausted</span>
<span class="err">MorphComplete</span>
<span class="err">MothershipComplete</span>
<span class="err">MULEExpired</span>
<span class="err">NuclearLaunchDetected</span>
<span class="err">NukeComplete</span>
<span class="err">NydusWormDetected</span>
<span class="err">ResearchComplete</span>
<span class="err">TrainError</span>
<span class="err">TrainUnitComplete</span>
<span class="err">TrainWorkerComplete</span>
<span class="err">TransformationComplete</span>
<span class="err">UnitUnderAttack</span>
<span class="err">UpgradeComplete</span>
<span class="err">VespeneExhausted</span>
<span class="err">WarpInComplete</span>
</pre></div>


<p>:param alert_code:</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.alert', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.alert" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">alert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alert_code</span><span class="p">:</span> <span class="n">Alert</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check if alert is triggered in the current step.</span>
<span class="sd">    Possible alerts are listed here https://github.com/Blizzard/s2client-proto/blob/e38efed74c03bec90f74b330ea1adda9215e655f/s2clientprotocol/sc2api.proto#L679-L702</span>
<span class="sd">    Example use:</span>
<span class="sd">        from sc2.data import Alert</span>
<span class="sd">        if self.alert(Alert.AddOnComplete):</span>
<span class="sd">            print(&quot;Addon Complete&quot;)</span>
<span class="sd">    Alert codes::</span>
<span class="sd">        AlertError</span>
<span class="sd">        AddOnComplete</span>
<span class="sd">        BuildingComplete</span>
<span class="sd">        BuildingUnderAttack</span>
<span class="sd">        LarvaHatched</span>
<span class="sd">        MergeComplete</span>
<span class="sd">        MineralsExhausted</span>
<span class="sd">        MorphComplete</span>
<span class="sd">        MothershipComplete</span>
<span class="sd">        MULEExpired</span>
<span class="sd">        NuclearLaunchDetected</span>
<span class="sd">        NukeComplete</span>
<span class="sd">        NydusWormDetected</span>
<span class="sd">        ResearchComplete</span>
<span class="sd">        TrainError</span>
<span class="sd">        TrainUnitComplete</span>
<span class="sd">        TrainWorkerComplete</span>
<span class="sd">        TransformationComplete</span>
<span class="sd">        UnitUnderAttack</span>
<span class="sd">        UpgradeComplete</span>
<span class="sd">        VespeneExhausted</span>
<span class="sd">        WarpInComplete</span>
<span class="sd">    :param alert_code:</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">alert_code</span><span class="p">,</span> <span class="n">Alert</span><span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;alert_code </span><span class="si">{</span><span class="n">alert_code</span><span class="si">}</span><span class="s2"> is no Alert&quot;</span>
    <span class="k">return</span> <span class="n">alert_code</span><span class="o">.</span><span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">alerts</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.already_pending">
    <p>def <span class="ident">already_pending</span>(</p><p>self, unit_type)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns a number of buildings or units already in progress, or if a
worker is en route to build it. This also includes queued orders for
workers and build queues of buildings.</p>
<p>Example::</p>
<div class="codehilite"><pre><span></span><span class="n">amount_of_scv_in_production</span><span class="o">:</span> <span class="n">int</span> <span class="o">=</span> <span class="n">self</span><span class="o">.</span><span class="na">already_pending</span><span class="o">(</span><span class="n">UnitTypeId</span><span class="o">.</span><span class="na">SCV</span><span class="o">)</span>
<span class="n">amount_of_CCs_in_queue_and_production</span><span class="o">:</span> <span class="n">int</span> <span class="o">=</span> <span class="n">self</span><span class="o">.</span><span class="na">already_pending</span><span class="o">(</span><span class="n">UnitTypeId</span><span class="o">.</span><span class="na">COMMANDCENTER</span><span class="o">)</span>
<span class="n">amount_of_lairs_morphing</span><span class="o">:</span> <span class="n">int</span> <span class="o">=</span> <span class="n">self</span><span class="o">.</span><span class="na">already_pending</span><span class="o">(</span><span class="n">UnitTypeId</span><span class="o">.</span><span class="na">LAIR</span><span class="o">)</span>
</pre></div>


<p>:param unit_type:</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.already_pending', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.already_pending" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">already_pending</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unit_type</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">UpgradeId</span><span class="p">,</span> <span class="n">UnitTypeId</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a number of buildings or units already in progress, or if a</span>
<span class="sd">    worker is en route to build it. This also includes queued orders for</span>
<span class="sd">    workers and build queues of buildings.</span>
<span class="sd">    Example::</span>
<span class="sd">        amount_of_scv_in_production: int = self.already_pending(UnitTypeId.SCV)</span>
<span class="sd">        amount_of_CCs_in_queue_and_production: int = self.already_pending(UnitTypeId.COMMANDCENTER)</span>
<span class="sd">        amount_of_lairs_morphing: int = self.already_pending(UnitTypeId.LAIR)</span>
<span class="sd">    :param unit_type:</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">unit_type</span><span class="p">,</span> <span class="n">UpgradeId</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">already_pending_upgrade</span><span class="p">(</span><span class="n">unit_type</span><span class="p">)</span>
    <span class="n">ability</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_game_data</span><span class="o">.</span><span class="n">units</span><span class="p">[</span><span class="n">unit_type</span><span class="o">.</span><span class="n">value</span><span class="p">]</span><span class="o">.</span><span class="n">creation_ability</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_abilities_all_units</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">ability</span><span class="p">]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.already_pending_upgrade">
    <p>def <span class="ident">already_pending_upgrade</span>(</p><p>self, upgrade_type)</p>
    </div>
    

    
  
    <div class="desc"><p>Check if an upgrade is being researched</p>
<p>Returns values are::</p>
<div class="codehilite"><pre><span></span><span class="err">0 # not started</span>
<span class="err">0 &lt; x &lt; 1 # researching</span>
<span class="err">1 # completed</span>
</pre></div>


<p>Example::</p>
<div class="codehilite"><pre><span></span><span class="err">stim_completion_percentage = self.already_pending_upgrade(UpgradeId.STIMPACK)</span>
</pre></div>


<p>:param upgrade_type:</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.already_pending_upgrade', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.already_pending_upgrade" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">already_pending_upgrade</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">upgrade_type</span><span class="p">:</span> <span class="n">UpgradeId</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot; Check if an upgrade is being researched</span>
<span class="sd">    Returns values are::</span>
<span class="sd">        0 # not started</span>
<span class="sd">        0 &lt; x &lt; 1 # researching</span>
<span class="sd">        1 # completed</span>
<span class="sd">    Example::</span>
<span class="sd">        stim_completion_percentage = self.already_pending_upgrade(UpgradeId.STIMPACK)</span>
<span class="sd">    :param upgrade_type:</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">upgrade_type</span><span class="p">,</span> <span class="n">UpgradeId</span><span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">upgrade_type</span><span class="si">}</span><span class="s2"> is no UpgradeId&quot;</span>
    <span class="k">if</span> <span class="n">upgrade_type</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">upgrades</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="n">creationAbilityID</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_game_data</span><span class="o">.</span><span class="n">upgrades</span><span class="p">[</span><span class="n">upgrade_type</span><span class="o">.</span><span class="n">value</span><span class="p">]</span><span class="o">.</span><span class="n">research_ability</span><span class="o">.</span><span class="n">exact_id</span>
    <span class="k">for</span> <span class="n">structure</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">structures</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">unit</span><span class="p">:</span> <span class="n">unit</span><span class="o">.</span><span class="n">is_ready</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">order</span> <span class="ow">in</span> <span class="n">structure</span><span class="o">.</span><span class="n">orders</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">order</span><span class="o">.</span><span class="n">ability</span><span class="o">.</span><span class="n">exact_id</span> <span class="o">==</span> <span class="n">creationAbilityID</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">order</span><span class="o">.</span><span class="n">progress</span>
    <span class="k">return</span> <span class="mi">0</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.attackMapCenterWithArmy">
    <p>def <span class="ident">attackMapCenterWithArmy</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Has to be implemented by race specific bot.</p>
<p>Gather bots army and then move to map center with attack move.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.attackMapCenterWithArmy', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.attackMapCenterWithArmy" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">attackMapCenterWithArmy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Has to be implemented by race specific bot.</span>
<span class="sd">    Gather bots army and then move to map center with attack move.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Must be implemented by race specific Bot!&quot;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.build">
    <p>def <span class="ident">build</span>(</p><p>self, building, near, max_distance=20, build_worker=None, random_alternative=True, placement_step=2)</p>
    </div>
    

    
  
    <div class="desc"><p>Not recommended as this function checks many positions if it "can place" on them until it found a valid
position. Also if the given position is not placeable, this function tries to find a nearby position to place
the structure. Then uses 'self.do' to give the worker the order to start the construction.</p>
<p>:param building:
:param near:
:param max_distance:
:param build_worker:
:param random_alternative:
:param placement_step:</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.build', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.build" class="source">
    <div class="codehilite"><pre><span></span><span class="k">async</span> <span class="k">def</span> <span class="nf">build</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">building</span><span class="p">:</span> <span class="n">UnitTypeId</span><span class="p">,</span>
    <span class="n">near</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Unit</span><span class="p">,</span> <span class="n">Point2</span><span class="p">],</span>
    <span class="n">max_distance</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
    <span class="n">build_worker</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Unit</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">random_alternative</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">placement_step</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot; Not recommended as this function checks many positions if it &quot;can place&quot; on them until it found a valid</span>
<span class="sd">    position. Also if the given position is not placeable, this function tries to find a nearby position to place</span>
<span class="sd">    the structure. Then uses &#39;self.do&#39; to give the worker the order to start the construction.</span>
<span class="sd">    :param building:</span>
<span class="sd">    :param near:</span>
<span class="sd">    :param max_distance:</span>
<span class="sd">    :param build_worker:</span>
<span class="sd">    :param random_alternative:</span>
<span class="sd">    :param placement_step: &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">near</span><span class="p">,</span> <span class="p">(</span><span class="n">Unit</span><span class="p">,</span> <span class="n">Point2</span><span class="p">))</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">can_afford</span><span class="p">(</span><span class="n">building</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="n">p</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">gas_buildings</span> <span class="o">=</span> <span class="p">{</span><span class="n">UnitTypeId</span><span class="o">.</span><span class="n">EXTRACTOR</span><span class="p">,</span> <span class="n">UnitTypeId</span><span class="o">.</span><span class="n">ASSIMILATOR</span><span class="p">,</span> <span class="n">UnitTypeId</span><span class="o">.</span><span class="n">REFINERY</span><span class="p">}</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">near</span><span class="p">,</span> <span class="n">Unit</span><span class="p">)</span> <span class="ow">and</span> <span class="n">building</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">gas_buildings</span><span class="p">:</span>
        <span class="n">near</span> <span class="o">=</span> <span class="n">near</span><span class="o">.</span><span class="n">position</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">near</span><span class="p">,</span> <span class="n">Point2</span><span class="p">):</span>
        <span class="n">near</span> <span class="o">=</span> <span class="n">near</span><span class="o">.</span><span class="n">to2</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">near</span><span class="p">,</span> <span class="n">Point2</span><span class="p">):</span>
        <span class="n">p</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_placement</span><span class="p">(</span><span class="n">building</span><span class="p">,</span> <span class="n">near</span><span class="p">,</span> <span class="n">max_distance</span><span class="p">,</span> <span class="n">random_alternative</span><span class="p">,</span> <span class="n">placement_step</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">p</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
    <span class="n">builder</span> <span class="o">=</span> <span class="n">build_worker</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">select_build_worker</span><span class="p">(</span><span class="n">near</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">builder</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="n">building</span> <span class="ow">in</span> <span class="n">gas_buildings</span><span class="p">:</span>
        <span class="n">builder</span><span class="o">.</span><span class="n">build_gas</span><span class="p">(</span><span class="n">near</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">do</span><span class="p">(</span><span class="n">builder</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">building</span><span class="p">,</span> <span class="n">p</span><span class="p">),</span> <span class="n">subtract_cost</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ignore_warning</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">True</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.buildBase">
    <p>def <span class="ident">buildBase</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Build base.</p>
<p>Uses the pre computed expansion locations. Only works for simple map.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.buildBase', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.buildBase" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">buildBase</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Build base.</span>
<span class="sd">    </span>
<span class="sd">    Uses the pre computed expansion locations. Only works for simple map.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">expansionLocations</span><span class="p">):</span>
        <span class="n">location</span><span class="p">:</span> <span class="n">Point2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">expansionLocations</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">worker</span><span class="p">:</span> <span class="n">Unit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">workers</span><span class="o">.</span><span class="n">gathering</span><span class="o">.</span><span class="n">closest_to</span><span class="p">(</span><span class="n">location</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">can_place</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span><span class="p">,</span> <span class="n">location</span><span class="p">):</span>
            <span class="n">worker</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span><span class="p">,</span> <span class="n">location</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;could not build the command center where it was supposed to be built!&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;No more places to build command expansions!&quot;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.buildGasBuilding">
    <p>def <span class="ident">buildGasBuilding</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Build a gas building by selecting a townhall.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.buildGasBuilding', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.buildGasBuilding" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">buildGasBuilding</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Build a gas building by selecting a townhall.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># cant build more gas buildings than townhalls</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gas_buildings</span><span class="o">.</span><span class="n">ready</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">already_pending</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">townhalls</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span><span class="p">:</span>
        
        <span class="c1"># prefer townhalls that are ready</span>
        <span class="k">for</span> <span class="n">townhall</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">townhalls</span><span class="o">.</span><span class="n">ready</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">buildGasBuildingAtTownhall</span><span class="p">(</span><span class="n">townhall</span><span class="p">)</span>
        <span class="c1"># townhalls that are not ready</span>
        <span class="k">for</span> <span class="n">townhall</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">townhalls</span><span class="o">.</span><span class="n">not_ready</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">buildGasBuildingAtTownhall</span><span class="p">(</span><span class="n">townhall</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.buildGasBuildingAtTownhall">
    <p>def <span class="ident">buildGasBuildingAtTownhall</span>(</p><p>self, townhall)</p>
    </div>
    

    
  
    <div class="desc"><p>Build gas building at a certain townhall.</p>
<p>Needs storage for occupied geysers as library function can_place does not
work in that case.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.buildGasBuildingAtTownhall', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.buildGasBuildingAtTownhall" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">buildGasBuildingAtTownhall</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">townhall</span><span class="p">:</span> <span class="n">Unit</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Build gas building at a certain townhall.</span>
<span class="sd">    </span>
<span class="sd">    Needs storage for occupied geysers as library function can_place does not</span>
<span class="sd">    work in that case.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># all vespene geysers closer than distance ten to the current townhall</span>
    <span class="n">vespeneGeysers</span><span class="p">:</span> <span class="n">Units</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vespene_geyser</span><span class="o">.</span><span class="n">closer_than</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">townhall</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Found &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">vespeneGeysers</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot; vespene geyser locations!&quot;</span><span class="p">)</span>
    <span class="c1"># check all locations</span>
    <span class="c1">#  apparently can_place does not work in this situation. it will say that a second refinery can be placed on the occupied geyser</span>
    <span class="k">for</span> <span class="n">vespeneGeyser</span> <span class="ow">in</span> <span class="n">vespeneGeysers</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">vespeneGeyser</span><span class="o">.</span><span class="n">position</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">occupiedGeysers</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">can_place</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span><span class="p">,</span> <span class="p">(</span><span class="n">vespeneGeyser</span><span class="o">.</span><span class="n">position</span><span class="p">)):</span>
                <span class="n">worker</span><span class="p">:</span> <span class="n">Unit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getWorker</span><span class="p">(</span><span class="n">vespeneGeyser</span><span class="p">)</span>
                <span class="n">worker</span><span class="o">.</span><span class="n">build_gas</span><span class="p">(</span><span class="n">vespeneGeyser</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">occupiedGeysers</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">vespeneGeyser</span><span class="o">.</span><span class="n">position</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Can place stated not possible to place even though according to self.occupiedGeysers it should be free!&quot;</span><span class="p">)</span>
    
    <span class="c1"># if we reach this we have not found a building location</span>
    <span class="k">return</span> <span class="kc">False</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.calculate_cost">
    <p>def <span class="ident">calculate_cost</span>(</p><p>self, item_id)</p>
    </div>
    

    
  
    <div class="desc"><p>Calculate the required build, train or morph cost of a unit. It is recommended to use the UnitTypeId instead of the ability to create the unit.
The total cost to create a ravager is 100/100, but the actual morph cost from roach to ravager is only 25/75, so this function returns 25/75.</p>
<p>It is adviced to use the UnitTypeId instead of the AbilityId. Instead of::</p>
<div class="codehilite"><pre><span></span><span class="err">self.calculate_cost(AbilityId.UPGRADETOORBITAL_ORBITALCOMMAND)</span>
</pre></div>


<p>use::</p>
<div class="codehilite"><pre><span></span><span class="err">self.calculate_cost(UnitTypeId.ORBITALCOMMAND)</span>
</pre></div>


<p>More examples::</p>
<div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">sc2.game_data</span> <span class="kn">import</span> <span class="n">Cost</span>

<span class="bp">self</span><span class="o">.</span><span class="n">calculate_cost</span><span class="p">(</span><span class="n">UnitTypeId</span><span class="o">.</span><span class="n">BROODLORD</span><span class="p">)</span> <span class="o">==</span> <span class="n">Cost</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span>
<span class="bp">self</span><span class="o">.</span><span class="n">calculate_cost</span><span class="p">(</span><span class="n">UnitTypeId</span><span class="o">.</span><span class="n">RAVAGER</span><span class="p">)</span> <span class="o">==</span> <span class="n">Cost</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">75</span><span class="p">)</span>
<span class="bp">self</span><span class="o">.</span><span class="n">calculate_cost</span><span class="p">(</span><span class="n">UnitTypeId</span><span class="o">.</span><span class="n">BANELING</span><span class="p">)</span> <span class="o">==</span> <span class="n">Cost</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
<span class="bp">self</span><span class="o">.</span><span class="n">calculate_cost</span><span class="p">(</span><span class="n">UnitTypeId</span><span class="o">.</span><span class="n">ORBITALCOMMAND</span><span class="p">)</span> <span class="o">==</span> <span class="n">Cost</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="bp">self</span><span class="o">.</span><span class="n">calculate_cost</span><span class="p">(</span><span class="n">UnitTypeId</span><span class="o">.</span><span class="n">REACTOR</span><span class="p">)</span> <span class="o">==</span> <span class="n">Cost</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="bp">self</span><span class="o">.</span><span class="n">calculate_cost</span><span class="p">(</span><span class="n">UnitTypeId</span><span class="o">.</span><span class="n">TECHLAB</span><span class="p">)</span> <span class="o">==</span> <span class="n">Cost</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
<span class="bp">self</span><span class="o">.</span><span class="n">calculate_cost</span><span class="p">(</span><span class="n">UnitTypeId</span><span class="o">.</span><span class="n">QUEEN</span><span class="p">)</span> <span class="o">==</span> <span class="n">Cost</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="bp">self</span><span class="o">.</span><span class="n">calculate_cost</span><span class="p">(</span><span class="n">UnitTypeId</span><span class="o">.</span><span class="n">HATCHERY</span><span class="p">)</span> <span class="o">==</span> <span class="n">Cost</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="bp">self</span><span class="o">.</span><span class="n">calculate_cost</span><span class="p">(</span><span class="n">UnitTypeId</span><span class="o">.</span><span class="n">LAIR</span><span class="p">)</span> <span class="o">==</span> <span class="n">Cost</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="bp">self</span><span class="o">.</span><span class="n">calculate_cost</span><span class="p">(</span><span class="n">UnitTypeId</span><span class="o">.</span><span class="n">HIVE</span><span class="p">)</span> <span class="o">==</span> <span class="n">Cost</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span>
</pre></div>


<p>:param item_id:</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.calculate_cost', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.calculate_cost" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">calculate_cost</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item_id</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">UnitTypeId</span><span class="p">,</span> <span class="n">UpgradeId</span><span class="p">,</span> <span class="n">AbilityId</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Cost</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the required build, train or morph cost of a unit. It is recommended to use the UnitTypeId instead of the ability to create the unit.</span>
<span class="sd">    The total cost to create a ravager is 100/100, but the actual morph cost from roach to ravager is only 25/75, so this function returns 25/75.</span>
<span class="sd">    It is adviced to use the UnitTypeId instead of the AbilityId. Instead of::</span>
<span class="sd">        self.calculate_cost(AbilityId.UPGRADETOORBITAL_ORBITALCOMMAND)</span>
<span class="sd">    use::</span>
<span class="sd">        self.calculate_cost(UnitTypeId.ORBITALCOMMAND)</span>
<span class="sd">    More examples::</span>
<span class="sd">        from sc2.game_data import Cost</span>
<span class="sd">        self.calculate_cost(UnitTypeId.BROODLORD) == Cost(150, 150)</span>
<span class="sd">        self.calculate_cost(UnitTypeId.RAVAGER) == Cost(25, 75)</span>
<span class="sd">        self.calculate_cost(UnitTypeId.BANELING) == Cost(25, 25)</span>
<span class="sd">        self.calculate_cost(UnitTypeId.ORBITALCOMMAND) == Cost(150, 0)</span>
<span class="sd">        self.calculate_cost(UnitTypeId.REACTOR) == Cost(50, 50)</span>
<span class="sd">        self.calculate_cost(UnitTypeId.TECHLAB) == Cost(50, 25)</span>
<span class="sd">        self.calculate_cost(UnitTypeId.QUEEN) == Cost(150, 0)</span>
<span class="sd">        self.calculate_cost(UnitTypeId.HATCHERY) == Cost(300, 0)</span>
<span class="sd">        self.calculate_cost(UnitTypeId.LAIR) == Cost(150, 100)</span>
<span class="sd">        self.calculate_cost(UnitTypeId.HIVE) == Cost(200, 150)</span>
<span class="sd">    :param item_id:</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item_id</span><span class="p">,</span> <span class="n">UnitTypeId</span><span class="p">):</span>
        <span class="c1"># Fix cost for reactor and techlab where the API returns 0 for both</span>
        <span class="k">if</span> <span class="n">item_id</span> <span class="ow">in</span> <span class="p">{</span><span class="n">UnitTypeId</span><span class="o">.</span><span class="n">REACTOR</span><span class="p">,</span> <span class="n">UnitTypeId</span><span class="o">.</span><span class="n">TECHLAB</span><span class="p">,</span> <span class="n">UnitTypeId</span><span class="o">.</span><span class="n">ARCHON</span><span class="p">}:</span>
            <span class="k">if</span> <span class="n">item_id</span> <span class="o">==</span> <span class="n">UnitTypeId</span><span class="o">.</span><span class="n">REACTOR</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">Cost</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">item_id</span> <span class="o">==</span> <span class="n">UnitTypeId</span><span class="o">.</span><span class="n">TECHLAB</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">Cost</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">item_id</span> <span class="o">==</span> <span class="n">UnitTypeId</span><span class="o">.</span><span class="n">ARCHON</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_unit_value</span><span class="p">(</span><span class="n">UnitTypeId</span><span class="o">.</span><span class="n">ARCHON</span><span class="p">)</span>
        <span class="n">unit_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_game_data</span><span class="o">.</span><span class="n">units</span><span class="p">[</span><span class="n">item_id</span><span class="o">.</span><span class="n">value</span><span class="p">]</span>
        <span class="c1"># Cost of structure morphs is automatically correctly calculated by &#39;calculate_ability_cost&#39;</span>
        <span class="n">cost</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_game_data</span><span class="o">.</span><span class="n">calculate_ability_cost</span><span class="p">(</span><span class="n">unit_data</span><span class="o">.</span><span class="n">creation_ability</span><span class="p">)</span>
        <span class="c1"># Fix non-structure morph cost: check if is morph, then subtract the original cost</span>
        <span class="n">unit_supply_cost</span> <span class="o">=</span> <span class="n">unit_data</span><span class="o">.</span><span class="n">_proto</span><span class="o">.</span><span class="n">food_required</span>
        <span class="k">if</span> <span class="n">unit_supply_cost</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">item_id</span> <span class="ow">in</span> <span class="n">UNIT_TRAINED_FROM</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">UNIT_TRAINED_FROM</span><span class="p">[</span><span class="n">item_id</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">producer</span> <span class="ow">in</span> <span class="n">UNIT_TRAINED_FROM</span><span class="p">[</span><span class="n">item_id</span><span class="p">]:</span>  <span class="c1"># type: UnitTypeId</span>
                <span class="n">producer_unit_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game_data</span><span class="o">.</span><span class="n">units</span><span class="p">[</span><span class="n">producer</span><span class="o">.</span><span class="n">value</span><span class="p">]</span>
                <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">producer_unit_data</span><span class="o">.</span><span class="n">_proto</span><span class="o">.</span><span class="n">food_required</span> <span class="o">&lt;=</span> <span class="n">unit_supply_cost</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">producer</span> <span class="o">==</span> <span class="n">UnitTypeId</span><span class="o">.</span><span class="n">ZERGLING</span><span class="p">:</span>
                        <span class="n">producer_cost</span> <span class="o">=</span> <span class="n">Cost</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">producer_cost</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game_data</span><span class="o">.</span><span class="n">calculate_ability_cost</span><span class="p">(</span><span class="n">producer_unit_data</span><span class="o">.</span><span class="n">creation_ability</span><span class="p">)</span>
                    <span class="n">cost</span> <span class="o">=</span> <span class="n">cost</span> <span class="o">-</span> <span class="n">producer_cost</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item_id</span><span class="p">,</span> <span class="n">UpgradeId</span><span class="p">):</span>
        <span class="n">cost</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_game_data</span><span class="o">.</span><span class="n">upgrades</span><span class="p">[</span><span class="n">item_id</span><span class="o">.</span><span class="n">value</span><span class="p">]</span><span class="o">.</span><span class="n">cost</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Is already AbilityId</span>
        <span class="n">cost</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_game_data</span><span class="o">.</span><span class="n">calculate_ability_cost</span><span class="p">(</span><span class="n">item_id</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cost</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.calculate_supply_cost">
    <p>def <span class="ident">calculate_supply_cost</span>(</p><p>self, unit_type)</p>
    </div>
    

    
  
    <div class="desc"><p>This function calculates the required supply to train or morph a unit.
The total supply of a baneling is 0.5, but a zergling already uses up 0.5 supply, so the morph supply cost is 0.
The total supply of a ravager is 3, but a roach already uses up 2 supply, so the morph supply cost is 1.
The required supply to build zerglings is 1 because they pop in pairs, so this function returns 1 because the larva morph command requires 1 free supply.</p>
<p>Example::</p>
<div class="codehilite"><pre><span></span><span class="err">roach_supply_cost = self.calculate_supply_cost(UnitTypeId.ROACH) # Is 2</span>
<span class="err">ravager_supply_cost = self.calculate_supply_cost(UnitTypeId.RAVAGER) # Is 1</span>
<span class="err">baneling_supply_cost = self.calculate_supply_cost(UnitTypeId.BANELING) # Is 0</span>
</pre></div>


<p>:param unit_type:</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.calculate_supply_cost', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.calculate_supply_cost" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">calculate_supply_cost</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unit_type</span><span class="p">:</span> <span class="n">UnitTypeId</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function calculates the required supply to train or morph a unit.</span>
<span class="sd">    The total supply of a baneling is 0.5, but a zergling already uses up 0.5 supply, so the morph supply cost is 0.</span>
<span class="sd">    The total supply of a ravager is 3, but a roach already uses up 2 supply, so the morph supply cost is 1.</span>
<span class="sd">    The required supply to build zerglings is 1 because they pop in pairs, so this function returns 1 because the larva morph command requires 1 free supply.</span>
<span class="sd">    Example::</span>
<span class="sd">        roach_supply_cost = self.calculate_supply_cost(UnitTypeId.ROACH) # Is 2</span>
<span class="sd">        ravager_supply_cost = self.calculate_supply_cost(UnitTypeId.RAVAGER) # Is 1</span>
<span class="sd">        baneling_supply_cost = self.calculate_supply_cost(UnitTypeId.BANELING) # Is 0</span>
<span class="sd">    :param unit_type: &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">unit_type</span> <span class="ow">in</span> <span class="p">{</span><span class="n">UnitTypeId</span><span class="o">.</span><span class="n">ZERGLING</span><span class="p">}:</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="n">unit_supply_cost</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_game_data</span><span class="o">.</span><span class="n">units</span><span class="p">[</span><span class="n">unit_type</span><span class="o">.</span><span class="n">value</span><span class="p">]</span><span class="o">.</span><span class="n">_proto</span><span class="o">.</span><span class="n">food_required</span>
    <span class="k">if</span> <span class="n">unit_supply_cost</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">unit_type</span> <span class="ow">in</span> <span class="n">UNIT_TRAINED_FROM</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">UNIT_TRAINED_FROM</span><span class="p">[</span><span class="n">unit_type</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">producer</span> <span class="ow">in</span> <span class="n">UNIT_TRAINED_FROM</span><span class="p">[</span><span class="n">unit_type</span><span class="p">]:</span>  <span class="c1"># type: UnitTypeId</span>
            <span class="n">producer_unit_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game_data</span><span class="o">.</span><span class="n">units</span><span class="p">[</span><span class="n">producer</span><span class="o">.</span><span class="n">value</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">producer_unit_data</span><span class="o">.</span><span class="n">_proto</span><span class="o">.</span><span class="n">food_required</span> <span class="o">&lt;=</span> <span class="n">unit_supply_cost</span><span class="p">:</span>
                <span class="n">producer_supply_cost</span> <span class="o">=</span> <span class="n">producer_unit_data</span><span class="o">.</span><span class="n">_proto</span><span class="o">.</span><span class="n">food_required</span>
                <span class="n">unit_supply_cost</span> <span class="o">-=</span> <span class="n">producer_supply_cost</span>
    <span class="k">return</span> <span class="n">unit_supply_cost</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.calculate_unit_value">
    <p>def <span class="ident">calculate_unit_value</span>(</p><p>self, unit_type)</p>
    </div>
    

    
  
    <div class="desc"><p>Unlike the function below, this function returns the value of a unit given by the API (e.g. the resources lost value on kill).</p>
<p>Examples::</p>
<div class="codehilite"><pre><span></span><span class="err">self.calculate_value(UnitTypeId.ORBITALCOMMAND) == Cost(550, 0)</span>
<span class="err">self.calculate_value(UnitTypeId.RAVAGER) == Cost(100, 100)</span>
<span class="err">self.calculate_value(UnitTypeId.ARCHON) == Cost(175, 275)</span>
</pre></div>


<p>:param unit_type:</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.calculate_unit_value', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.calculate_unit_value" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">calculate_unit_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unit_type</span><span class="p">:</span> <span class="n">UnitTypeId</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Cost</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Unlike the function below, this function returns the value of a unit given by the API (e.g. the resources lost value on kill).</span>
<span class="sd">    Examples::</span>
<span class="sd">        self.calculate_value(UnitTypeId.ORBITALCOMMAND) == Cost(550, 0)</span>
<span class="sd">        self.calculate_value(UnitTypeId.RAVAGER) == Cost(100, 100)</span>
<span class="sd">        self.calculate_value(UnitTypeId.ARCHON) == Cost(175, 275)</span>
<span class="sd">    :param unit_type:</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">unit_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game_data</span><span class="o">.</span><span class="n">units</span><span class="p">[</span><span class="n">unit_type</span><span class="o">.</span><span class="n">value</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">Cost</span><span class="p">(</span><span class="n">unit_data</span><span class="o">.</span><span class="n">_proto</span><span class="o">.</span><span class="n">mineral_cost</span><span class="p">,</span> <span class="n">unit_data</span><span class="o">.</span><span class="n">_proto</span><span class="o">.</span><span class="n">vespene_cost</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.can_afford">
    <p>def <span class="ident">can_afford</span>(</p><p>self, item_id, check_supply_cost=True)</p>
    </div>
    

    
  
    <div class="desc"><p>Tests if the player has enough resources to build a unit or structure.</p>
<p>Example::</p>
<div class="codehilite"><pre><span></span><span class="err">cc = self.townhalls.idle.random_or(None)</span>
<span class="err"># self.townhalls can be empty or there are no idle townhalls</span>
<span class="err">if cc and self.can_afford(UnitTypeId.SCV):</span>
<span class="err">    cc.train(UnitTypeId.SCV)</span>
</pre></div>


<p>Example::</p>
<div class="codehilite"><pre><span></span><span class="err"># Current state: we have 150 minerals and one command center and a barracks</span>
<span class="err">can_afford_morph = self.can_afford(UnitTypeId.ORBITALCOMMAND, check_supply_cost=False)</span>
<span class="err"># Will be &#39;True&#39; although the API reports that an orbital is worth 550 minerals, but the morph cost is only 150 minerals</span>
</pre></div>


<p>:param item_id:
:param check_supply_cost:</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.can_afford', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.can_afford" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">can_afford</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item_id</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">UnitTypeId</span><span class="p">,</span> <span class="n">UpgradeId</span><span class="p">,</span> <span class="n">AbilityId</span><span class="p">],</span> <span class="n">check_supply_cost</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot; Tests if the player has enough resources to build a unit or structure.</span>
<span class="sd">    Example::</span>
<span class="sd">        cc = self.townhalls.idle.random_or(None)</span>
<span class="sd">        # self.townhalls can be empty or there are no idle townhalls</span>
<span class="sd">        if cc and self.can_afford(UnitTypeId.SCV):</span>
<span class="sd">            cc.train(UnitTypeId.SCV)</span>
<span class="sd">    Example::</span>
<span class="sd">        # Current state: we have 150 minerals and one command center and a barracks</span>
<span class="sd">        can_afford_morph = self.can_afford(UnitTypeId.ORBITALCOMMAND, check_supply_cost=False)</span>
<span class="sd">        # Will be &#39;True&#39; although the API reports that an orbital is worth 550 minerals, but the morph cost is only 150 minerals</span>
<span class="sd">    :param item_id:</span>
<span class="sd">    :param check_supply_cost: &quot;&quot;&quot;</span>
    <span class="n">cost</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_cost</span><span class="p">(</span><span class="n">item_id</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">cost</span><span class="o">.</span><span class="n">minerals</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">minerals</span> <span class="ow">or</span> <span class="n">cost</span><span class="o">.</span><span class="n">vespene</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">vespene</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="n">check_supply_cost</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item_id</span><span class="p">,</span> <span class="n">UnitTypeId</span><span class="p">):</span>
        <span class="n">supply_cost</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_supply_cost</span><span class="p">(</span><span class="n">item_id</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">supply_cost</span> <span class="ow">and</span> <span class="n">supply_cost</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">supply_left</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="kc">True</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.can_cast">
    <p>def <span class="ident">can_cast</span>(</p><p>self, unit, ability_id, target=None, only_check_energy_and_cooldown=False, cached_abilities_of_unit=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Tests if a unit has an ability available and enough energy to cast it.</p>
<p>Example::</p>
<div class="codehilite"><pre><span></span><span class="err">stalkers = self.units(UnitTypeId.STALKER)</span>
<span class="err">stalkers_that_can_blink = stalkers.filter(lambda unit: unit.type_id == UnitTypeId.STALKER and (await self.can_cast(unit, AbilityId.EFFECT_BLINK_STALKER, only_check_energy_and_cooldown=True)))</span>
</pre></div>


<p>See data_pb2.py (line 161) for the numbers 1-5 to make sense</p>
<p>:param unit:
:param ability_id:
:param target:
:param only_check_energy_and_cooldown:
:param cached_abilities_of_unit:</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.can_cast', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.can_cast" class="source">
    <div class="codehilite"><pre><span></span><span class="k">async</span> <span class="k">def</span> <span class="nf">can_cast</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">unit</span><span class="p">:</span> <span class="n">Unit</span><span class="p">,</span>
    <span class="n">ability_id</span><span class="p">:</span> <span class="n">AbilityId</span><span class="p">,</span>
    <span class="n">target</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Unit</span><span class="p">,</span> <span class="n">Point2</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">only_check_energy_and_cooldown</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">cached_abilities_of_unit</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">AbilityId</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot; Tests if a unit has an ability available and enough energy to cast it.</span>
<span class="sd">    Example::</span>
<span class="sd">        stalkers = self.units(UnitTypeId.STALKER)</span>
<span class="sd">        stalkers_that_can_blink = stalkers.filter(lambda unit: unit.type_id == UnitTypeId.STALKER and (await self.can_cast(unit, AbilityId.EFFECT_BLINK_STALKER, only_check_energy_and_cooldown=True)))</span>
<span class="sd">    See data_pb2.py (line 161) for the numbers 1-5 to make sense</span>
<span class="sd">    :param unit:</span>
<span class="sd">    :param ability_id:</span>
<span class="sd">    :param target:</span>
<span class="sd">    :param only_check_energy_and_cooldown:</span>
<span class="sd">    :param cached_abilities_of_unit: &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="n">Unit</span><span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">unit</span><span class="si">}</span><span class="s2"> is no Unit object&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ability_id</span><span class="p">,</span> <span class="n">AbilityId</span><span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ability_id</span><span class="si">}</span><span class="s2"> is no AbilityId&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span> <span class="n">Unit</span><span class="p">,</span> <span class="n">Point2</span><span class="p">))</span>
    <span class="c1"># check if unit has enough energy to cast or if ability is on cooldown</span>
    <span class="k">if</span> <span class="n">cached_abilities_of_unit</span><span class="p">:</span>
        <span class="n">abilities</span> <span class="o">=</span> <span class="n">cached_abilities_of_unit</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">abilities</span> <span class="o">=</span> <span class="p">(</span><span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_available_abilities</span><span class="p">([</span><span class="n">unit</span><span class="p">],</span> <span class="n">ignore_resource_requirements</span><span class="o">=</span><span class="kc">False</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">ability_id</span> <span class="ow">in</span> <span class="n">abilities</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">only_check_energy_and_cooldown</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="n">cast_range</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_game_data</span><span class="o">.</span><span class="n">abilities</span><span class="p">[</span><span class="n">ability_id</span><span class="o">.</span><span class="n">value</span><span class="p">]</span><span class="o">.</span><span class="n">_proto</span><span class="o">.</span><span class="n">cast_range</span>
        <span class="n">ability_target</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_game_data</span><span class="o">.</span><span class="n">abilities</span><span class="p">[</span><span class="n">ability_id</span><span class="o">.</span><span class="n">value</span><span class="p">]</span><span class="o">.</span><span class="n">_proto</span><span class="o">.</span><span class="n">target</span>
        <span class="c1"># Check if target is in range (or is a self cast like stimpack)</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">ability_target</span> <span class="o">==</span> <span class="mi">1</span>
            <span class="ow">or</span> <span class="n">ability_target</span> <span class="o">==</span> <span class="n">Target</span><span class="o">.</span><span class="n">PointOrNone</span><span class="o">.</span><span class="n">value</span>
            <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">Point2</span><span class="p">)</span>
            <span class="ow">and</span> <span class="n">unit</span><span class="o">.</span><span class="n">distance_to</span><span class="p">(</span><span class="n">target</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">unit</span><span class="o">.</span><span class="n">radius</span> <span class="o">+</span> <span class="n">target</span><span class="o">.</span><span class="n">radius</span> <span class="o">+</span> <span class="n">cast_range</span>
        <span class="p">):</span>  <span class="c1"># cant replace 1 with &quot;Target.None.value&quot; because &quot;.None&quot; doesnt seem to be a valid enum name</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="c1"># Check if able to use ability on a unit</span>
        <span class="k">elif</span> <span class="p">(</span>
            <span class="n">ability_target</span> <span class="ow">in</span> <span class="p">{</span><span class="n">Target</span><span class="o">.</span><span class="n">Unit</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">Target</span><span class="o">.</span><span class="n">PointOrUnit</span><span class="o">.</span><span class="n">value</span><span class="p">}</span>
            <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">Unit</span><span class="p">)</span>
            <span class="ow">and</span> <span class="n">unit</span><span class="o">.</span><span class="n">distance_to</span><span class="p">(</span><span class="n">target</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">unit</span><span class="o">.</span><span class="n">radius</span> <span class="o">+</span> <span class="n">target</span><span class="o">.</span><span class="n">radius</span> <span class="o">+</span> <span class="n">cast_range</span>
        <span class="p">):</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="c1"># Check if able to use ability on a position</span>
        <span class="k">elif</span> <span class="p">(</span>
            <span class="n">ability_target</span> <span class="ow">in</span> <span class="p">{</span><span class="n">Target</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">Target</span><span class="o">.</span><span class="n">PointOrUnit</span><span class="o">.</span><span class="n">value</span><span class="p">}</span>
            <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">Point2</span><span class="p">)</span>
            <span class="ow">and</span> <span class="n">unit</span><span class="o">.</span><span class="n">distance_to</span><span class="p">(</span><span class="n">target</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">unit</span><span class="o">.</span><span class="n">radius</span> <span class="o">+</span> <span class="n">cast_range</span>
        <span class="p">):</span>
            <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="kc">False</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.can_feed">
    <p>def <span class="ident">can_feed</span>(</p><p>self, unit_type)</p>
    </div>
    

    
  
    <div class="desc"><p>Checks if you have enough free supply to build the unit</p>
<p>Example::</p>
<div class="codehilite"><pre><span></span><span class="err">cc = self.townhalls.idle.random_or(None)</span>
<span class="err"># self.townhalls can be empty or there are no idle townhalls</span>
<span class="err">if cc and self.can_feed(UnitTypeId.SCV):</span>
<span class="err">    cc.train(UnitTypeId.SCV)</span>
</pre></div>


<p>:param unit_type:</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.can_feed', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.can_feed" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">can_feed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unit_type</span><span class="p">:</span> <span class="n">UnitTypeId</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot; Checks if you have enough free supply to build the unit</span>
<span class="sd">    Example::</span>
<span class="sd">        cc = self.townhalls.idle.random_or(None)</span>
<span class="sd">        # self.townhalls can be empty or there are no idle townhalls</span>
<span class="sd">        if cc and self.can_feed(UnitTypeId.SCV):</span>
<span class="sd">            cc.train(UnitTypeId.SCV)</span>
<span class="sd">    :param unit_type: &quot;&quot;&quot;</span>
    <span class="n">required</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_supply_cost</span><span class="p">(</span><span class="n">unit_type</span><span class="p">)</span>
    <span class="c1"># &quot;required &lt;= 0&quot; in case self.supply_left is negative</span>
    <span class="k">return</span> <span class="n">required</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">supply_left</span> <span class="o">&gt;=</span> <span class="n">required</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.can_place">
    <p>def <span class="ident">can_place</span>(</p><p>self, building, positions)</p>
    </div>
    

    
  
    <div class="desc"><p>Tests if a building can be placed in the given locations.</p>
<p>Example::</p>
<div class="codehilite"><pre><span></span><span class="n">barracks_placement_position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">main_base_ramp</span><span class="p">.</span><span class="n">barracks_correct_placement</span><span class="w"></span>
<span class="n">worker</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">select_build_worker</span><span class="p">(</span><span class="n">barracks_placement_position</span><span class="p">)</span><span class="w"></span>
<span class="err">#</span><span class="w"> </span><span class="n">Can</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="k">None</span><span class="w"></span>
<span class="k">if</span><span class="w"> </span><span class="n">worker</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="p">(</span><span class="n">await</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">can_place</span><span class="p">(</span><span class="n">UnitTypeId</span><span class="p">.</span><span class="n">BARRACKS</span><span class="p">,</span><span class="w"> </span><span class="o">[</span><span class="n">barracks_placement_position</span><span class="o">]</span><span class="p">)</span><span class="o">[</span><span class="n">0</span><span class="o">]</span><span class="err">:</span><span class="w"></span>
<span class="w">    </span><span class="n">worker</span><span class="p">.</span><span class="n">build</span><span class="p">(</span><span class="n">UnitTypeId</span><span class="p">.</span><span class="n">BARRACKS</span><span class="p">,</span><span class="w"> </span><span class="n">barracks_placement_position</span><span class="p">)</span><span class="w"></span>
</pre></div>


<p>:param building:
:param position:</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.can_place', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.can_place" class="source">
    <div class="codehilite"><pre><span></span><span class="k">async</span> <span class="k">def</span> <span class="nf">can_place</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">building</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">AbilityData</span><span class="p">,</span> <span class="n">AbilityId</span><span class="p">,</span> <span class="n">UnitTypeId</span><span class="p">],</span> <span class="n">positions</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Point2</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">]]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">bool</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot; Tests if a building can be placed in the given locations.</span>
<span class="sd">    Example::</span>
<span class="sd">        barracks_placement_position = self.main_base_ramp.barracks_correct_placement</span>
<span class="sd">        worker = self.select_build_worker(barracks_placement_position)</span>
<span class="sd">        # Can return None</span>
<span class="sd">        if worker and (await self.can_place(UnitTypeId.BARRACKS, [barracks_placement_position])[0]:</span>
<span class="sd">            worker.build(UnitTypeId.BARRACKS, barracks_placement_position)</span>
<span class="sd">    :param building:</span>
<span class="sd">    :param position: &quot;&quot;&quot;</span>
    <span class="n">building_type</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">building</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">type</span><span class="p">(</span><span class="n">building</span><span class="p">)</span> <span class="ow">in</span> <span class="p">{</span><span class="n">AbilityData</span><span class="p">,</span> <span class="n">AbilityId</span><span class="p">,</span> <span class="n">UnitTypeId</span><span class="p">},</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">building</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">building_type</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">if</span> <span class="n">building_type</span> <span class="o">==</span> <span class="n">UnitTypeId</span><span class="p">:</span>
        <span class="n">building</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_game_data</span><span class="o">.</span><span class="n">units</span><span class="p">[</span><span class="n">building</span><span class="o">.</span><span class="n">value</span><span class="p">]</span><span class="o">.</span><span class="n">creation_ability</span>
    <span class="k">elif</span> <span class="n">building_type</span> <span class="o">==</span> <span class="n">AbilityId</span><span class="p">:</span>
        <span class="n">building</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_game_data</span><span class="o">.</span><span class="n">abilities</span><span class="p">[</span><span class="n">building</span><span class="o">.</span><span class="n">value</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">positions</span><span class="p">,</span> <span class="p">(</span><span class="n">Point2</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">can_place_single</span><span class="p">(</span><span class="n">building</span><span class="p">,</span> <span class="n">positions</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">positions</span><span class="p">,</span> <span class="nb">list</span><span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Expected an iterable (list, tuple), but was: </span><span class="si">{</span><span class="n">positions</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
            <span class="n">positions</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="n">Point2</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
        <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;List is expected to have Point2, tuples or lists, but instead had: </span><span class="si">{</span><span class="n">positions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">positions</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">_query_building_placement_fast</span><span class="p">(</span><span class="n">building</span><span class="p">,</span> <span class="n">positions</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.can_place_single">
    <p>def <span class="ident">can_place_single</span>(</p><p>self, building, position)</p>
    </div>
    

    
  
    <div class="desc"><p>Checks the placement for only one position.
This function might get removed in favor of the function below (can_place).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.can_place_single', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.can_place_single" class="source">
    <div class="codehilite"><pre><span></span><span class="k">async</span> <span class="k">def</span> <span class="nf">can_place_single</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">building</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">AbilityData</span><span class="p">,</span> <span class="n">AbilityId</span><span class="p">,</span> <span class="n">UnitTypeId</span><span class="p">],</span> <span class="n">position</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Point2</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot; Checks the placement for only one position.</span>
<span class="sd">    This function might get removed in favor of the function below (can_place). &quot;&quot;&quot;</span>
    <span class="n">r</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">_query_building_placement_fast</span><span class="p">(</span><span class="n">building</span><span class="p">,</span> <span class="p">[</span><span class="n">position</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.chat_send">
    <p>def <span class="ident">chat_send</span>(</p><p>self, message, team_only=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Send a chat message to the SC2 Client.</p>
<p>Example::</p>
<div class="codehilite"><pre><span></span><span class="err">await self.chat_send(&quot;Hello, this is a message from my bot!&quot;)</span>
</pre></div>


<p>:param message:
:param team_only:</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.chat_send', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.chat_send" class="source">
    <div class="codehilite"><pre><span></span><span class="k">async</span> <span class="k">def</span> <span class="nf">chat_send</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">team_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Send a chat message to the SC2 Client.</span>
<span class="sd">    Example::</span>
<span class="sd">        await self.chat_send(&quot;Hello, this is a message from my bot!&quot;)</span>
<span class="sd">    :param message:</span>
<span class="sd">    :param team_only: &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="nb">str</span><span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">message</span><span class="si">}</span><span class="s2"> is not a string&quot;</span>
    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">chat_send</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">team_only</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.checkAndAdvance">
    <p>def <span class="ident">checkAndAdvance</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Checks buildlist progress and advances it.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.checkAndAdvance', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.checkAndAdvance" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">checkAndAdvance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Checks buildlist progress and advances it.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">done</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span> <span class="o">==</span> <span class="n">UnitTypeId</span><span class="o">.</span><span class="n">NOTAUNIT</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buildList</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1"># extract first build list element and set as current task</span>
                <span class="n">nextTaskName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">buildList</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">unitToId</span><span class="p">(</span><span class="n">nextTaskName</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Beginning next task: &quot;</span> <span class="o">+</span> <span class="n">nextTaskName</span> <span class="o">+</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">done</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.checkBuildListCompleted">
    <p>def <span class="ident">checkBuildListCompleted</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Post buildlist completed check.</p>
<p>This does not check if the list of build tasks is empty but it checks
if all buildings are ready and idle and if all remaining build tasks
have been completed</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.checkBuildListCompleted', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.checkBuildListCompleted" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">checkBuildListCompleted</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Post buildlist completed check.</span>
<span class="sd">    This does not check if the list of build tasks is empty but it checks</span>
<span class="sd">    if all buildings are ready and idle and if all remaining build tasks</span>
<span class="sd">    have been completed</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">done</span><span class="p">:</span>
        <span class="n">allStructuresReady</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">allStructuresIdle</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">for</span> <span class="n">structure</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">structures</span><span class="p">:</span>
            <span class="n">allStructuresReady</span> <span class="o">=</span> <span class="n">allStructuresReady</span> <span class="ow">and</span> <span class="n">structure</span><span class="o">.</span><span class="n">is_ready</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">structure</span><span class="o">.</span><span class="n">is_ready</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">structure</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; is not ready&quot;</span><span class="p">)</span>
            <span class="n">allStructuresIdle</span> <span class="o">=</span> <span class="n">allStructuresIdle</span> <span class="ow">and</span> <span class="n">structure</span><span class="o">.</span><span class="n">is_idle</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">structure</span><span class="o">.</span><span class="n">is_idle</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">structure</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; is not idle&quot;</span><span class="p">)</span>
    
        <span class="n">allUnitsReady</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">for</span> <span class="n">unit</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">:</span>
            <span class="n">allUnitsReady</span> <span class="o">=</span> <span class="n">allUnitsReady</span> <span class="ow">and</span> <span class="n">unit</span><span class="o">.</span><span class="n">is_ready</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">unit</span><span class="o">.</span><span class="n">is_ready</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; is not ready!&quot;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">race</span> <span class="o">==</span> <span class="n">Race</span><span class="o">.</span><span class="n">Zerg</span><span class="p">:</span>
            <span class="n">allUnitsReady</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">unit</span><span class="p">:</span> <span class="n">unit</span><span class="o">.</span><span class="n">type_id</span> <span class="o">==</span> <span class="n">UnitTypeId</span><span class="o">.</span><span class="n">EGG</span><span class="p">)</span><span class="o">.</span><span class="n">empty</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">allStructuresReady</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Buildlist is done but not all structures are ready!&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">allStructuresIdle</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Buildlist is done but not all structures are idle!&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">allUnitsReady</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Buildlist is done but not all units are ready!&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">allStructuresReady</span> <span class="ow">and</span> <span class="n">allStructuresIdle</span> <span class="ow">and</span> <span class="n">allUnitsReady</span><span class="p">:</span>
            <span class="c1"># the final check of remainingBuildTasks if everything was built</span>
            <span class="k">for</span> <span class="n">unitId</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">remainingBuildTasks</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="c1"># safety net for terran (and protoss)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">already_pending</span><span class="p">(</span><span class="n">unitId</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">False</span> <span class="c1"># the building is pending --&gt; worker walking to build etc.</span>
                <span class="k">if</span> <span class="n">unitId</span> <span class="ow">in</span> <span class="n">BASE_BUILDINGS</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;All units: </span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">all_units</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">count</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">unitId</span> <span class="o">==</span> <span class="n">race_worker</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">race</span><span class="p">]:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;The bot did not produce the correct number of workers. Timings will not be correct but the army strength can still be compared!&quot;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Everything should be done but &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">unitId</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; was not build as many times as it was supposed to!&quot;</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Everything should be done but &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">unitId</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; was build more than it was supposed to!&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.checkCosts">
    <p>def <span class="ident">checkCosts</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Check if the current task is affordable.</p>
<p>returns a pair of bools stating if the task is currently affordable and
if we can wait such that it becomes affordable.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.checkCosts', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.checkCosts" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">checkCosts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Check if the current task is affordable.</span>
<span class="sd">    </span>
<span class="sd">    returns a pair of bools stating if the task is currently affordable and</span>
<span class="sd">    if we can wait such that it becomes affordable.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cost</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_cost</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span><span class="p">)</span>
    <span class="c1"># TODO: the check here (self.workers.gathering &gt; 0) does not work for terran and protoss</span>
    <span class="n">minerals</span> <span class="o">=</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">cost</span><span class="o">.</span><span class="n">minerals</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">minerals</span><span class="p">:</span>
        <span class="c1"># not enough right now but maybe later?</span>
        <span class="c1"># at least some workers and</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workers</span><span class="o">.</span><span class="n">gathering</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">townhalls</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">minerals</span> <span class="o">=</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">minerals</span> <span class="o">=</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;There are not enough minerals to build &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; and waiting does not help!&quot;</span><span class="p">)</span>
    
    <span class="n">vespene</span> <span class="o">=</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">cost</span><span class="o">.</span><span class="n">vespene</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">vespene</span><span class="p">:</span>
        <span class="c1"># not enough right now but maybe later?</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workers</span><span class="o">.</span><span class="n">gathering</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gas_buildings</span><span class="o">.</span><span class="n">ready</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">already_pending</span><span class="p">(</span><span class="n">race_gas</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">race</span><span class="p">]):</span>
            <span class="c1"># waiting helps</span>
            <span class="n">vespene</span> <span class="o">=</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">vespene</span> <span class="o">=</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;There are not enough vespene to build &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; and waiting does not help!&quot;</span><span class="p">)</span>
    <span class="n">supply</span> <span class="o">=</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">supply_cost</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_supply_cost</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span><span class="p">)</span>
    <span class="c1"># make sure this thing actually has supply cost</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span><span class="p">,</span> <span class="n">UnitTypeId</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">supply_cost</span> <span class="ow">and</span> <span class="n">supply_cost</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">supply_left</span><span class="p">:</span>
            <span class="c1"># we dont have enough supply right now but maybe later?</span>
            <span class="n">supply</span> <span class="o">=</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
            <span class="c1"># check if supply building is being built</span>
            <span class="c1"># already pending checks everything: check its documentation</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">already_pending</span><span class="p">(</span><span class="n">race_supplyUnit</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">race</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">supply</span> <span class="o">=</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;There is not enough supply to build &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; and waiting does not help!&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">minerals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">vespene</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">supply</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">minerals</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">and</span> <span class="n">vespene</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">and</span> <span class="n">supply</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.checkIfProducerExists">
    <p>def <span class="ident">checkIfProducerExists</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Check if a producer for the current task exists.</p>
<p>returns a pair of bools stating if a producer is currently available and
if we can wait such that it becomes available.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.checkIfProducerExists', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.checkIfProducerExists" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">checkIfProducerExists</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Check if a producer for the current task exists.</span>
<span class="sd">    </span>
<span class="sd">    returns a pair of bools stating if a producer is currently available and</span>
<span class="sd">    if we can wait such that it becomes available.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
    <span class="n">producersAvailable</span><span class="p">:</span> <span class="n">Units</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getProducerUnitsForCurrentTask</span><span class="p">()</span>
    <span class="n">producersAvailable</span> <span class="o">=</span> <span class="n">producersAvailable</span><span class="o">.</span><span class="n">ready</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">producersAvailable</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
        <span class="c1"># is any of these available producers idle</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">producer</span><span class="o">.</span><span class="n">is_idle</span> <span class="ow">or</span> <span class="n">producer</span><span class="o">.</span><span class="n">is_gathering</span> <span class="k">for</span> <span class="n">producer</span> <span class="ow">in</span> <span class="n">producersAvailable</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># is any of the unit ids being produced or queued?</span>
        <span class="n">producerIds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getProducerIdsForCurrentTask</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">already_pending</span><span class="p">(</span><span class="n">producerId</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0</span> <span class="k">for</span> <span class="n">producerId</span> <span class="ow">in</span> <span class="n">producerIds</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="c1"># for zerg producer might be larva. already_pending will not account for that</span>
        <span class="c1"># as long as we have a least one Hatchery/Lair/Hive</span>
        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">race</span> <span class="o">==</span> <span class="n">Race</span><span class="o">.</span><span class="n">Zerg</span> <span class="ow">and</span> <span class="n">UnitTypeId</span><span class="o">.</span><span class="n">LARVA</span> <span class="ow">in</span> <span class="n">producerIds</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">townhalls</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.checkIfTechRequirementFulfilled">
    <p>def <span class="ident">checkIfTechRequirementFulfilled</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Check if the tech requirement for the current task is fulfilled.</p>
<p>returns a pair of bools stating if the requirement is currently fulfilled and
if we can wait such that it becomes fulfilled.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.checkIfTechRequirementFulfilled', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.checkIfTechRequirementFulfilled" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">checkIfTechRequirementFulfilled</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Check if the tech requirement for the current task is fulfilled.</span>
<span class="sd">    </span>
<span class="sd">    returns a pair of bools stating if the requirement is currently fulfilled and</span>
<span class="sd">    if we can wait such that it becomes fulfilled.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">race_dict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">Race</span><span class="o">.</span><span class="n">Protoss</span><span class="p">:</span> <span class="n">PROTOSS_TECH_REQUIREMENT</span><span class="p">,</span>
        <span class="n">Race</span><span class="o">.</span><span class="n">Terran</span><span class="p">:</span> <span class="n">TERRAN_TECH_REQUIREMENT</span><span class="p">,</span>
        <span class="n">Race</span><span class="o">.</span><span class="n">Zerg</span><span class="p">:</span> <span class="n">ZERG_TECH_REQUIREMENT</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="c1"># this gets the requirement for the unit we are checking</span>
    <span class="n">requirement</span> <span class="o">=</span> <span class="n">race_dict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">race</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span><span class="p">]</span>
    <span class="c1"># if there is no requirement we can just skip the remaining stuff</span>
    <span class="k">if</span> <span class="n">UnitTypeId</span><span class="o">.</span><span class="n">NOTAUNIT</span> <span class="o">==</span> <span class="n">requirement</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="c1"># </span>
    <span class="n">requirementEquivalents</span> <span class="o">=</span> <span class="p">{</span><span class="n">requirement</span><span class="p">}</span>
    <span class="k">for</span> <span class="n">equiv_structure</span> <span class="ow">in</span> <span class="n">EQUIVALENTS_FOR_TECH_PROGRESS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">requirement</span><span class="p">,</span> <span class="p">[]):</span>
        <span class="n">requirementEquivalents</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">equiv_structure</span><span class="p">)</span>
    <span class="n">correspondingStructures</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structures</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">unit</span><span class="p">:</span> <span class="n">unit</span><span class="o">.</span><span class="n">type_id</span> <span class="ow">in</span> <span class="n">requirementEquivalents</span><span class="p">)</span>
    <span class="c1"># any of them already existing?</span>
    <span class="n">fulfilled</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">correspondingStructures</span><span class="o">.</span><span class="n">ready</span><span class="p">)</span>
        
    <span class="c1"># is any of these pending?</span>
    <span class="c1"># if yes waiting helps</span>
    <span class="c1"># waiting is also fine if it already exists</span>
    <span class="n">waitingHelps</span> <span class="o">=</span> <span class="n">fulfilled</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">fulfilled</span><span class="p">:</span>
        <span class="n">waitingHelps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">already_pending</span><span class="p">(</span><span class="n">requirement</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> 
    <span class="k">return</span> <span class="p">(</span><span class="n">fulfilled</span><span class="p">,</span> <span class="n">waitingHelps</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.checkPreconditions">
    <p>def <span class="ident">checkPreconditions</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Combine producer, cost and tech requirement check.</p>
<p>returns a bool if the current task can be built right now.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.checkPreconditions', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.checkPreconditions" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">checkPreconditions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Combine producer, cost and tech requirement check.</span>
<span class="sd">    </span>
<span class="sd">    returns a bool if the current task can be built right now.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># check if the producer exists or is under construction and if the producer is idle</span>
    <span class="n">producerExists</span><span class="p">,</span> <span class="n">canWaitProducer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkIfProducerExists</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">producerExists</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">canWaitProducer</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;There must be a producer for &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span><span class="p">))</span>
    <span class="c1"># check if we can afford the unit/structure</span>
    <span class="n">resourcesExist</span><span class="p">,</span> <span class="n">canWaitResources</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkCosts</span><span class="p">()</span> 
    <span class="k">if</span> <span class="ow">not</span> <span class="n">resourcesExist</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">canWaitResources</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;There is not enough minerals, vespene or supply and waiting for it will not help!&quot;</span><span class="p">)</span>
    <span class="c1"># check if tech requirement is fullfilled only if the resources exist</span>
    <span class="n">requirementFulfilled</span><span class="p">,</span> <span class="n">canWaitRequirement</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkIfTechRequirementFulfilled</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">requirementFulfilled</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">canWaitRequirement</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;The requirement for &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; is not fullfilled!&quot;</span><span class="p">)</span>
    <span class="c1"># just return if we are able to build immediately --&gt; if not that means we have to wait</span>
    <span class="k">return</span> <span class="n">producerExists</span> <span class="ow">and</span> <span class="n">resourcesExist</span> <span class="ow">and</span> <span class="n">requirementFulfilled</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.computeExpansionLocations">
    <p>def <span class="ident">computeExpansionLocations</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Computes expansion locations.</p>
<p>Only works on simple map. This is used in determining the expansions for
each bot on the map.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.computeExpansionLocations', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.computeExpansionLocations" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">computeExpansionLocations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Computes expansion locations.</span>
<span class="sd">    </span>
<span class="sd">    Only works on simple map. This is used in determining the expansions for</span>
<span class="sd">    each bot on the map.&quot;&quot;&quot;</span>
    <span class="n">possibleExpansionLocations</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="c1"># add all expansions including player start locations to the set</span>
    <span class="k">for</span> <span class="n">expansionLocation</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">expansion_locations_list</span><span class="p">:</span>
        <span class="n">possibleExpansionLocations</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">expansionLocation</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">expansionLocation</span> <span class="ow">in</span> <span class="n">possibleExpansionLocations</span><span class="p">:</span>
        <span class="c1"># the bottom row of expansions is roughly at 22.5</span>
        <span class="c1"># use a threshhold to ensure every single one is in</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">expansionLocation</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mf">22.5</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">2.0</span><span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">bottomExpansions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">expansionLocation</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">bottomExpansions</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">expansionLocation</span> <span class="ow">in</span> <span class="n">possibleExpansionLocations</span><span class="p">:</span>
        <span class="c1"># the top row of expansions is roughly at 125.5</span>
        <span class="c1"># use a threshhold to ensure every single one is in</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">expansionLocation</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mf">125.5</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">2.0</span><span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">topExpansions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">expansionLocation</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">topExpansions</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">expansionLocation</span> <span class="ow">in</span> <span class="n">possibleExpansionLocations</span><span class="p">:</span>
        <span class="c1"># the left column of expansions is roughly at 24.5</span>
        <span class="c1"># use a threshhold to ensure every single one is in</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">expansionLocation</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">24.5</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">2.0</span><span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">leftExpansions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">expansionLocation</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">leftExpansions</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">expansionLocation</span> <span class="ow">in</span> <span class="n">possibleExpansionLocations</span><span class="p">:</span>
        <span class="c1"># the right column of expansions is roughly at 24.5</span>
        <span class="c1"># use a threshhold to ensure every single one is in</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">expansionLocation</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">127.5</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">2.0</span><span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">rightExpansions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">expansionLocation</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">rightExpansions</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="c1"># there is always two directions in which we could go to find expansions:</span>
    <span class="c1"># in ccw and in cw direction</span>
    <span class="c1"># we always prefer ccw direction but alternate between the two to stay close to our main</span>
    <span class="c1"># my side:</span>
    <span class="c1"># --------------------</span>
    <span class="n">playerOnePreferredExpansionCCWDirection</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="n">playerOnePreferredExpansionCWDirection</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="n">currentCCW</span><span class="p">:</span> <span class="n">Point2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getLocationFromStartLocation</span><span class="p">(</span><span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_ONE_START_LOCATION</span><span class="p">)</span>
    <span class="n">currentCW</span><span class="p">:</span> <span class="n">Point2</span> <span class="o">=</span> <span class="n">currentCCW</span>
    <span class="n">currentCCW</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">findNextExpansion</span><span class="p">(</span><span class="n">currentCCW</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">currentCW</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">findNextExpansion</span><span class="p">(</span><span class="n">currentCW</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">currentCW</span> <span class="o">!=</span> <span class="n">currentCCW</span><span class="p">:</span>
        <span class="c1"># store</span>
        <span class="n">playerOnePreferredExpansionCCWDirection</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">currentCCW</span><span class="p">)</span>
        <span class="n">playerOnePreferredExpansionCWDirection</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">currentCW</span><span class="p">)</span>
        <span class="c1"># advance</span>
        <span class="n">currentCCW</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">findNextExpansion</span><span class="p">(</span><span class="n">currentCCW</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">currentCW</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">findNextExpansion</span><span class="p">(</span><span class="n">currentCW</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
    
    <span class="c1"># append one last time</span>
    <span class="n">playerOnePreferredExpansionCCWDirection</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">currentCCW</span><span class="p">)</span>
    <span class="n">playerOnePreferredExpansionCWDirection</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">currentCW</span><span class="p">)</span>
    <span class="c1"># opponents side side:</span>
    <span class="c1"># --------------------</span>
    <span class="n">playerTwoPreferredExpansionCCWDirection</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="n">playerTwoPreferredExpansionCWDirection</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="n">currentCCW</span><span class="p">:</span> <span class="n">Point2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getLocationFromStartLocation</span><span class="p">(</span><span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_TWO_START_LOCATION</span><span class="p">)</span>
    <span class="n">currentCW</span><span class="p">:</span> <span class="n">Point2</span> <span class="o">=</span> <span class="n">currentCCW</span>
    <span class="n">currentCCW</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">findNextExpansion</span><span class="p">(</span><span class="n">currentCCW</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">currentCW</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">findNextExpansion</span><span class="p">(</span><span class="n">currentCW</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">currentCW</span> <span class="o">!=</span> <span class="n">currentCCW</span><span class="p">:</span>
        <span class="c1"># store</span>
        <span class="n">playerTwoPreferredExpansionCCWDirection</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">currentCCW</span><span class="p">)</span>
        <span class="n">playerTwoPreferredExpansionCWDirection</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">currentCW</span><span class="p">)</span>
        <span class="c1"># advance</span>
        <span class="n">currentCCW</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">findNextExpansion</span><span class="p">(</span><span class="n">currentCCW</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">currentCW</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">findNextExpansion</span><span class="p">(</span><span class="n">currentCW</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
    
    <span class="c1"># append one last time</span>
    <span class="n">playerTwoPreferredExpansionCCWDirection</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">currentCCW</span><span class="p">)</span>
    <span class="n">playerTwoPreferredExpansionCWDirection</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">currentCW</span><span class="p">)</span>
    <span class="c1"># now of both players the preferences of expansions in both possible directions are known</span>
    
    <span class="c1"># remove both start locations from possibleExpansionLocations</span>
    <span class="n">possibleExpansionLocations</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getLocationFromStartLocation</span><span class="p">(</span><span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_ONE_START_LOCATION</span><span class="p">))</span>
    <span class="n">possibleExpansionLocations</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getLocationFromStartLocation</span><span class="p">(</span><span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_TWO_START_LOCATION</span><span class="p">))</span>
    <span class="n">playerOneExpansionLocations</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="n">playerTwoExpansionLocations</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="c1"># ccw direction is always taken first</span>
    <span class="n">ccwRoundPlayerOne</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">ccwRoundPlayerTwo</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">while</span> <span class="nb">bool</span><span class="p">(</span><span class="n">possibleExpansionLocations</span><span class="p">):</span>
        <span class="c1"># player one goes first</span>
        <span class="k">if</span> <span class="n">ccwRoundPlayerOne</span><span class="p">:</span>  
            <span class="n">playerOneSelectedExpansion</span> <span class="o">=</span> <span class="n">playerOnePreferredExpansionCCWDirection</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">playerOneSelectedExpansion</span> <span class="ow">in</span> <span class="n">possibleExpansionLocations</span><span class="p">:</span>
                <span class="n">playerOneExpansionLocations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">playerOneSelectedExpansion</span><span class="p">)</span>
                <span class="n">possibleExpansionLocations</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">playerOneSelectedExpansion</span><span class="p">)</span>
                <span class="n">ccwRoundPlayerOne</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">playerOneSelectedExpansion</span> <span class="o">=</span> <span class="n">playerOnePreferredExpansionCWDirection</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">playerOneSelectedExpansion</span> <span class="ow">in</span> <span class="n">possibleExpansionLocations</span><span class="p">:</span>
                    <span class="n">playerOneExpansionLocations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">playerOneSelectedExpansion</span><span class="p">)</span>
                    <span class="n">possibleExpansionLocations</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">playerOneSelectedExpansion</span><span class="p">)</span>
                    <span class="n">ccwRoundPlayerOne</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;There are no expansion locations left for player one even though there is still locations available!&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">playerOneSelectedExpansion</span> <span class="o">=</span> <span class="n">playerOnePreferredExpansionCWDirection</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">playerOneSelectedExpansion</span> <span class="ow">in</span> <span class="n">possibleExpansionLocations</span><span class="p">:</span>
                <span class="n">playerOneExpansionLocations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">playerOneSelectedExpansion</span><span class="p">)</span>
                <span class="n">possibleExpansionLocations</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">playerOneSelectedExpansion</span><span class="p">)</span>
                <span class="n">ccwRoundPlayerOne</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">playerOneSelectedExpansion</span> <span class="o">=</span> <span class="n">playerOnePreferredExpansionCCWDirection</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">playerOneSelectedExpansion</span> <span class="ow">in</span> <span class="n">possibleExpansionLocations</span><span class="p">:</span>
                    <span class="n">playerOneExpansionLocations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">playerOneSelectedExpansion</span><span class="p">)</span>
                    <span class="n">possibleExpansionLocations</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">playerOneSelectedExpansion</span><span class="p">)</span>
                    <span class="n">ccwRoundPlayerOne</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;There are no expansion locations left for player one even though there is still locations available!&quot;</span><span class="p">)</span>
        <span class="c1"># player two goes second</span>
        <span class="k">if</span> <span class="n">ccwRoundPlayerTwo</span><span class="p">:</span>
            <span class="n">playerTwoSelectedExpansion</span> <span class="o">=</span> <span class="n">playerTwoPreferredExpansionCCWDirection</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">playerTwoSelectedExpansion</span> <span class="ow">in</span> <span class="n">possibleExpansionLocations</span><span class="p">:</span>
                <span class="n">playerTwoExpansionLocations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">playerTwoSelectedExpansion</span><span class="p">)</span>
                <span class="n">possibleExpansionLocations</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">playerTwoSelectedExpansion</span><span class="p">)</span>
                <span class="n">ccwRoundPlayerTwo</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">playerTwoSelectedExpansion</span> <span class="o">=</span> <span class="n">playerTwoPreferredExpansionCWDirection</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">playerTwoSelectedExpansion</span> <span class="ow">in</span> <span class="n">possibleExpansionLocations</span><span class="p">:</span>
                    <span class="n">playerTwoExpansionLocations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">playerTwoSelectedExpansion</span><span class="p">)</span>
                    <span class="n">possibleExpansionLocations</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">playerTwoSelectedExpansion</span><span class="p">)</span>
                    <span class="n">ccwRoundPlayerTwo</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;There are no expansion locations left for player one even though there is still locations available!&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">playerTwoSelectedExpansion</span> <span class="o">=</span> <span class="n">playerTwoPreferredExpansionCWDirection</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">playerTwoSelectedExpansion</span> <span class="ow">in</span> <span class="n">possibleExpansionLocations</span><span class="p">:</span>
                <span class="n">playerTwoExpansionLocations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">playerTwoSelectedExpansion</span><span class="p">)</span>
                <span class="n">possibleExpansionLocations</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">playerTwoSelectedExpansion</span><span class="p">)</span>
                <span class="n">ccwRoundPlayerTwo</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">playerTwoSelectedExpansion</span> <span class="o">=</span> <span class="n">playerTwoPreferredExpansionCCWDirection</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">playerTwoSelectedExpansion</span> <span class="ow">in</span> <span class="n">possibleExpansionLocations</span><span class="p">:</span>
                    <span class="n">playerTwoExpansionLocations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">playerTwoSelectedExpansion</span><span class="p">)</span>
                    <span class="n">possibleExpansionLocations</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">playerTwoSelectedExpansion</span><span class="p">)</span>
                    <span class="n">ccwRoundPlayerTwo</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;There are no expansion locations left for player one even though there is still locations available!&quot;</span><span class="p">)</span>
    
    
    
    <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_ONE_EXPANSION_LOCATIONS</span> <span class="o">=</span> <span class="n">playerOneExpansionLocations</span>
    <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_TWO_EXPANSION_LOCATIONS</span> <span class="o">=</span> <span class="n">playerTwoExpansionLocations</span>   
    <span class="k">return</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.convert_tuple_to_numpy_array">
    <p>def <span class="ident">convert_tuple_to_numpy_array</span>(</p><p>self, pos)</p>
    </div>
    

    
  
    <div class="desc"><p>Converts a single position to a 2d numpy array with 1 row and 2 columns.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.convert_tuple_to_numpy_array', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.convert_tuple_to_numpy_array" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">convert_tuple_to_numpy_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot; Converts a single position to a 2d numpy array with 1 row and 2 columns. &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">fromiter</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.distance_math_hypot">
    <p>def <span class="ident">distance_math_hypot</span>(</p><p>self, p1, p2)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.distance_math_hypot', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.distance_math_hypot" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">distance_math_hypot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p1</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span> <span class="n">p2</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]):</span>
    <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">hypot</span><span class="p">(</span><span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">p2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">p2</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.distance_math_hypot_squared">
    <p>def <span class="ident">distance_math_hypot_squared</span>(</p><p>self, p1, p2)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.distance_math_hypot_squared', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.distance_math_hypot_squared" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">distance_math_hypot_squared</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p1</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span> <span class="n">p2</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]):</span>
    <span class="k">return</span> <span class="nb">pow</span><span class="p">(</span><span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">p2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="nb">pow</span><span class="p">(</span><span class="n">p1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">p2</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.distribute_workers">
    <p>def <span class="ident">distribute_workers</span>(</p><p>self, resource_ratio=2)</p>
    </div>
    

    
  
    <div class="desc"><p>Distributes workers across all the bases taken.
Keyword <code>resource_ratio</code> takes a float. If the current minerals to gas
ratio is bigger than <code>resource_ratio</code>, this function prefer filling gas_buildings
first, if it is lower, it will prefer sending workers to minerals first.</p>
<p>NOTE: This function is far from optimal, if you really want to have
refined worker control, you should write your own distribution function.
For example long distance mining control and moving workers if a base was killed
are not being handled.</p>
<p>WARNING: This is quite slow when there are lots of workers or multiple bases.</p>
<p>:param resource_ratio:</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.distribute_workers', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.distribute_workers" class="source">
    <div class="codehilite"><pre><span></span><span class="k">async</span> <span class="k">def</span> <span class="nf">distribute_workers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource_ratio</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Distributes workers across all the bases taken.</span>
<span class="sd">    Keyword `resource_ratio` takes a float. If the current minerals to gas</span>
<span class="sd">    ratio is bigger than `resource_ratio`, this function prefer filling gas_buildings</span>
<span class="sd">    first, if it is lower, it will prefer sending workers to minerals first.</span>
<span class="sd">    NOTE: This function is far from optimal, if you really want to have</span>
<span class="sd">    refined worker control, you should write your own distribution function.</span>
<span class="sd">    For example long distance mining control and moving workers if a base was killed</span>
<span class="sd">    are not being handled.</span>
<span class="sd">    WARNING: This is quite slow when there are lots of workers or multiple bases.</span>
<span class="sd">    :param resource_ratio: &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">mineral_field</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">workers</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">townhalls</span><span class="o">.</span><span class="n">ready</span><span class="p">:</span>
        <span class="k">return</span>
    <span class="n">worker_pool</span> <span class="o">=</span> <span class="p">[</span><span class="n">worker</span> <span class="k">for</span> <span class="n">worker</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">workers</span><span class="o">.</span><span class="n">idle</span><span class="p">]</span>
    <span class="n">bases</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">townhalls</span><span class="o">.</span><span class="n">ready</span>
    <span class="n">gas_buildings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_buildings</span><span class="o">.</span><span class="n">ready</span>
    <span class="c1"># list of places that need more workers</span>
    <span class="n">deficit_mining_places</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">mining_place</span> <span class="ow">in</span> <span class="n">bases</span> <span class="o">|</span> <span class="n">gas_buildings</span><span class="p">:</span>
        <span class="n">difference</span> <span class="o">=</span> <span class="n">mining_place</span><span class="o">.</span><span class="n">surplus_harvesters</span>
        <span class="c1"># perfect amount of workers, skip mining place</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">difference</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">mining_place</span><span class="o">.</span><span class="n">has_vespene</span><span class="p">:</span>
            <span class="c1"># get all workers that target the gas extraction site</span>
            <span class="c1"># or are on their way back from it</span>
            <span class="n">local_workers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">workers</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">unit</span><span class="p">:</span> <span class="n">unit</span><span class="o">.</span><span class="n">order_target</span> <span class="o">==</span> <span class="n">mining_place</span><span class="o">.</span><span class="n">tag</span>
                <span class="ow">or</span> <span class="p">(</span><span class="n">unit</span><span class="o">.</span><span class="n">is_carrying_vespene</span> <span class="ow">and</span> <span class="n">unit</span><span class="o">.</span><span class="n">order_target</span> <span class="o">==</span> <span class="n">bases</span><span class="o">.</span><span class="n">closest_to</span><span class="p">(</span><span class="n">mining_place</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># get tags of minerals around expansion</span>
            <span class="n">local_minerals_tags</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">mineral</span><span class="o">.</span><span class="n">tag</span> <span class="k">for</span> <span class="n">mineral</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mineral_field</span> <span class="k">if</span> <span class="n">mineral</span><span class="o">.</span><span class="n">distance_to</span><span class="p">(</span><span class="n">mining_place</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">8</span>
            <span class="p">}</span>
            <span class="c1"># get all target tags a worker can have</span>
            <span class="c1"># tags of the minerals he could mine at that base</span>
            <span class="c1"># get workers that work at that gather site</span>
            <span class="n">local_workers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">workers</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">unit</span><span class="p">:</span> <span class="n">unit</span><span class="o">.</span><span class="n">order_target</span> <span class="ow">in</span> <span class="n">local_minerals_tags</span>
                <span class="ow">or</span> <span class="p">(</span><span class="n">unit</span><span class="o">.</span><span class="n">is_carrying_minerals</span> <span class="ow">and</span> <span class="n">unit</span><span class="o">.</span><span class="n">order_target</span> <span class="o">==</span> <span class="n">mining_place</span><span class="o">.</span><span class="n">tag</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="c1"># too many workers</span>
        <span class="k">if</span> <span class="n">difference</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">worker</span> <span class="ow">in</span> <span class="n">local_workers</span><span class="p">[:</span><span class="n">difference</span><span class="p">]:</span>
                <span class="n">worker_pool</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">worker</span><span class="p">)</span>
        <span class="c1"># too few workers</span>
        <span class="c1"># add mining place to deficit bases for every missing worker</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">deficit_mining_places</span> <span class="o">+=</span> <span class="p">[</span><span class="n">mining_place</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="n">difference</span><span class="p">)]</span>
    <span class="c1"># prepare all minerals near a base if we have too many workers</span>
    <span class="c1"># and need to send them to the closest patch</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">worker_pool</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">deficit_mining_places</span><span class="p">):</span>
        <span class="n">all_minerals_near_base</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">mineral</span>
            <span class="k">for</span> <span class="n">mineral</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mineral_field</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">mineral</span><span class="o">.</span><span class="n">distance_to</span><span class="p">(</span><span class="n">base</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">8</span> <span class="k">for</span> <span class="n">base</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">townhalls</span><span class="o">.</span><span class="n">ready</span><span class="p">)</span>
        <span class="p">]</span>
    <span class="c1"># distribute every worker in the pool</span>
    <span class="k">for</span> <span class="n">worker</span> <span class="ow">in</span> <span class="n">worker_pool</span><span class="p">:</span>
        <span class="c1"># as long as have workers and mining places</span>
        <span class="k">if</span> <span class="n">deficit_mining_places</span><span class="p">:</span>
            <span class="c1"># choose only mineral fields first if current mineral to gas ratio is less than target ratio</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vespene</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">minerals</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">vespene</span> <span class="o">&lt;</span> <span class="n">resource_ratio</span><span class="p">:</span>
                <span class="n">possible_mining_places</span> <span class="o">=</span> <span class="p">[</span><span class="n">place</span> <span class="k">for</span> <span class="n">place</span> <span class="ow">in</span> <span class="n">deficit_mining_places</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">place</span><span class="o">.</span><span class="n">vespene_contents</span><span class="p">]</span>
            <span class="c1"># else prefer gas</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">possible_mining_places</span> <span class="o">=</span> <span class="p">[</span><span class="n">place</span> <span class="k">for</span> <span class="n">place</span> <span class="ow">in</span> <span class="n">deficit_mining_places</span> <span class="k">if</span> <span class="n">place</span><span class="o">.</span><span class="n">vespene_contents</span><span class="p">]</span>
            <span class="c1"># if preferred type is not available any more, get all other places</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">possible_mining_places</span><span class="p">:</span>
                <span class="n">possible_mining_places</span> <span class="o">=</span> <span class="n">deficit_mining_places</span>
            <span class="c1"># find closest mining place</span>
            <span class="n">current_place</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">deficit_mining_places</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">place</span><span class="p">:</span> <span class="n">place</span><span class="o">.</span><span class="n">distance_to</span><span class="p">(</span><span class="n">worker</span><span class="p">))</span>
            <span class="c1"># remove it from the list</span>
            <span class="n">deficit_mining_places</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">current_place</span><span class="p">)</span>
            <span class="c1"># if current place is a gas extraction site, go there</span>
            <span class="k">if</span> <span class="n">current_place</span><span class="o">.</span><span class="n">vespene_contents</span><span class="p">:</span>
                <span class="n">worker</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="n">current_place</span><span class="p">)</span>
            <span class="c1"># if current place is a gas extraction site,</span>
            <span class="c1"># go to the mineral field that is near and has the most minerals left</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">local_minerals</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">mineral</span> <span class="k">for</span> <span class="n">mineral</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mineral_field</span> <span class="k">if</span> <span class="n">mineral</span><span class="o">.</span><span class="n">distance_to</span><span class="p">(</span><span class="n">current_place</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">8</span>
                <span class="p">)</span>
                <span class="c1"># local_minerals can be empty if townhall is misplaced</span>
                <span class="n">target_mineral</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">local_minerals</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">mineral</span><span class="p">:</span> <span class="n">mineral</span><span class="o">.</span><span class="n">mineral_contents</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">target_mineral</span><span class="p">:</span>
                    <span class="n">worker</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="n">target_mineral</span><span class="p">)</span>
        <span class="c1"># more workers to distribute than free mining spots</span>
        <span class="c1"># send to closest if worker is doing nothing</span>
        <span class="k">elif</span> <span class="n">worker</span><span class="o">.</span><span class="n">is_idle</span> <span class="ow">and</span> <span class="n">all_minerals_near_base</span><span class="p">:</span>
            <span class="n">target_mineral</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">all_minerals_near_base</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">mineral</span><span class="p">:</span> <span class="n">mineral</span><span class="o">.</span><span class="n">distance_to</span><span class="p">(</span><span class="n">worker</span><span class="p">))</span>
            <span class="n">worker</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="n">target_mineral</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># there are no deficit mining places and worker is not idle</span>
            <span class="c1"># so dont move him</span>
            <span class="k">pass</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.do">
    <p>def <span class="ident">do</span>(</p><p>self, action, subtract_cost=False, subtract_supply=False, can_afford_check=False, ignore_warning=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Adds a unit action to the 'self.actions' list which is then executed at the end of the frame.</p>
<p>Training a unit::</p>
<div class="codehilite"><pre><span></span><span class="err"># Train an SCV from a random idle command center</span>
<span class="err">cc = self.townhalls.idle.random_or(None)</span>
<span class="err"># self.townhalls can be empty or there are no idle townhalls</span>
<span class="err">if cc and self.can_afford(UnitTypeId.SCV):</span>
<span class="err">    cc.train(UnitTypeId.SCV)</span>
</pre></div>


<p>Building a building::</p>
<div class="codehilite"><pre><span></span><span class="err"># Building a barracks at the main ramp, requires 150 minerals and a depot</span>
<span class="err">worker = self.workers.random_or(None)</span>
<span class="err">barracks_placement_position = self.main_base_ramp.barracks_correct_placement</span>
<span class="err">if worker and self.can_afford(UnitTypeId.BARRACKS):</span>
<span class="err">    worker.build(UnitTypeId.BARRACKS, barracks_placement_position)</span>
</pre></div>


<p>Moving a unit::</p>
<div class="codehilite"><pre><span></span><span class="err"># Move a random worker to the center of the map</span>
<span class="err">worker = self.workers.random_or(None)</span>
<span class="err"># worker can be None if all are dead</span>
<span class="err">if worker:</span>
<span class="err">    worker.move(self.game_info.map_center)</span>
</pre></div>


<p>:param action:
:param subtract_cost:
:param subtract_supply:
:param can_afford_check:</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.do', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.do" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">do</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">action</span><span class="p">:</span> <span class="n">UnitCommand</span><span class="p">,</span>
    <span class="n">subtract_cost</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">subtract_supply</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">can_afford_check</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">ignore_warning</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot; Adds a unit action to the &#39;self.actions&#39; list which is then executed at the end of the frame.</span>
<span class="sd">    Training a unit::</span>
<span class="sd">        # Train an SCV from a random idle command center</span>
<span class="sd">        cc = self.townhalls.idle.random_or(None)</span>
<span class="sd">        # self.townhalls can be empty or there are no idle townhalls</span>
<span class="sd">        if cc and self.can_afford(UnitTypeId.SCV):</span>
<span class="sd">            cc.train(UnitTypeId.SCV)</span>
<span class="sd">    Building a building::</span>
<span class="sd">        # Building a barracks at the main ramp, requires 150 minerals and a depot</span>
<span class="sd">        worker = self.workers.random_or(None)</span>
<span class="sd">        barracks_placement_position = self.main_base_ramp.barracks_correct_placement</span>
<span class="sd">        if worker and self.can_afford(UnitTypeId.BARRACKS):</span>
<span class="sd">            worker.build(UnitTypeId.BARRACKS, barracks_placement_position)</span>
<span class="sd">    Moving a unit::</span>
<span class="sd">        # Move a random worker to the center of the map</span>
<span class="sd">        worker = self.workers.random_or(None)</span>
<span class="sd">        # worker can be None if all are dead</span>
<span class="sd">        if worker:</span>
<span class="sd">            worker.move(self.game_info.map_center)</span>
<span class="sd">    :param action:</span>
<span class="sd">    :param subtract_cost:</span>
<span class="sd">    :param subtract_supply:</span>
<span class="sd">    :param can_afford_check:</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_command_uses_self_do</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ignore_warning</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;You have used self.do(). Please consider putting &#39;self.unit_command_uses_self_do = True&#39; in your bot __init__() function or removing self.do().&quot;</span><span class="p">,</span>
                <span class="ne">DeprecationWarning</span><span class="p">,</span>
                <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">action</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
        <span class="n">action</span><span class="p">,</span> <span class="n">UnitCommand</span>
    <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Given unit command is not a command, but instead of type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">action</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">if</span> <span class="n">subtract_cost</span><span class="p">:</span>
        <span class="n">cost</span><span class="p">:</span> <span class="n">Cost</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_game_data</span><span class="o">.</span><span class="n">calculate_ability_cost</span><span class="p">(</span><span class="n">action</span><span class="o">.</span><span class="n">ability</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">can_afford_check</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">minerals</span> <span class="o">&gt;=</span> <span class="n">cost</span><span class="o">.</span><span class="n">minerals</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">vespene</span> <span class="o">&gt;=</span> <span class="n">cost</span><span class="o">.</span><span class="n">vespene</span><span class="p">):</span>
            <span class="c1"># Dont do action if can&#39;t afford</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minerals</span> <span class="o">-=</span> <span class="n">cost</span><span class="o">.</span><span class="n">minerals</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vespene</span> <span class="o">-=</span> <span class="n">cost</span><span class="o">.</span><span class="n">vespene</span>
    <span class="k">if</span> <span class="n">subtract_supply</span> <span class="ow">and</span> <span class="n">action</span><span class="o">.</span><span class="n">ability</span> <span class="ow">in</span> <span class="n">abilityid_to_unittypeid</span><span class="p">:</span>
        <span class="n">unit_type</span> <span class="o">=</span> <span class="n">abilityid_to_unittypeid</span><span class="p">[</span><span class="n">action</span><span class="o">.</span><span class="n">ability</span><span class="p">]</span>
        <span class="n">required_supply</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_supply_cost</span><span class="p">(</span><span class="n">unit_type</span><span class="p">)</span>
        <span class="c1"># Overlord has -8</span>
        <span class="k">if</span> <span class="n">required_supply</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">supply_used</span> <span class="o">+=</span> <span class="n">required_supply</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">supply_left</span> <span class="o">-=</span> <span class="n">required_supply</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">unit_tags_received_action</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">action</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">tag</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">True</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.expand_now">
    <p>def <span class="ident">expand_now</span>(</p><p>self, building=None, max_distance=10, location=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Finds the next possible expansion via 'self.get_next_expansion()'. If the target expansion is blocked (e.g. an enemy unit), it will misplace the expansion.</p>
<p>:param building:
:param max_distance:
:param location:</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.expand_now', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.expand_now" class="source">
    <div class="codehilite"><pre><span></span><span class="k">async</span> <span class="k">def</span> <span class="nf">expand_now</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">building</span><span class="p">:</span> <span class="n">UnitTypeId</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">max_distance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">location</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Point2</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Finds the next possible expansion via &#39;self.get_next_expansion()&#39;. If the target expansion is blocked (e.g. an enemy unit), it will misplace the expansion.</span>
<span class="sd">    :param building:</span>
<span class="sd">    :param max_distance:</span>
<span class="sd">    :param location: &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">building</span><span class="p">:</span>
        <span class="c1"># self.race is never Race.Random</span>
        <span class="n">start_townhall_type</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">Race</span><span class="o">.</span><span class="n">Protoss</span><span class="p">:</span> <span class="n">UnitTypeId</span><span class="o">.</span><span class="n">NEXUS</span><span class="p">,</span>
            <span class="n">Race</span><span class="o">.</span><span class="n">Terran</span><span class="p">:</span> <span class="n">UnitTypeId</span><span class="o">.</span><span class="n">COMMANDCENTER</span><span class="p">,</span>
            <span class="n">Race</span><span class="o">.</span><span class="n">Zerg</span><span class="p">:</span> <span class="n">UnitTypeId</span><span class="o">.</span><span class="n">HATCHERY</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">building</span> <span class="o">=</span> <span class="n">start_townhall_type</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">race</span><span class="p">]</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">building</span><span class="p">,</span> <span class="n">UnitTypeId</span><span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">building</span><span class="si">}</span><span class="s2"> is no UnitTypeId&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">location</span><span class="p">:</span>
        <span class="n">location</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_next_expansion</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">location</span><span class="p">:</span>
        <span class="c1"># All expansions are used up or mined out</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Trying to expand_now() but bot is out of locations to expand to&quot;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">building</span><span class="p">,</span> <span class="n">near</span><span class="o">=</span><span class="n">location</span><span class="p">,</span> <span class="n">max_distance</span><span class="o">=</span><span class="n">max_distance</span><span class="p">,</span> <span class="n">random_alternative</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">placement_step</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.fillExpansionLocations">
    <p>def <span class="ident">fillExpansionLocations</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Wrapper for calling computeExpansionLocations() and doing some logging.</p>
<p>Only works on simple map. This is used in determining the expansions for
each bot on the map.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.fillExpansionLocations', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.fillExpansionLocations" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">fillExpansionLocations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Wrapper for calling computeExpansionLocations() and doing some logging.</span>
<span class="sd">    Only works on simple map. This is used in determining the expansions for</span>
<span class="sd">    each bot on the map.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span><span class="p">(</span><span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_TWO_START_LOCATION</span> <span class="o">!=</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">UNKNOWN</span><span class="p">)</span>
    <span class="k">assert</span><span class="p">(</span><span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_ONE_START_LOCATION</span> <span class="o">!=</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">UNKNOWN</span><span class="p">)</span>
    <span class="c1"># compute expansions</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Computing expansion locations...&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">computeExpansionLocations</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Player one expansion locations: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_ONE_EXPANSION_LOCATIONS</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Player two expansion locations: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_TWO_EXPANSION_LOCATIONS</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.findNextExpansion">
    <p>def <span class="ident">findNextExpansion</span>(</p><p>self, current, ccwDirection)</p>
    </div>
    

    
  
    <div class="desc"><p>Get the next expansion in a certain direction.</p>
<p>Only works on simple map. This is used in determining the expansions for
each bot on the map.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.findNextExpansion', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.findNextExpansion" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">findNextExpansion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">current</span><span class="p">:</span> <span class="n">Point2</span><span class="p">,</span> <span class="n">ccwDirection</span><span class="p">:</span> <span class="nb">bool</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get the next expansion in a certain direction.</span>
<span class="sd">    Only works on simple map. This is used in determining the expansions for</span>
<span class="sd">    each bot on the map.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">current</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">game_info</span><span class="o">.</span><span class="n">start_locations</span> <span class="o">+</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">game_info</span><span class="o">.</span><span class="n">player_start_location</span><span class="p">]:</span>
        <span class="c1"># first need to check if current is one of the start locations</span>
        <span class="c1"># &quot;corners of map&quot;</span>
        <span class="n">correspondingStartLocation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getCorrespondingStartLocation</span><span class="p">(</span><span class="n">current</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">correspondingStartLocation</span> <span class="o">==</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">UNKNOWN</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Could not find start location for &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">current</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">ccwDirection</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">correspondingStartLocation</span> <span class="o">==</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">BOTTOM_LEFT</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bottomExpansions</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># they are sorted from low to high x so this is fine</span>
            <span class="k">if</span> <span class="n">correspondingStartLocation</span> <span class="o">==</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">BOTTOM_RIGHT</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rightExpansions</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">correspondingStartLocation</span> <span class="o">==</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">TOP_RIGHT</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">topExpansions</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">topExpansions</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">correspondingStartLocation</span> <span class="o">==</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">TOP_LEFT</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">leftExpansions</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">leftExpansions</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># cw direction</span>
            <span class="k">if</span> <span class="n">correspondingStartLocation</span> <span class="o">==</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">BOTTOM_LEFT</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">leftExpansions</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">correspondingStartLocation</span> <span class="o">==</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">BOTTOM_RIGHT</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bottomExpansions</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bottomExpansions</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">correspondingStartLocation</span> <span class="o">==</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">TOP_RIGHT</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rightExpansions</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rightExpansions</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">correspondingStartLocation</span> <span class="o">==</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">TOP_LEFT</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">topExpansions</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># not in one of the corners</span>
        <span class="k">if</span> <span class="n">current</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bottomExpansions</span><span class="p">:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bottomExpansions</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">current</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ccwDirection</span><span class="p">:</span>
                <span class="c1"># go right</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bottomExpansions</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># go left</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bottomExpansions</span><span class="p">[</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">current</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rightExpansions</span><span class="p">:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rightExpansions</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">current</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ccwDirection</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rightExpansions</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rightExpansions</span><span class="p">[</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">current</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">topExpansions</span><span class="p">:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">topExpansions</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">current</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ccwDirection</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">topExpansions</span><span class="p">[</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">topExpansions</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">current</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">leftExpansions</span><span class="p">:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">leftExpansions</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">current</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ccwDirection</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">leftExpansions</span><span class="p">[</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">leftExpansions</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.find_placement">
    <p>def <span class="ident">find_placement</span>(</p><p>self, building, near, max_distance=20, random_alternative=True, placement_step=2, addon_place=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Finds a placement location for building.</p>
<p>Example::</p>
<div class="codehilite"><pre><span></span><span class="err">if self.townahlls:</span>
<span class="err">    cc = self.townhalls[0]</span>
<span class="err">    depot_position = await self.find_placement(UnitTypeId.SUPPLYDEPOT, near=cc)</span>
</pre></div>


<p>:param building:
:param near:
:param max_distance:
:param random_alternative:
:param placement_step:</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.find_placement', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.find_placement" class="source">
    <div class="codehilite"><pre><span></span><span class="k">async</span> <span class="k">def</span> <span class="nf">find_placement</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">building</span><span class="p">:</span> <span class="n">UnitTypeId</span><span class="p">,</span>
    <span class="n">near</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Unit</span><span class="p">,</span> <span class="n">Point2</span><span class="p">],</span>
    <span class="n">max_distance</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
    <span class="n">random_alternative</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">placement_step</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">addon_place</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Point2</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot; Finds a placement location for building.</span>
<span class="sd">    Example::</span>
<span class="sd">        if self.townahlls:</span>
<span class="sd">            cc = self.townhalls[0]</span>
<span class="sd">            depot_position = await self.find_placement(UnitTypeId.SUPPLYDEPOT, near=cc)</span>
<span class="sd">    :param building:</span>
<span class="sd">    :param near:</span>
<span class="sd">    :param max_distance:</span>
<span class="sd">    :param random_alternative:</span>
<span class="sd">    :param placement_step: &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">building</span><span class="p">,</span> <span class="p">(</span><span class="n">AbilityId</span><span class="p">,</span> <span class="n">UnitTypeId</span><span class="p">))</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">near</span><span class="p">,</span> <span class="n">Point2</span><span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">near</span><span class="si">}</span><span class="s2"> is no Point2 object&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">building</span><span class="p">,</span> <span class="n">UnitTypeId</span><span class="p">):</span>
        <span class="n">building</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_game_data</span><span class="o">.</span><span class="n">units</span><span class="p">[</span><span class="n">building</span><span class="o">.</span><span class="n">value</span><span class="p">]</span><span class="o">.</span><span class="n">creation_ability</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># AbilityId</span>
        <span class="n">building</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_game_data</span><span class="o">.</span><span class="n">abilities</span><span class="p">[</span><span class="n">building</span><span class="o">.</span><span class="n">value</span><span class="p">]</span>
    <span class="k">if</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">can_place</span><span class="p">(</span><span class="n">building</span><span class="p">,</span> <span class="n">near</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">addon_place</span> <span class="ow">or</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">can_place</span><span class="p">(</span><span class="n">UnitTypeId</span><span class="o">.</span><span class="n">SUPPLYDEPOT</span><span class="p">,</span> <span class="n">near</span><span class="o">.</span><span class="n">offset</span><span class="p">((</span><span class="mf">2.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">)))):</span>
        <span class="k">return</span> <span class="n">near</span>
    <span class="k">if</span> <span class="n">max_distance</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">for</span> <span class="n">distance</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">placement_step</span><span class="p">,</span> <span class="n">max_distance</span><span class="p">,</span> <span class="n">placement_step</span><span class="p">):</span>
        <span class="n">possible_positions</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">Point2</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">offset</span><span class="p">(</span><span class="n">near</span><span class="p">)</span><span class="o">.</span><span class="n">to2</span>
            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">(</span>
                <span class="p">[(</span><span class="n">dx</span><span class="p">,</span> <span class="o">-</span><span class="n">distance</span><span class="p">)</span> <span class="k">for</span> <span class="n">dx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="n">distance</span><span class="p">,</span> <span class="n">distance</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">placement_step</span><span class="p">)]</span>
                <span class="o">+</span> <span class="p">[(</span><span class="n">dx</span><span class="p">,</span> <span class="n">distance</span><span class="p">)</span> <span class="k">for</span> <span class="n">dx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="n">distance</span><span class="p">,</span> <span class="n">distance</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">placement_step</span><span class="p">)]</span>
                <span class="o">+</span> <span class="p">[(</span><span class="o">-</span><span class="n">distance</span><span class="p">,</span> <span class="n">dy</span><span class="p">)</span> <span class="k">for</span> <span class="n">dy</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="n">distance</span><span class="p">,</span> <span class="n">distance</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">placement_step</span><span class="p">)]</span>
                <span class="o">+</span> <span class="p">[(</span><span class="n">distance</span><span class="p">,</span> <span class="n">dy</span><span class="p">)</span> <span class="k">for</span> <span class="n">dy</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="n">distance</span><span class="p">,</span> <span class="n">distance</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">placement_step</span><span class="p">)]</span>
            <span class="p">)</span>
        <span class="p">]</span>
        <span class="n">res</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">query_building_placement</span><span class="p">(</span><span class="n">building</span><span class="p">,</span> <span class="n">possible_positions</span><span class="p">)</span>
        <span class="n">possible</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span> <span class="k">for</span> <span class="n">r</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">possible_positions</span><span class="p">)</span> <span class="k">if</span> <span class="n">r</span> <span class="o">==</span> <span class="n">ActionResult</span><span class="o">.</span><span class="n">Success</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">addon_place</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">query_building_placement</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_game_data</span><span class="o">.</span><span class="n">units</span><span class="p">[</span><span class="n">UnitTypeId</span><span class="o">.</span><span class="n">SUPPLYDEPOT</span><span class="o">.</span><span class="n">value</span><span class="p">]</span><span class="o">.</span><span class="n">creation_ability</span><span class="p">,</span>
                <span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">offset</span><span class="p">((</span><span class="mf">2.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">))</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">possible</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="n">possible</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span> <span class="k">for</span> <span class="n">r</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">possible</span><span class="p">)</span> <span class="k">if</span> <span class="n">r</span> <span class="o">==</span> <span class="n">ActionResult</span><span class="o">.</span><span class="n">Success</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">possible</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">random_alternative</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">possible</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="n">possible</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">p</span><span class="p">:</span> <span class="n">p</span><span class="o">.</span><span class="n">distance_to_point2</span><span class="p">(</span><span class="n">near</span><span class="p">))</span>
    <span class="k">return</span> <span class="kc">None</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.finishedCurrentTask">
    <p>def <span class="ident">finishedCurrentTask</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Advance buildlist by one task.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.finishedCurrentTask', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.finishedCurrentTask" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">finishedCurrentTask</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Advance buildlist by one task.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Finished task: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span> <span class="o">=</span> <span class="n">UnitTypeId</span><span class="o">.</span><span class="n">NOTAUNIT</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.getCorrespondingStartLocation">
    <p>def <span class="ident">getCorrespondingStartLocation</span>(</p><p>self, point)</p>
    </div>
    

    
  
    <div class="desc"><p>For a point get the start location.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.getCorrespondingStartLocation', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.getCorrespondingStartLocation" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">getCorrespondingStartLocation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">point</span><span class="p">:</span> <span class="n">Point2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;For a point get the start location.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mf">24.5</span><span class="p">):</span>
        <span class="c1"># left side of map</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mf">22.5</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">BOTTOM_LEFT</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">TOP_LEFT</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># right side of map</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mf">22.5</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">BOTTOM_RIGHT</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">TOP_RIGHT</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.getLocationFromStartLocation">
    <p>def <span class="ident">getLocationFromStartLocation</span>(</p><p>self, startLocation)</p>
    </div>
    

    
  
    <div class="desc"><p>Return the coordinates for a start location.</p>
<p>Counterpart to getCorrespondingStartLocation().</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.getLocationFromStartLocation', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.getLocationFromStartLocation" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">getLocationFromStartLocation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">startLocation</span><span class="p">:</span> <span class="n">StartLocation</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the coordinates for a start location.</span>
<span class="sd">    </span>
<span class="sd">    Counterpart to getCorrespondingStartLocation().</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">startLocation</span> <span class="o">==</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">BOTTOM_LEFT</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Point2</span><span class="p">((</span><span class="mf">24.5</span><span class="p">,</span> <span class="mf">22.5</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">startLocation</span> <span class="o">==</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">BOTTOM_RIGHT</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Point2</span><span class="p">((</span><span class="mf">127.5</span><span class="p">,</span> <span class="mf">22.5</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">startLocation</span> <span class="o">==</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">TOP_RIGHT</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Point2</span><span class="p">((</span><span class="mf">127.5</span><span class="p">,</span> <span class="mf">125.5</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">startLocation</span> <span class="o">==</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">TOP_LEFT</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Point2</span><span class="p">((</span><span class="mf">24.5</span><span class="p">,</span> <span class="mf">125.5</span><span class="p">))</span>
    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Location is not a start location! &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">startLocation</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.getProducerIdsForCurrentTask">
    <p>def <span class="ident">getProducerIdsForCurrentTask</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Get producer ids for current task.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.getProducerIdsForCurrentTask', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.getProducerIdsForCurrentTask" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">getProducerIdsForCurrentTask</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get producer ids for current task.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span> <span class="ow">in</span> <span class="n">UNIT_TRAINED_FROM</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">UNIT_TRAINED_FROM</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span><span class="p">]</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span> <span class="ow">in</span> <span class="n">BASE_BUILDINGS</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">BASE_BUILDINGS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; is not available in UNIT_TRAINED_FROM and not in BASE_BUILDINGS (only terran)!&quot;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.getProducerUnitsForCurrentTask">
    <p>def <span class="ident">getProducerUnitsForCurrentTask</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Get the units (actual units in the game) that could produce the current task.</p>
<p>Does not check if these units are busy.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.getProducerUnitsForCurrentTask', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.getProducerUnitsForCurrentTask" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">getProducerUnitsForCurrentTask</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get the units (actual units in the game) that could produce the current task.</span>
<span class="sd">    Does not check if these units are busy.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">producerIds</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="n">UnitTypeId</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getProducerIdsForCurrentTask</span><span class="p">()</span>
    <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">structures</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">unit</span><span class="p">:</span> <span class="n">unit</span><span class="o">.</span><span class="n">type_id</span> <span class="ow">in</span> <span class="n">producerIds</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.getWorker">
    <p>def <span class="ident">getWorker</span>(</p><p>self, position)</p>
    </div>
    

    
  
    <div class="desc"><p>Get a worker closest to a certain point on the map.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.getWorker', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.getWorker" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">getWorker</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Unit</span><span class="p">,</span> <span class="n">Point2</span><span class="p">,</span> <span class="n">Point3</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;Get a worker closest to a certain point on the map.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">workersGathering</span><span class="p">:</span> <span class="n">Units</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">workers</span><span class="o">.</span><span class="n">gathering</span>
    <span class="k">if</span> <span class="n">workersGathering</span><span class="p">:</span>
        <span class="c1"># select worker closest to pos or unit</span>
        <span class="k">return</span> <span class="n">workersGathering</span><span class="o">.</span><span class="n">closest_to</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;There are no gathering workers which could be used to build &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.get_available_abilities">
    <p>def <span class="ident">get_available_abilities</span>(</p><p>self, units, ignore_resource_requirements=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns available abilities of one or more units. Right now only checks cooldown, energy cost, and whether the ability has been researched.</p>
<p>Examples::</p>
<div class="codehilite"><pre><span></span><span class="err">units_abilities = await self.get_available_abilities(self.units)</span>
</pre></div>


<p>or::</p>
<div class="codehilite"><pre><span></span><span class="err">units_abilities = await self.get_available_abilities([self.units.random])</span>
</pre></div>


<p>:param units:
:param ignore_resource_requirements:</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.get_available_abilities', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.get_available_abilities" class="source">
    <div class="codehilite"><pre><span></span><span class="k">async</span> <span class="k">def</span> <span class="nf">get_available_abilities</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">units</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Unit</span><span class="p">],</span> <span class="n">Units</span><span class="p">],</span> <span class="n">ignore_resource_requirements</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">AbilityId</span><span class="p">]]:</span>
    <span class="sd">&quot;&quot;&quot; Returns available abilities of one or more units. Right now only checks cooldown, energy cost, and whether the ability has been researched.</span>
<span class="sd">    Examples::</span>
<span class="sd">        units_abilities = await self.get_available_abilities(self.units)</span>
<span class="sd">    or::</span>
<span class="sd">        units_abilities = await self.get_available_abilities([self.units.random])</span>
<span class="sd">    :param units:</span>
<span class="sd">    :param ignore_resource_requirements: &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">query_available_abilities</span><span class="p">(</span><span class="n">units</span><span class="p">,</span> <span class="n">ignore_resource_requirements</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.get_next_expansion">
    <p>def <span class="ident">get_next_expansion</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Find next expansion location.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.get_next_expansion', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.get_next_expansion" class="source">
    <div class="codehilite"><pre><span></span><span class="k">async</span> <span class="k">def</span> <span class="nf">get_next_expansion</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Point2</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Find next expansion location.&quot;&quot;&quot;</span>
    <span class="n">closest</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">distance</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">inf</span>
    <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">expansion_locations_list</span><span class="p">:</span>
        <span class="k">def</span> <span class="nf">is_near_to_expansion</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">t</span><span class="o">.</span><span class="n">distance_to</span><span class="p">(</span><span class="n">el</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">EXPANSION_GAP_THRESHOLD</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">is_near_to_expansion</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">townhalls</span><span class="p">)):</span>
            <span class="c1"># already taken</span>
            <span class="k">continue</span>
        <span class="n">startp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_game_info</span><span class="o">.</span><span class="n">player_start_location</span>
        <span class="n">d</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">query_pathing</span><span class="p">(</span><span class="n">startp</span><span class="p">,</span> <span class="n">el</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">d</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">d</span> <span class="o">&lt;</span> <span class="n">distance</span><span class="p">:</span>
            <span class="n">distance</span> <span class="o">=</span> <span class="n">d</span>
            <span class="n">closest</span> <span class="o">=</span> <span class="n">el</span>
    <span class="k">return</span> <span class="n">closest</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.get_terrain_height">
    <p>def <span class="ident">get_terrain_height</span>(</p><p>self, pos)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns terrain height at a position.
Caution: terrain height is different from a unit's z-coordinate.</p>
<p>:param pos:</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.get_terrain_height', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.get_terrain_height" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_terrain_height</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Point2</span><span class="p">,</span> <span class="n">Unit</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot; Returns terrain height at a position.</span>
<span class="sd">    Caution: terrain height is different from a unit&#39;s z-coordinate.</span>
<span class="sd">    :param pos: &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="p">(</span><span class="n">Point2</span><span class="p">,</span> <span class="n">Unit</span><span class="p">)),</span> <span class="sa">f</span><span class="s2">&quot;pos is not of type Point2 or Unit&quot;</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="n">pos</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">rounded</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_game_info</span><span class="o">.</span><span class="n">terrain_height</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.get_terrain_z_height">
    <p>def <span class="ident">get_terrain_z_height</span>(</p><p>self, pos)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns terrain z-height at a position.</p>
<p>:param pos:</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.get_terrain_z_height', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.get_terrain_z_height" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_terrain_z_height</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Point2</span><span class="p">,</span> <span class="n">Unit</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot; Returns terrain z-height at a position.</span>
<span class="sd">    :param pos: &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="p">(</span><span class="n">Point2</span><span class="p">,</span> <span class="n">Unit</span><span class="p">)),</span> <span class="sa">f</span><span class="s2">&quot;pos is not of type Point2 or Unit&quot;</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="n">pos</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">rounded</span>
    <span class="k">return</span> <span class="o">-</span><span class="mi">16</span> <span class="o">+</span> <span class="mi">32</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_game_info</span><span class="o">.</span><span class="n">terrain_height</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">/</span> <span class="mi">255</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.has_creep">
    <p>def <span class="ident">has_creep</span>(</p><p>self, pos)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns True if there is creep on the grid point.</p>
<p>:param pos:</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.has_creep', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.has_creep" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">has_creep</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Point2</span><span class="p">,</span> <span class="n">Unit</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot; Returns True if there is creep on the grid point.</span>
<span class="sd">    :param pos: &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="p">(</span><span class="n">Point2</span><span class="p">,</span> <span class="n">Unit</span><span class="p">)),</span> <span class="sa">f</span><span class="s2">&quot;pos is not of type Point2 or Unit&quot;</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="n">pos</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">to2</span><span class="o">.</span><span class="n">rounded</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">creep</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.in_map_bounds">
    <p>def <span class="ident">in_map_bounds</span>(</p><p>self, pos)</p>
    </div>
    

    
  
    <div class="desc"><p>Tests if a 2 dimensional point is within the map boundaries of the pixelmaps.
:param pos:</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.in_map_bounds', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.in_map_bounds" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">in_map_bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Point2</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot; Tests if a 2 dimensional point is within the map boundaries of the pixelmaps.</span>
<span class="sd">    :param pos: &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_game_info</span><span class="o">.</span><span class="n">playable_area</span><span class="o">.</span><span class="n">x</span>
        <span class="o">&lt;=</span> <span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_game_info</span><span class="o">.</span><span class="n">playable_area</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">game_info</span><span class="o">.</span><span class="n">playable_area</span><span class="o">.</span><span class="n">width</span>
        <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_game_info</span><span class="o">.</span><span class="n">playable_area</span><span class="o">.</span><span class="n">y</span>
        <span class="o">&lt;=</span> <span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_game_info</span><span class="o">.</span><span class="n">playable_area</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">game_info</span><span class="o">.</span><span class="n">playable_area</span><span class="o">.</span><span class="n">height</span>
    <span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.in_pathing_grid">
    <p>def <span class="ident">in_pathing_grid</span>(</p><p>self, pos)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns True if a ground unit can pass through a grid point.</p>
<p>:param pos:</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.in_pathing_grid', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.in_pathing_grid" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">in_pathing_grid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Point2</span><span class="p">,</span> <span class="n">Unit</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot; Returns True if a ground unit can pass through a grid point.</span>
<span class="sd">    :param pos: &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="p">(</span><span class="n">Point2</span><span class="p">,</span> <span class="n">Unit</span><span class="p">)),</span> <span class="sa">f</span><span class="s2">&quot;pos is not of type Point2 or Unit&quot;</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="n">pos</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">to2</span><span class="o">.</span><span class="n">rounded</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_game_info</span><span class="o">.</span><span class="n">pathing_grid</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.in_placement_grid">
    <p>def <span class="ident">in_placement_grid</span>(</p><p>self, pos)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns True if you can place something at a position.
Remember, buildings usually use 2x2, 3x3 or 5x5 of these grid points.
Caution: some x and y offset might be required, see ramp code in game_info.py</p>
<p>:param pos:</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.in_placement_grid', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.in_placement_grid" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">in_placement_grid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Point2</span><span class="p">,</span> <span class="n">Unit</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot; Returns True if you can place something at a position.</span>
<span class="sd">    Remember, buildings usually use 2x2, 3x3 or 5x5 of these grid points.</span>
<span class="sd">    Caution: some x and y offset might be required, see ramp code in game_info.py</span>
<span class="sd">    :param pos: &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="p">(</span><span class="n">Point2</span><span class="p">,</span> <span class="n">Unit</span><span class="p">)),</span> <span class="sa">f</span><span class="s2">&quot;pos is not of type Point2 or Unit&quot;</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="n">pos</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">rounded</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_game_info</span><span class="o">.</span><span class="n">placement_grid</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.isWorker">
    <p>def <span class="ident">isWorker</span>(</p><p>self, unitId)</p>
    </div>
    

    
  
    <div class="desc"><p>Checks if a certain unit is a worker.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.isWorker', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.isWorker" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">isWorker</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unitId</span><span class="p">:</span> <span class="n">UnitTypeId</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Checks if a certain unit is a worker.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">race_worker</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">race</span><span class="p">]</span> <span class="o">==</span> <span class="n">unitId</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.is_visible">
    <p>def <span class="ident">is_visible</span>(</p><p>self, pos)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns True if you have vision on a grid point.</p>
<p>:param pos:</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.is_visible', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.is_visible" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">is_visible</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Point2</span><span class="p">,</span> <span class="n">Unit</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot; Returns True if you have vision on a grid point.</span>
<span class="sd">    :param pos: &quot;&quot;&quot;</span>
    <span class="c1"># more info: https://github.com/Blizzard/s2client-proto/blob/9906df71d6909511907d8419b33acc1a3bd51ec0/s2clientprotocol/spatial.proto#L19</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="p">(</span><span class="n">Point2</span><span class="p">,</span> <span class="n">Unit</span><span class="p">)),</span> <span class="sa">f</span><span class="s2">&quot;pos is not of type Point2 or Unit&quot;</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="n">pos</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">to2</span><span class="o">.</span><span class="n">rounded</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">visibility</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.issue_events">
    <p>def <span class="ident">issue_events</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>This function will be automatically run from main.py and triggers the following functions:
- on_unit_created
- on_unit_destroyed
- on_building_construction_started
- on_building_construction_complete
- on_upgrade_complete</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.issue_events', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.issue_events" class="source">
    <div class="codehilite"><pre><span></span><span class="k">async</span> <span class="k">def</span> <span class="nf">issue_events</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; This function will be automatically run from main.py and triggers the following functions:</span>
<span class="sd">    - on_unit_created</span>
<span class="sd">    - on_unit_destroyed</span>
<span class="sd">    - on_building_construction_started</span>
<span class="sd">    - on_building_construction_complete</span>
<span class="sd">    - on_upgrade_complete</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_issue_unit_dead_events</span><span class="p">()</span>
    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_issue_unit_added_events</span><span class="p">()</span>
    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_issue_building_events</span><span class="p">()</span>
    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_issue_upgrade_events</span><span class="p">()</span>
    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_issue_vision_events</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.myWorkerDistribution">
    <p>def <span class="ident">myWorkerDistribution</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Redistributes workers to geysers and mineral fields.</p>
<p>Redistributes:
    - idle workers
    - surplus on townhalls/geysers</p>
<p>Taken from https://github.com/BurnySc2/python-sc2/blob/develop/examples/terran/mass_reaper.py and modified.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.myWorkerDistribution', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.myWorkerDistribution" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">myWorkerDistribution</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Redistributes workers to geysers and mineral fields.</span>
<span class="sd">    </span>
<span class="sd">    Redistributes:</span>
<span class="sd">        - idle workers</span>
<span class="sd">        - surplus on townhalls/geysers</span>
<span class="sd">    Taken from https://github.com/BurnySc2/python-sc2/blob/develop/examples/terran/mass_reaper.py and modified.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mineralTags</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">tag</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mineral_field</span><span class="p">]</span>
    <span class="n">gas_buildingTags</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">tag</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_buildings</span><span class="p">]</span>
    <span class="n">workerPool</span> <span class="o">=</span> <span class="n">Units</span><span class="p">([],</span> <span class="bp">self</span><span class="p">)</span>
    <span class="n">workerPoolTags</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="c1"># # Find all gas_buildings that have surplus or deficit</span>
    <span class="n">deficit_gas_buildings</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">surplusgas_buildings</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_buildings</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">vespene_contents</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
        <span class="c1"># Only loop over gas_buildings that have still gas in them</span>
        <span class="n">deficit</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">ideal_harvesters</span> <span class="o">-</span> <span class="n">g</span><span class="o">.</span><span class="n">assigned_harvesters</span>
        <span class="k">if</span> <span class="n">deficit</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">deficit_gas_buildings</span><span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">tag</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;unit&quot;</span><span class="p">:</span> <span class="n">g</span><span class="p">,</span> <span class="s2">&quot;deficit&quot;</span><span class="p">:</span> <span class="n">deficit</span><span class="p">}</span>
        <span class="k">elif</span> <span class="n">deficit</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">surplusWorkers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">workers</span><span class="o">.</span><span class="n">closer_than</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">w</span><span class="p">:</span> <span class="n">w</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">workerPoolTags</span>
                <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">orders</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
                <span class="ow">and</span> <span class="n">w</span><span class="o">.</span><span class="n">orders</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">ability</span><span class="o">.</span><span class="n">id</span> <span class="ow">in</span> <span class="p">[</span><span class="n">AbilityId</span><span class="o">.</span><span class="n">HARVEST_GATHER</span><span class="p">]</span>
                <span class="ow">and</span> <span class="n">w</span><span class="o">.</span><span class="n">orders</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">target</span> <span class="ow">in</span> <span class="n">gas_buildingTags</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="n">deficit</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">surplusWorkers</span><span class="o">.</span><span class="n">amount</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">w</span> <span class="o">=</span> <span class="n">surplusWorkers</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                    <span class="n">workerPool</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
                    <span class="n">workerPoolTags</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">tag</span><span class="p">)</span>
            <span class="n">surplusgas_buildings</span><span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">tag</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;unit&quot;</span><span class="p">:</span> <span class="n">g</span><span class="p">,</span> <span class="s2">&quot;deficit&quot;</span><span class="p">:</span> <span class="n">deficit</span><span class="p">}</span>
    <span class="c1"># # Find all townhalls that have surplus or deficit</span>
    <span class="n">deficitTownhalls</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">surplusTownhalls</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">th</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">townhalls</span><span class="p">:</span>
        <span class="n">deficit</span> <span class="o">=</span> <span class="n">th</span><span class="o">.</span><span class="n">ideal_harvesters</span> <span class="o">-</span> <span class="n">th</span><span class="o">.</span><span class="n">assigned_harvesters</span>
        <span class="k">if</span> <span class="n">deficit</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">deficitTownhalls</span><span class="p">[</span><span class="n">th</span><span class="o">.</span><span class="n">tag</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;unit&quot;</span><span class="p">:</span> <span class="n">th</span><span class="p">,</span> <span class="s2">&quot;deficit&quot;</span><span class="p">:</span> <span class="n">deficit</span><span class="p">}</span>
        <span class="k">elif</span> <span class="n">deficit</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">surplusWorkers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">workers</span><span class="o">.</span><span class="n">closer_than</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">th</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">w</span><span class="p">:</span> <span class="n">w</span><span class="o">.</span><span class="n">tag</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">workerPoolTags</span>
                <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">orders</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
                <span class="ow">and</span> <span class="n">w</span><span class="o">.</span><span class="n">orders</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">ability</span><span class="o">.</span><span class="n">id</span> <span class="ow">in</span> <span class="p">[</span><span class="n">AbilityId</span><span class="o">.</span><span class="n">HARVEST_GATHER</span><span class="p">]</span>
                <span class="ow">and</span> <span class="n">w</span><span class="o">.</span><span class="n">orders</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">target</span> <span class="ow">in</span> <span class="n">mineralTags</span>
            <span class="p">)</span>
            <span class="c1"># workerPool.extend(surplusWorkers)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="n">deficit</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">surplusWorkers</span><span class="o">.</span><span class="n">amount</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">w</span> <span class="o">=</span> <span class="n">surplusWorkers</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                    <span class="n">workerPool</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
                    <span class="n">workerPoolTags</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">tag</span><span class="p">)</span>
            <span class="n">surplusTownhalls</span><span class="p">[</span><span class="n">th</span><span class="o">.</span><span class="n">tag</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;unit&quot;</span><span class="p">:</span> <span class="n">th</span><span class="p">,</span> <span class="s2">&quot;deficit&quot;</span><span class="p">:</span> <span class="n">deficit</span><span class="p">}</span>
    
    <span class="c1"># ---------------------------------------------</span>
    <span class="c1"># We now know which building has a deficit and which one has a surplus. If a building has a surplus</span>
    <span class="c1"># the workers are added to the worker pool. Whenever we have anything in the worker pool we want to</span>
    <span class="c1"># distribute those first.</span>
    <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="n">workerPool</span><span class="p">):</span>
        <span class="c1"># iterate deficit townhalls</span>
        <span class="k">for</span> <span class="n">townhallTag</span><span class="p">,</span> <span class="n">info</span> <span class="ow">in</span> <span class="n">deficitTownhalls</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="c1"># get the minerals close to the current townhall</span>
            <span class="n">mineralFields</span><span class="p">:</span> <span class="n">Units</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mineral_field</span><span class="o">.</span><span class="n">closer_than</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">info</span><span class="p">[</span><span class="s2">&quot;unit&quot;</span><span class="p">])</span>
            <span class="c1"># if there are any</span>
            <span class="k">if</span> <span class="n">mineralFields</span><span class="p">:</span>
                <span class="c1"># get the deficit (missing worker to optimal performance)</span>
                <span class="n">deficit</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="s2">&quot;deficit&quot;</span><span class="p">]</span>
                <span class="c1"># check if the worker pool does contain anything</span>
                <span class="n">workersLeft</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">workerPool</span><span class="p">)</span>
                <span class="c1"># if there is a deficit move one worker to the townhall from the worker pool</span>
                <span class="k">if</span> <span class="n">deficit</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">workersLeft</span><span class="p">:</span>
                    <span class="n">worker</span><span class="p">:</span> <span class="n">Unit</span> <span class="o">=</span> <span class="n">workerPool</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                    <span class="n">mineralField</span><span class="p">:</span> <span class="n">Unit</span> <span class="o">=</span> <span class="n">mineralFields</span><span class="o">.</span><span class="n">closest_to</span><span class="p">(</span><span class="n">worker</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Moving one worker to harvest minerals at &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;unit&quot;</span><span class="p">]))</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">worker</span><span class="o">.</span><span class="n">orders</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">worker</span><span class="o">.</span><span class="n">orders</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">ability</span><span class="o">.</span><span class="n">id</span> <span class="ow">in</span> <span class="p">[</span><span class="n">AbilityId</span><span class="o">.</span><span class="n">HARVEST_RETURN</span><span class="p">]:</span>
                        <span class="n">worker</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="n">mineralField</span><span class="p">,</span> <span class="n">queue</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">worker</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="n">mineralField</span><span class="p">)</span>
        <span class="c1"># iterate deficit gas buildings</span>
        <span class="k">for</span> <span class="n">gasTag</span><span class="p">,</span> <span class="n">info</span> <span class="ow">in</span> <span class="n">deficit_gas_buildings</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="c1"># get the deficit (missing worker to optimal performance)</span>
            <span class="n">deficit</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="s2">&quot;deficit&quot;</span><span class="p">]</span>
            <span class="c1"># check if the worker pool does contain anything</span>
            <span class="n">workersLeft</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">workerPool</span><span class="p">)</span>
            <span class="c1"># if there is a deficit move one worker to the townhall from the worker pool</span>
            <span class="k">if</span> <span class="n">deficit</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">workersLeft</span><span class="p">:</span>
                <span class="n">worker</span><span class="p">:</span> <span class="n">Unit</span> <span class="o">=</span> <span class="n">workerPool</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Moving one worker to harvest gas at &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;unit&quot;</span><span class="p">]))</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">worker</span><span class="o">.</span><span class="n">orders</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">worker</span><span class="o">.</span><span class="n">orders</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">ability</span><span class="o">.</span><span class="n">id</span> <span class="ow">in</span> <span class="p">[</span><span class="n">AbilityId</span><span class="o">.</span><span class="n">HARVEST_RETURN</span><span class="p">]:</span>
                    <span class="n">worker</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;unit&quot;</span><span class="p">],</span> <span class="n">queue</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">worker</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;unit&quot;</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Whenever we do not have worker in the worker pool we want to move some workers to harvest gas but only if a certain ratio between</span>
        <span class="c1"># total vespene workers and total mineral workers is not exceeded.</span>
        <span class="n">totalMineralWorkers</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">totalVespeneWorkers</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">townhall</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">townhalls</span><span class="o">.</span><span class="n">ready</span><span class="p">:</span>
            <span class="n">totalMineralWorkers</span> <span class="o">+=</span> <span class="n">townhall</span><span class="o">.</span><span class="n">assigned_harvesters</span>
        <span class="k">for</span> <span class="n">gasBuilding</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_buildings</span><span class="o">.</span><span class="n">ready</span><span class="p">:</span>
            <span class="n">totalVespeneWorkers</span> <span class="o">+=</span> <span class="n">gasBuilding</span><span class="o">.</span><span class="n">assigned_harvesters</span>
        <span class="c1"># only if less than 33% workers are on vespene</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">totalVespeneWorkers</span> <span class="o">/</span> <span class="p">(</span><span class="n">totalMineralWorkers</span> <span class="o">+</span> <span class="n">totalVespeneWorkers</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mf">0.34</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">gasTag</span><span class="p">,</span> <span class="n">info</span> <span class="ow">in</span> <span class="n">deficit_gas_buildings</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">worker</span><span class="p">:</span> <span class="n">Unit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">workers</span><span class="o">.</span><span class="n">gathering</span><span class="o">.</span><span class="n">closest_to</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;unit&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">position</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Moving one worker to &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;unit&quot;</span><span class="p">]))</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">worker</span><span class="o">.</span><span class="n">orders</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">worker</span><span class="o">.</span><span class="n">orders</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">ability</span><span class="o">.</span><span class="n">id</span> <span class="ow">in</span> <span class="p">[</span><span class="n">AbilityId</span><span class="o">.</span><span class="n">HARVEST_RETURN</span><span class="p">]:</span>
                    <span class="n">worker</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;unit&quot;</span><span class="p">],</span> <span class="n">queue</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">worker</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;unit&quot;</span><span class="p">])</span>
    
    <span class="c1"># redistribute idle workers</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workers</span><span class="o">.</span><span class="n">idle</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">townhalls</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">worker</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">workers</span><span class="o">.</span><span class="n">idle</span><span class="p">:</span>
                <span class="n">townhall</span><span class="p">:</span> <span class="n">Unit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">townhalls</span><span class="o">.</span><span class="n">closest_to</span><span class="p">(</span><span class="n">worker</span><span class="p">)</span>
                <span class="n">mineralFields</span><span class="p">:</span> <span class="n">Units</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mineral_field</span><span class="o">.</span><span class="n">closer_than</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">townhall</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">mineralFields</span><span class="p">:</span>
                    <span class="n">mineralField</span><span class="p">:</span> <span class="n">Unit</span> <span class="o">=</span> <span class="n">mineralFields</span><span class="o">.</span><span class="n">closest_to</span><span class="p">(</span><span class="n">worker</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Moving one worker to harvest minerals at &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">mineralField</span><span class="p">))</span>
                    <span class="n">worker</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="n">mineralField</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.onStartBase">
    <p>def <span class="ident">onStartBase</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Call this from implementing bot in on_start().</p>
<p>startup routine. Should prepare:
   - enemy location 
   - scan the buildlist</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.onStartBase', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.onStartBase" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">onStartBase</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Call this from implementing bot in on_start().</span>
<span class="sd">    startup routine. Should prepare:</span>
<span class="sd">       - enemy location </span>
<span class="sd">       - scan the buildlist</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setSelfStartLocation</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Available start locations: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game_info</span><span class="o">.</span><span class="n">start_locations</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">scanBuildList</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">prepareBuildListCompletedCheck</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.onStepBase">
    <p>def <span class="ident">onStepBase</span>(</p><p>self, iteration)</p>
    </div>
    

    
  
    <div class="desc"><p>Neeeds to be called from race specific bot.</p>
<p>Finishes the preprocessing that could not be done in on_start.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.onStepBase', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.onStepBase" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">onStepBase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">iteration</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Neeeds to be called from race specific bot.</span>
<span class="sd">    Finishes the preprocessing that could not be done in on_start.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">expansionLocationsComputed</span><span class="p">:</span>
        <span class="c1"># player one will compute for both</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span> <span class="o">==</span> <span class="n">Player</span><span class="o">.</span><span class="n">PLAYER_ONE</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_TWO_START_LOCATION</span> <span class="o">!=</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">UNKNOWN</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fillExpansionLocations</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">expansionLocationsComputed</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Expansion locations computed at iteration: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">iteration</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">expansionLocations</span> <span class="o">=</span> <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_ONE_EXPANSION_LOCATIONS</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_TWO_EXPANSION_LOCATIONS</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Expansion locations available at iteration: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">iteration</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">expansionLocations</span> <span class="o">=</span> <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_TWO_EXPANSION_LOCATIONS</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">expansionLocationsComputed</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="c1"># it is important do to this b4 checking and advancing</span>
    <span class="c1"># because orders will be processed after one step is finished</span>
    <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">attacking</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBuildListCompleted</span><span class="p">():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;All tasks in buildlist are finished and ready to fight!&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span> <span class="o">==</span> <span class="n">Player</span><span class="o">.</span><span class="n">PLAYER_ONE</span><span class="p">:</span>
            <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_ONE_READY_TO_ATTACK</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_TWO_READY_TO_ATTACK</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attacking</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_TWO_READY_TO_ATTACK</span> <span class="ow">and</span> <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_ONE_READY_TO_ATTACK</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">attackDone</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Attacking the map center with all available units!&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attackMapCenterWithArmy</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attackDone</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">attackDone</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span> <span class="o">==</span> <span class="n">Player</span><span class="o">.</span><span class="n">PLAYER_ONE</span><span class="p">:</span>
            <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_ONE_ARMY_COUNT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">army_count</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_TWO_ARMY_COUNT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">army_count</span>
    
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span> <span class="o">==</span> <span class="n">Player</span><span class="o">.</span><span class="n">PLAYER_ONE</span> <span class="ow">and</span> <span class="p">(</span><span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_ONE_ARMY_COUNT</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_TWO_ARMY_COUNT</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_ONE_ARMY_COUNT</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_TWO_ARMY_COUNT</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Its a tie!&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_ONE_ARMY_COUNT</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Player two won the match!&quot;</span><span class="p">)</span>
            <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">WINNER</span> <span class="o">=</span> <span class="n">Winner</span><span class="o">.</span><span class="n">PLAYER_TWO</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Player one won the match!&quot;</span><span class="p">)</span>
            <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">WINNER</span> <span class="o">=</span> <span class="n">Winner</span><span class="o">.</span><span class="n">PLAYER_ONE</span>
    <span class="k">if</span> <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">WINNER</span> <span class="o">!=</span> <span class="n">Winner</span><span class="o">.</span><span class="n">UNKNOWN</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span> <span class="o">==</span> <span class="n">Player</span><span class="o">.</span><span class="n">PLAYER_ONE</span> <span class="ow">and</span> <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">WINNER</span> <span class="o">==</span> <span class="n">Winner</span><span class="o">.</span><span class="n">PLAYER_TWO</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Player one should surrender now!&quot;</span><span class="p">)</span>
            <span class="c1">#self.client.leave()</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Player one lost the game and surrendered!&quot;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span> <span class="o">==</span> <span class="n">Player</span><span class="o">.</span><span class="n">PLAYER_TWO</span> <span class="ow">and</span> <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">WINNER</span> <span class="o">==</span> <span class="n">Winner</span><span class="o">.</span><span class="n">PLAYER_ONE</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Player two should surrender now!&quot;</span><span class="p">)</span>
            <span class="c1">#self.client.leave()</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Player two lost the game and surrendered!&quot;</span><span class="p">)</span>
        
    
    <span class="bp">self</span><span class="o">.</span><span class="n">checkAndAdvance</span><span class="p">()</span>
    
    <span class="c1"># distribute workers</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">myWorkerDistribution</span><span class="p">()</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">expansionLocationsComputed</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">done</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.on_before_start">
    <p>def <span class="ident">on_before_start</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Override this in your bot class. This function is called before "on_start"
and before "prepare_first_step" that calculates expansion locations.
Not all data is available yet.
This function is useful in realtime=True mode to split your workers or start producing the first worker.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.on_before_start', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.on_before_start" class="source">
    <div class="codehilite"><pre><span></span><span class="k">async</span> <span class="k">def</span> <span class="nf">on_before_start</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Override this in your bot class. This function is called before &quot;on_start&quot;</span>
<span class="sd">    and before &quot;prepare_first_step&quot; that calculates expansion locations.</span>
<span class="sd">    Not all data is available yet.</span>
<span class="sd">    This function is useful in realtime=True mode to split your workers or start producing the first worker.</span>
<span class="sd">    &quot;&quot;&quot;</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.on_building_construction_complete">
    <p>def <span class="ident">on_building_construction_complete</span>(</p><p>self, unit)</p>
    </div>
    

    
  
    <div class="desc"><p>When building is completed store that for later checks.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.on_building_construction_complete', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.on_building_construction_complete" class="source">
    <div class="codehilite"><pre><span></span><span class="k">async</span> <span class="k">def</span> <span class="nf">on_building_construction_complete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unit</span><span class="p">:</span> <span class="n">Unit</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;When building is completed store that for later checks.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">raceSpecificStructureCompletedIgnore</span><span class="p">(</span><span class="n">unit</span><span class="o">.</span><span class="n">type_id</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Structure &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">unit</span><span class="o">.</span><span class="n">type_id</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; completed!&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remainingBuildTasks</span><span class="p">[</span><span class="n">unit</span><span class="o">.</span><span class="n">type_id</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.on_building_construction_started">
    <p>def <span class="ident">on_building_construction_started</span>(</p><p>self, unit)</p>
    </div>
    

    
  
    <div class="desc"><p>Override this in your bot class.
This function is called when a building construction has started.</p>
<p>:param unit:</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.on_building_construction_started', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.on_building_construction_started" class="source">
    <div class="codehilite"><pre><span></span><span class="k">async</span> <span class="k">def</span> <span class="nf">on_building_construction_started</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unit</span><span class="p">:</span> <span class="n">Unit</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Override this in your bot class.</span>
<span class="sd">    This function is called when a building construction has started.</span>
<span class="sd">    :param unit:</span>
<span class="sd">    &quot;&quot;&quot;</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.on_end">
    <p>def <span class="ident">on_end</span>(</p><p>self, game_result)</p>
    </div>
    

    
  
    <div class="desc"><p>Override this in your bot class. This function is called at the end of a game.
Unsure if this function will be called on the laddermanager client as the bot process may forcefully be terminated.</p>
<p>:param game_result:</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.on_end', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.on_end" class="source">
    <div class="codehilite"><pre><span></span><span class="k">async</span> <span class="k">def</span> <span class="nf">on_end</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">game_result</span><span class="p">:</span> <span class="n">Result</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Override this in your bot class. This function is called at the end of a game.</span>
<span class="sd">    Unsure if this function will be called on the laddermanager client as the bot process may forcefully be terminated.</span>
<span class="sd">    :param game_result: &quot;&quot;&quot;</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.on_enemy_unit_entered_vision">
    <p>def <span class="ident">on_enemy_unit_entered_vision</span>(</p><p>self, unit)</p>
    </div>
    

    
  
    <div class="desc"><p>Override this in your bot class. This function is called when an enemy unit (unit or structure) entered vision (which was not visible last frame).</p>
<p>:param unit:</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.on_enemy_unit_entered_vision', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.on_enemy_unit_entered_vision" class="source">
    <div class="codehilite"><pre><span></span><span class="k">async</span> <span class="k">def</span> <span class="nf">on_enemy_unit_entered_vision</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unit</span><span class="p">:</span> <span class="n">Unit</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Override this in your bot class. This function is called when an enemy unit (unit or structure) entered vision (which was not visible last frame).</span>
<span class="sd">    :param unit:</span>
<span class="sd">    &quot;&quot;&quot;</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.on_enemy_unit_left_vision">
    <p>def <span class="ident">on_enemy_unit_left_vision</span>(</p><p>self, unit_tag)</p>
    </div>
    

    
  
    <div class="desc"><p>Override this in your bot class. This function is called when an enemy unit (unit or structure) left vision (which was visible last frame).
Same as the self.on_unit_destroyed event, this function is called with the unit's tag because the unit is no longer visible anymore.
If you want to store a snapshot of the unit, use self._enemy_units_previous_map[unit_tag] for units or self._enemy_structures_previous_map[unit_tag] for structures.</p>
<p>Examples::</p>
<div class="codehilite"><pre><span></span><span class="n">last_known_unit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_enemy_units_previous_map</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="n">unit_tag</span><span class="p">,</span><span class="w"> </span><span class="k">None</span><span class="p">)</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_enemy_structures_previous_map</span><span class="o">[</span><span class="n">unit_tag</span><span class="o">]</span><span class="w"></span>
<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;Enemy unit left vision, last known location: {last_known_unit.position}&quot;</span><span class="p">)</span><span class="w"></span>
</pre></div>


<p>:param unit_tag:</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.on_enemy_unit_left_vision', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.on_enemy_unit_left_vision" class="source">
    <div class="codehilite"><pre><span></span><span class="k">async</span> <span class="k">def</span> <span class="nf">on_enemy_unit_left_vision</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unit_tag</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Override this in your bot class. This function is called when an enemy unit (unit or structure) left vision (which was visible last frame).</span>
<span class="sd">    Same as the self.on_unit_destroyed event, this function is called with the unit&#39;s tag because the unit is no longer visible anymore.</span>
<span class="sd">    If you want to store a snapshot of the unit, use self._enemy_units_previous_map[unit_tag] for units or self._enemy_structures_previous_map[unit_tag] for structures.</span>
<span class="sd">    Examples::</span>
<span class="sd">        last_known_unit = self._enemy_units_previous_map.get(unit_tag, None) or self._enemy_structures_previous_map[unit_tag]</span>
<span class="sd">        print(f&quot;Enemy unit left vision, last known location: {last_known_unit.position}&quot;)</span>
<span class="sd">    :param unit_tag:</span>
<span class="sd">    &quot;&quot;&quot;</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.on_start">
    <p>def <span class="ident">on_start</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Override this in your bot class.
At this point, game_data, game_info and the first iteration of game_state (self.state) are available.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.on_start', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.on_start" class="source">
    <div class="codehilite"><pre><span></span><span class="k">async</span> <span class="k">def</span> <span class="nf">on_start</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Override this in your bot class.</span>
<span class="sd">    At this point, game_data, game_info and the first iteration of game_state (self.state) are available.</span>
<span class="sd">    &quot;&quot;&quot;</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.on_step">
    <p>def <span class="ident">on_step</span>(</p><p>self, iteration)</p>
    </div>
    

    
  
    <div class="desc"><p>You need to implement this function!
Override this in your bot class.
This function is called on every game step (looped in realtime mode).</p>
<p>:param iteration:</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.on_step', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.on_step" class="source">
    <div class="codehilite"><pre><span></span><span class="k">async</span> <span class="k">def</span> <span class="nf">on_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">iteration</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    You need to implement this function!</span>
<span class="sd">    Override this in your bot class.</span>
<span class="sd">    This function is called on every game step (looped in realtime mode).</span>
<span class="sd">    :param iteration:</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.on_unit_created">
    <p>def <span class="ident">on_unit_created</span>(</p><p>self, unit)</p>
    </div>
    

    
  
    <div class="desc"><p>When unit is created store that for later checks.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.on_unit_created', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.on_unit_created" class="source">
    <div class="codehilite"><pre><span></span><span class="k">async</span> <span class="k">def</span> <span class="nf">on_unit_created</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unit</span><span class="p">:</span> <span class="n">Unit</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;When unit is created store that for later checks.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">raceSpecificUnitCompletedIgnore</span><span class="p">(</span><span class="n">unit</span><span class="o">.</span><span class="n">type_id</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Unit &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">unit</span><span class="o">.</span><span class="n">type_id</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; completed!&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remainingBuildTasks</span><span class="p">[</span><span class="n">unit</span><span class="o">.</span><span class="n">type_id</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.on_unit_destroyed">
    <p>def <span class="ident">on_unit_destroyed</span>(</p><p>self, unit_tag)</p>
    </div>
    

    
  
    <div class="desc"><p>Override this in your bot class.
Note that this function uses unit tags and not the unit objects
because the unit does not exist any more.
This will event will be called when a unit (or structure) dies.
For enemy units, this only works if the enemy unit was in vision on death.</p>
<p>:param unit_tag:</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.on_unit_destroyed', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.on_unit_destroyed" class="source">
    <div class="codehilite"><pre><span></span><span class="k">async</span> <span class="k">def</span> <span class="nf">on_unit_destroyed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unit_tag</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Override this in your bot class.</span>
<span class="sd">    Note that this function uses unit tags and not the unit objects</span>
<span class="sd">    because the unit does not exist any more.</span>
<span class="sd">    This will event will be called when a unit (or structure) dies.</span>
<span class="sd">    For enemy units, this only works if the enemy unit was in vision on death.</span>
<span class="sd">    :param unit_tag:</span>
<span class="sd">    &quot;&quot;&quot;</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.on_unit_took_damage">
    <p>def <span class="ident">on_unit_took_damage</span>(</p><p>self, unit, amount_damage_taken)</p>
    </div>
    

    
  
    <div class="desc"><p>Override this in your bot class. This function is called when your own unit (unit or structure) took damage.
It will not be called if the unit died this frame.</p>
<p>This may be called frequently for terran structures that are burning down, or zerg buildings that are off creep,
or terran bio units that just used stimpack ability.
TODO: If there is a demand for it, then I can add a similar event for when enemy units took damage</p>
<p>Examples::</p>
<div class="codehilite"><pre><span></span><span class="err">print(f&quot;My unit took damage: {unit} took {amount_damage_taken} damage&quot;)</span>
</pre></div>


<p>:param unit:</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.on_unit_took_damage', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.on_unit_took_damage" class="source">
    <div class="codehilite"><pre><span></span><span class="k">async</span> <span class="k">def</span> <span class="nf">on_unit_took_damage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unit</span><span class="p">:</span> <span class="n">Unit</span><span class="p">,</span> <span class="n">amount_damage_taken</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Override this in your bot class. This function is called when your own unit (unit or structure) took damage.</span>
<span class="sd">    It will not be called if the unit died this frame.</span>
<span class="sd">    This may be called frequently for terran structures that are burning down, or zerg buildings that are off creep,</span>
<span class="sd">    or terran bio units that just used stimpack ability.</span>
<span class="sd">    TODO: If there is a demand for it, then I can add a similar event for when enemy units took damage</span>
<span class="sd">    Examples::</span>
<span class="sd">        print(f&quot;My unit took damage: {unit} took {amount_damage_taken} damage&quot;)</span>
<span class="sd">    :param unit:</span>
<span class="sd">    &quot;&quot;&quot;</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.on_unit_type_changed">
    <p>def <span class="ident">on_unit_type_changed</span>(</p><p>self, unit, previous_type)</p>
    </div>
    

    
  
    <div class="desc"><p>Override this in your bot class. This function is called when a unit type has changed. To get the current UnitTypeId of the unit, use 'unit.type_id'</p>
<p>This may happen when a larva morphed to an egg, siege tank sieged, a zerg unit burrowed, a hatchery morphed to lair,
a corruptor morphed to broodlordcocoon, etc..</p>
<p>Examples::</p>
<div class="codehilite"><pre><span></span><span class="err">print(f&quot;My unit changed type: {unit} from {previous_type} to {unit.type_id}&quot;)</span>
</pre></div>


<p>:param unit:
:param previous_type:</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.on_unit_type_changed', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.on_unit_type_changed" class="source">
    <div class="codehilite"><pre><span></span><span class="k">async</span> <span class="k">def</span> <span class="nf">on_unit_type_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unit</span><span class="p">:</span> <span class="n">Unit</span><span class="p">,</span> <span class="n">previous_type</span><span class="p">:</span> <span class="n">UnitTypeId</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Override this in your bot class. This function is called when a unit type has changed. To get the current UnitTypeId of the unit, use &#39;unit.type_id&#39;</span>
<span class="sd">    This may happen when a larva morphed to an egg, siege tank sieged, a zerg unit burrowed, a hatchery morphed to lair,</span>
<span class="sd">    a corruptor morphed to broodlordcocoon, etc..</span>
<span class="sd">    Examples::</span>
<span class="sd">        print(f&quot;My unit changed type: {unit} from {previous_type} to {unit.type_id}&quot;)</span>
<span class="sd">    :param unit:</span>
<span class="sd">    :param previous_type:</span>
<span class="sd">    &quot;&quot;&quot;</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.on_upgrade_complete">
    <p>def <span class="ident">on_upgrade_complete</span>(</p><p>self, upgrade)</p>
    </div>
    

    
  
    <div class="desc"><p>Override this in your bot class. This function is called with the upgrade id of an upgrade that was not finished last step and is now.</p>
<p>:param upgrade:</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.on_upgrade_complete', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.on_upgrade_complete" class="source">
    <div class="codehilite"><pre><span></span><span class="k">async</span> <span class="k">def</span> <span class="nf">on_upgrade_complete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">upgrade</span><span class="p">:</span> <span class="n">UpgradeId</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Override this in your bot class. This function is called with the upgrade id of an upgrade that was not finished last step and is now.</span>
<span class="sd">    :param upgrade:</span>
<span class="sd">    &quot;&quot;&quot;</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.prepareBuildListCompletedCheck">
    <p>def <span class="ident">prepareBuildListCompletedCheck</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Setup check when buildlist is completed that everything was built.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.prepareBuildListCompletedCheck', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.prepareBuildListCompletedCheck" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">prepareBuildListCompletedCheck</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Setup check when buildlist is completed that everything was built.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">remainingBuildTasks</span><span class="p">[</span><span class="n">race_worker</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">race</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">12</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">remainingBuildTasks</span><span class="p">[</span><span class="n">raceBasicTownhall</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">race</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">raceSpecificUnitAndStructureCreations</span><span class="p">()</span>
    <span class="c1"># add everything from build list</span>
    <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">buildList</span><span class="p">:</span>
        <span class="c1"># convert to id</span>
        <span class="n">unitId</span><span class="p">:</span> <span class="n">UnitTypeId</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">unitToId</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">unitId</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">remainingBuildTasks</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remainingBuildTasks</span><span class="p">[</span><span class="n">unitId</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remainingBuildTasks</span><span class="p">[</span><span class="n">unitId</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Created remaining build tasks data structure: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">remainingBuildTasks</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.prevent_double_actions">
    <p>def <span class="ident">prevent_double_actions</span>(</p><p>self, action)</p>
    </div>
    

    
  
    <div class="desc"><p>:param action:</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.prevent_double_actions', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.prevent_double_actions" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">prevent_double_actions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    :param action:</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Always add actions if queued</span>
    <span class="k">if</span> <span class="n">action</span><span class="o">.</span><span class="n">queue</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="n">action</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">orders</span><span class="p">:</span>
        <span class="c1"># action: UnitCommand</span>
        <span class="c1"># current_action: UnitOrder</span>
        <span class="n">current_action</span> <span class="o">=</span> <span class="n">action</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">orders</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">current_action</span><span class="o">.</span><span class="n">ability</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="n">action</span><span class="o">.</span><span class="n">ability</span><span class="p">:</span>
            <span class="c1"># Different action, return True</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">current_action</span><span class="o">.</span><span class="n">target</span> <span class="o">==</span> <span class="n">action</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">tag</span><span class="p">:</span>
                <span class="c1"># Same action, remove action if same target unit</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">action</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">x</span> <span class="o">==</span> <span class="n">current_action</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">x</span> <span class="ow">and</span> <span class="n">action</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">y</span> <span class="o">==</span> <span class="n">current_action</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">y</span><span class="p">:</span>
                <span class="c1"># Same action, remove action if same target position</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="kc">True</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.raceSpecificStructureCompletedIgnore">
    <p>def <span class="ident">raceSpecificStructureCompletedIgnore</span>(</p><p>self, unit)</p>
    </div>
    

    
  
    <div class="desc"><p>Some structures need to be ignored by races.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.raceSpecificStructureCompletedIgnore', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.raceSpecificStructureCompletedIgnore" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">raceSpecificStructureCompletedIgnore</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unit</span><span class="p">:</span> <span class="n">UnitTypeId</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Some structures need to be ignored by races.&quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Has to be implemented by race specific bot!&quot;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.raceSpecificUnitAndStructureCreations">
    <p>def <span class="ident">raceSpecificUnitAndStructureCreations</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Add certain unit creations to build list completed check.</p>
<p>Thhis has to be implemented by a child class to avoid counting initial units 
(automatically given at the start of the game) as units that were created
use self.remainingBuildTasks to include them
an example for workers is given in self.prepareBuildListCompletedCheck()</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.raceSpecificUnitAndStructureCreations', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.raceSpecificUnitAndStructureCreations" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">raceSpecificUnitAndStructureCreations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Add certain unit creations to build list completed check.</span>
<span class="sd">    Thhis has to be implemented by a child class to avoid counting initial units </span>
<span class="sd">    (automatically given at the start of the game) as units that were created</span>
<span class="sd">    use self.remainingBuildTasks to include them</span>
<span class="sd">    an example for workers is given in self.prepareBuildListCompletedCheck()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Has to be implemented by race specific class!&quot;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.raceSpecificUnitCompletedIgnore">
    <p>def <span class="ident">raceSpecificUnitCompletedIgnore</span>(</p><p>self, unit)</p>
    </div>
    

    
  
    <div class="desc"><p>Some units need to be ignored by races.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.raceSpecificUnitCompletedIgnore', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.raceSpecificUnitCompletedIgnore" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">raceSpecificUnitCompletedIgnore</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unit</span><span class="p">:</span> <span class="n">UnitTypeId</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Some units need to be ignored by races.&quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Has to be implemented by race specific bot!&quot;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.research">
    <p>def <span class="ident">research</span>(</p><p>self, upgrade_type)</p>
    </div>
    

    
  
    <div class="desc"><p>Researches an upgrade from a structure that can research it, if it is idle and powered (protoss).
Returns True if the research was started.
Return False if the requirement was not met, or the bot did not have enough resources to start the upgrade,
or the building to research the upgrade was missing or not idle.</p>
<p>New function. Please report any bugs!</p>
<p>Example::</p>
<div class="codehilite"><pre><span></span><span class="err"># Try to research zergling movement speed if we can afford it</span>
<span class="err"># and if at least one pool is at build_progress == 1</span>
<span class="err"># and we are not researching it yet</span>
<span class="err">if self.already_pending_upgrade(UpgradeId.ZERGLINGMOVEMENTSPEED) == 0 and self.can_afford(UpgradeId.ZERGLINGMOVEMENTSPEED):</span>
<span class="err">    spawning_pools_ready = self.structures(UnitTypeId.SPAWNINGPOOL).ready</span>
<span class="err">    if spawning_pools_ready:</span>
<span class="err">        self.research(UpgradeId.ZERGLINGMOVEMENTSPEED)</span>
</pre></div>


<p>:param upgrade_type:</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.research', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.research" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">research</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">upgrade_type</span><span class="p">:</span> <span class="n">UpgradeId</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Researches an upgrade from a structure that can research it, if it is idle and powered (protoss).</span>
<span class="sd">    Returns True if the research was started.</span>
<span class="sd">    Return False if the requirement was not met, or the bot did not have enough resources to start the upgrade,</span>
<span class="sd">    or the building to research the upgrade was missing or not idle.</span>
<span class="sd">    New function. Please report any bugs!</span>
<span class="sd">    Example::</span>
<span class="sd">        # Try to research zergling movement speed if we can afford it</span>
<span class="sd">        # and if at least one pool is at build_progress == 1</span>
<span class="sd">        # and we are not researching it yet</span>
<span class="sd">        if self.already_pending_upgrade(UpgradeId.ZERGLINGMOVEMENTSPEED) == 0 and self.can_afford(UpgradeId.ZERGLINGMOVEMENTSPEED):</span>
<span class="sd">            spawning_pools_ready = self.structures(UnitTypeId.SPAWNINGPOOL).ready</span>
<span class="sd">            if spawning_pools_ready:</span>
<span class="sd">                self.research(UpgradeId.ZERGLINGMOVEMENTSPEED)</span>
<span class="sd">    :param upgrade_type:</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="p">(</span>
        <span class="n">upgrade_type</span> <span class="ow">in</span> <span class="n">UPGRADE_RESEARCHED_FROM</span>
    <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Could not find upgrade </span><span class="si">{</span><span class="n">upgrade_type</span><span class="si">}</span><span class="s2"> in &#39;research from&#39;-dictionary&quot;</span>
    <span class="c1"># Not affordable</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">can_afford</span><span class="p">(</span><span class="n">upgrade_type</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="n">research_structure_types</span><span class="p">:</span> <span class="n">UnitTypeId</span> <span class="o">=</span> <span class="n">UPGRADE_RESEARCHED_FROM</span><span class="p">[</span><span class="n">upgrade_type</span><span class="p">]</span>
    <span class="n">required_tech_building</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">UnitTypeId</span><span class="p">]</span> <span class="o">=</span> <span class="n">RESEARCH_INFO</span><span class="p">[</span><span class="n">research_structure_types</span><span class="p">][</span><span class="n">upgrade_type</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
        <span class="s2">&quot;required_building&quot;</span><span class="p">,</span> <span class="kc">None</span>
    <span class="p">)</span>
    <span class="n">requirement_met</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">required_tech_building</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">structure_type_build_progress</span><span class="p">(</span><span class="n">required_tech_building</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">requirement_met</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="n">is_protoss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">race</span> <span class="o">==</span> <span class="n">Race</span><span class="o">.</span><span class="n">Protoss</span>
    <span class="c1"># All upgrades right now that can be researched in spire and hatch can also be researched in their morphs</span>
    <span class="n">equiv_structures</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">UnitTypeId</span><span class="o">.</span><span class="n">SPIRE</span><span class="p">:</span> <span class="p">{</span><span class="n">UnitTypeId</span><span class="o">.</span><span class="n">SPIRE</span><span class="p">,</span> <span class="n">UnitTypeId</span><span class="o">.</span><span class="n">GREATERSPIRE</span><span class="p">},</span>
        <span class="n">UnitTypeId</span><span class="o">.</span><span class="n">GREATERSPIRE</span><span class="p">:</span> <span class="p">{</span><span class="n">UnitTypeId</span><span class="o">.</span><span class="n">SPIRE</span><span class="p">,</span> <span class="n">UnitTypeId</span><span class="o">.</span><span class="n">GREATERSPIRE</span><span class="p">},</span>
        <span class="n">UnitTypeId</span><span class="o">.</span><span class="n">HATCHERY</span><span class="p">:</span> <span class="p">{</span><span class="n">UnitTypeId</span><span class="o">.</span><span class="n">HATCHERY</span><span class="p">,</span> <span class="n">UnitTypeId</span><span class="o">.</span><span class="n">LAIR</span><span class="p">,</span> <span class="n">UnitTypeId</span><span class="o">.</span><span class="n">HIVE</span><span class="p">},</span>
        <span class="n">UnitTypeId</span><span class="o">.</span><span class="n">LAIR</span><span class="p">:</span> <span class="p">{</span><span class="n">UnitTypeId</span><span class="o">.</span><span class="n">HATCHERY</span><span class="p">,</span> <span class="n">UnitTypeId</span><span class="o">.</span><span class="n">LAIR</span><span class="p">,</span> <span class="n">UnitTypeId</span><span class="o">.</span><span class="n">HIVE</span><span class="p">},</span>
        <span class="n">UnitTypeId</span><span class="o">.</span><span class="n">HIVE</span><span class="p">:</span> <span class="p">{</span><span class="n">UnitTypeId</span><span class="o">.</span><span class="n">HATCHERY</span><span class="p">,</span> <span class="n">UnitTypeId</span><span class="o">.</span><span class="n">LAIR</span><span class="p">,</span> <span class="n">UnitTypeId</span><span class="o">.</span><span class="n">HIVE</span><span class="p">},</span>
    <span class="p">}</span>
    <span class="c1"># Convert to a set, or equivalent structures are chosen</span>
    <span class="c1"># Overlord speed upgrade can be researched from hatchery, lair or hive</span>
    <span class="n">research_structure_types</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="n">UnitTypeId</span><span class="p">]</span> <span class="o">=</span> <span class="n">equiv_structures</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
        <span class="n">research_structure_types</span><span class="p">,</span> <span class="p">{</span><span class="n">research_structure_types</span><span class="p">}</span>
    <span class="p">)</span>
    <span class="n">structure</span><span class="p">:</span> <span class="n">Unit</span>
    <span class="k">for</span> <span class="n">structure</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">structures</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="c1"># Structure can research this upgrade</span>
            <span class="n">structure</span><span class="o">.</span><span class="n">type_id</span> <span class="ow">in</span> <span class="n">research_structure_types</span>
            <span class="c1"># If structure hasn&#39;t received an action/order this frame</span>
            <span class="ow">and</span> <span class="n">structure</span><span class="o">.</span><span class="n">tag</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_tags_received_action</span>
            <span class="c1"># Structure is idle</span>
            <span class="ow">and</span> <span class="n">structure</span><span class="o">.</span><span class="n">is_idle</span>
            <span class="c1"># Structure belongs to protoss and is powered (near pylon)</span>
            <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">is_protoss</span> <span class="ow">or</span> <span class="n">structure</span><span class="o">.</span><span class="n">is_powered</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="c1"># Can_afford check was already done earlier in this function</span>
            <span class="n">successful_action</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">do</span><span class="p">(</span>
                <span class="n">structure</span><span class="o">.</span><span class="n">research</span><span class="p">(</span><span class="n">upgrade_type</span><span class="p">),</span> <span class="n">subtract_cost</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ignore_warning</span><span class="o">=</span><span class="kc">True</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="n">successful_action</span>
    <span class="k">return</span> <span class="kc">False</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.scanBuildList">
    <p>def <span class="ident">scanBuildList</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Preprocess/check of buildlist.</p>
<p>Checks: 
- number of expansions must be smaller or equal to seven
- number of gas buildings must be smaller or equal to 2*(numberOfExpansions+1)
- everything in buildlist is known to the bot</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.scanBuildList', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.scanBuildList" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">scanBuildList</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Preprocess/check of buildlist.</span>
<span class="sd">    Checks: </span>
<span class="sd">    - number of expansions must be smaller or equal to seven</span>
<span class="sd">    - number of gas buildings must be smaller or equal to 2*(numberOfExpansions+1)</span>
<span class="sd">    - everything in buildlist is known to the bot</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">buildListCopy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">buildList</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">expansionCount</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">gasBuildingCount</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">buildListCopy</span><span class="p">:</span>
        <span class="n">unitId</span><span class="p">:</span> <span class="n">UnitTypeId</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">unitToId</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">unitId</span> <span class="o">==</span> <span class="n">raceBasicTownhall</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">race</span><span class="p">]:</span>
            <span class="n">expansionCount</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">unitId</span> <span class="o">==</span> <span class="n">race_gas</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">race</span><span class="p">]:</span>
            <span class="n">gasBuildingCount</span> <span class="o">+=</span> <span class="mi">1</span>
    
    <span class="k">if</span> <span class="n">expansionCount</span> <span class="o">&gt;</span> <span class="mi">7</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;BuildList is invalid! To many expansions. Max: 7; Have: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">expansionCount</span><span class="p">))</span>
    <span class="c1"># add one to expansion count (natural)</span>
    <span class="n">expansionCount</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">maxNumberOfGas</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">expansionCount</span> <span class="o">*</span> <span class="mi">2</span>
    <span class="k">if</span> <span class="n">gasBuildingCount</span> <span class="o">&gt;</span> <span class="n">maxNumberOfGas</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;BuildList is invalid! To many gas buildings. Max:&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">maxNumberOfGas</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;; Have: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">gasBuildingCount</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;BuildList has no errors.&quot;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.select_build_worker">
    <p>def <span class="ident">select_build_worker</span>(</p><p>self, pos, force=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Select a worker to build a building with.</p>
<p>Example::</p>
<div class="codehilite"><pre><span></span><span class="err">barracks_placement_position = self.main_base_ramp.barracks_correct_placement</span>
<span class="err">worker = self.select_build_worker(barracks_placement_position)</span>
<span class="err"># Can return None</span>
<span class="err">if worker:</span>
<span class="err">    worker.build(UnitTypeId.BARRACKS, barracks_placement_position)</span>
</pre></div>


<p>:param pos:
:param force:</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.select_build_worker', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.select_build_worker" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">select_build_worker</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Unit</span><span class="p">,</span> <span class="n">Point2</span><span class="p">],</span> <span class="n">force</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Unit</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Select a worker to build a building with.</span>
<span class="sd">    </span>
<span class="sd">    Example::</span>
<span class="sd">        barracks_placement_position = self.main_base_ramp.barracks_correct_placement</span>
<span class="sd">        worker = self.select_build_worker(barracks_placement_position)</span>
<span class="sd">        # Can return None</span>
<span class="sd">        if worker:</span>
<span class="sd">            worker.build(UnitTypeId.BARRACKS, barracks_placement_position)</span>
<span class="sd">    :param pos:</span>
<span class="sd">    :param force: &quot;&quot;&quot;</span>
    <span class="n">workers</span> <span class="o">=</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">workers</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">w</span><span class="p">:</span> <span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">is_gathering</span> <span class="ow">or</span> <span class="n">w</span><span class="o">.</span><span class="n">is_idle</span><span class="p">)</span> <span class="ow">and</span> <span class="n">w</span><span class="o">.</span><span class="n">distance_to</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">workers</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">workers</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">worker</span> <span class="ow">in</span> <span class="n">workers</span><span class="o">.</span><span class="n">sorted_by_distance_to</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">prefer_idle</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">worker</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_tags_received_action</span>
                <span class="ow">and</span> <span class="ow">not</span> <span class="n">worker</span><span class="o">.</span><span class="n">orders</span>
                <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">worker</span><span class="o">.</span><span class="n">orders</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
                <span class="ow">and</span> <span class="n">worker</span><span class="o">.</span><span class="n">orders</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">ability</span><span class="o">.</span><span class="n">id</span> <span class="ow">in</span> <span class="p">{</span><span class="n">AbilityId</span><span class="o">.</span><span class="n">MOVE</span><span class="p">,</span> <span class="n">AbilityId</span><span class="o">.</span><span class="n">HARVEST_GATHER</span><span class="p">}</span>
            <span class="p">):</span>
                <span class="k">return</span> <span class="n">worker</span>
        <span class="k">return</span> <span class="n">workers</span><span class="o">.</span><span class="n">random</span> <span class="k">if</span> <span class="n">force</span> <span class="k">else</span> <span class="kc">None</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.setSelfStartLocation">
    <p>def <span class="ident">setSelfStartLocation</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Derive start location from coordinates.</p>
<p>Sets the bots start location (enum StartLocation in BuildListProcesserDicts.py)
based on the start location coordinates.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.setSelfStartLocation', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.setSelfStartLocation" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">setSelfStartLocation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Derive start location from coordinates.</span>
<span class="sd">    Sets the bots start location (enum StartLocation in BuildListProcesserDicts.py)</span>
<span class="sd">    based on the start location coordinates.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game_info</span><span class="o">.</span><span class="n">player_start_location</span><span class="o">.</span><span class="n">x</span> <span class="o">==</span> <span class="mf">24.5</span><span class="p">):</span>
        <span class="c1"># left side of map</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game_info</span><span class="o">.</span><span class="n">player_start_location</span><span class="o">.</span><span class="n">y</span> <span class="o">==</span> <span class="mf">22.5</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">startLocation</span> <span class="o">=</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">BOTTOM_LEFT</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">startLocation</span> <span class="o">=</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">TOP_LEFT</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># right side of map</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game_info</span><span class="o">.</span><span class="n">player_start_location</span><span class="o">.</span><span class="n">y</span> <span class="o">==</span> <span class="mf">22.5</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">startLocation</span> <span class="o">=</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">BOTTOM_RIGHT</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">startLocation</span> <span class="o">=</span> <span class="n">StartLocation</span><span class="o">.</span><span class="n">TOP_RIGHT</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">loggerBase</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Start location is &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">startLocation</span><span class="p">))</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span> <span class="o">==</span> <span class="n">Player</span><span class="o">.</span><span class="n">PLAYER_ONE</span><span class="p">:</span>
        <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_ONE_START_LOCATION</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">startLocation</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">BuildListProcessBotBase</span><span class="o">.</span><span class="n">PLAYER_TWO_START_LOCATION</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">startLocation</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.square_to_condensed">
    <p>def <span class="ident">square_to_condensed</span>(</p><p>self, i, j)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.square_to_condensed', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.square_to_condensed" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">square_to_condensed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="c1"># Converts indices of a square matrix to condensed matrix</span>
    <span class="c1"># https://stackoverflow.com/a/36867493/10882657</span>
    <span class="k">assert</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">j</span><span class="p">,</span> <span class="s2">&quot;No diagonal elements in condensed matrix! Diagonal elements are zero&quot;</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">j</span><span class="p">:</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">j</span><span class="p">,</span> <span class="n">i</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_units_count</span> <span class="o">*</span> <span class="n">j</span> <span class="o">-</span> <span class="n">j</span> <span class="o">*</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">j</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.structure_type_build_progress">
    <p>def <span class="ident">structure_type_build_progress</span>(</p><p>self, structure_type)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns the build progress of a structure type.</p>
<p>Return range: 0 &lt;= x &lt;= 1 where
    0: no such structure exists
    0 &lt; x &lt; 1: at least one structure is under construction, returns the progress of the one with the highest progress
    1: we have at least one such structure complete</p>
<p>Example::</p>
<div class="codehilite"><pre><span></span><span class="o">#</span> <span class="n">Assuming</span> <span class="n">you</span> <span class="n">have</span> <span class="n">one</span> <span class="n">barracks</span> <span class="n">building</span> <span class="k">at</span> <span class="mi">0</span><span class="p">.</span><span class="mi">5</span> <span class="n">build</span> <span class="n">progress</span><span class="p">:</span>
<span class="n">progress</span> <span class="o">=</span> <span class="k">self</span><span class="p">.</span><span class="n">structure_type_build_progress</span><span class="p">(</span><span class="n">UnitTypeId</span><span class="p">.</span><span class="n">BARRACKS</span><span class="p">)</span>
<span class="n">print</span><span class="p">(</span><span class="n">progress</span><span class="p">)</span>
<span class="o">#</span> <span class="n">This</span> <span class="n">prints</span> <span class="k">out</span> <span class="mi">0</span><span class="p">.</span><span class="mi">5</span>

<span class="o">#</span> <span class="k">If</span> <span class="n">you</span> <span class="n">want</span> <span class="k">to</span> <span class="n">save</span> <span class="n">up</span> <span class="n">money</span> <span class="k">for</span> <span class="n">mutalisks</span><span class="p">,</span> <span class="n">you</span> <span class="n">can</span> <span class="n">now</span> <span class="n">save</span> <span class="n">up</span> <span class="n">once</span> <span class="n">the</span> <span class="n">spire</span> <span class="k">is</span> <span class="n">nearly</span> <span class="n">completed</span><span class="p">:</span>
<span class="n">spire_almost_completed</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="k">self</span><span class="p">.</span><span class="n">structure_type_build_progress</span><span class="p">(</span><span class="n">UnitTypeId</span><span class="p">.</span><span class="n">SPIRE</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">75</span>

<span class="o">#</span> <span class="k">If</span> <span class="n">you</span> <span class="n">have</span> <span class="n">a</span> <span class="n">Hive</span> <span class="n">completed</span> <span class="n">but</span> <span class="k">no</span> <span class="n">lair</span><span class="p">,</span> <span class="n">this</span> <span class="k">function</span> <span class="k">returns</span> <span class="mi">1</span><span class="p">.</span><span class="mi">0</span> <span class="k">for</span> <span class="n">the</span> <span class="n">following</span><span class="p">:</span>
<span class="k">self</span><span class="p">.</span><span class="n">structure_type_build_progress</span><span class="p">(</span><span class="n">UnitTypeId</span><span class="p">.</span><span class="n">LAIR</span><span class="p">)</span>

<span class="o">#</span> <span class="n">Assume</span> <span class="n">you</span> <span class="n">have</span> <span class="mi">2</span> <span class="n">command</span> <span class="n">centers</span> <span class="k">in</span> <span class="n">production</span><span class="p">,</span> <span class="n">one</span> <span class="n">has</span> <span class="mi">0</span><span class="p">.</span><span class="mi">5</span> <span class="n">build_progress</span> <span class="k">and</span> <span class="n">the</span> <span class="n">other</span> <span class="mi">0</span><span class="p">.</span><span class="mi">2</span><span class="p">,</span> <span class="n">the</span> <span class="n">following</span> <span class="k">returns</span> <span class="mi">0</span><span class="p">.</span><span class="mi">5</span>
<span class="n">highest_progress_of_command_center</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="k">self</span><span class="p">.</span><span class="n">structure_type_build_progress</span><span class="p">(</span><span class="n">UnitTypeId</span><span class="p">.</span><span class="n">COMMANDCENTER</span><span class="p">)</span>
</pre></div>


<p>:param structure_type:</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.structure_type_build_progress', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.structure_type_build_progress" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">structure_type_build_progress</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">structure_type</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">UnitTypeId</span><span class="p">,</span> <span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the build progress of a structure type.</span>
<span class="sd">    Return range: 0 &lt;= x &lt;= 1 where</span>
<span class="sd">        0: no such structure exists</span>
<span class="sd">        0 &lt; x &lt; 1: at least one structure is under construction, returns the progress of the one with the highest progress</span>
<span class="sd">        1: we have at least one such structure complete</span>
<span class="sd">    Example::</span>
<span class="sd">        # Assuming you have one barracks building at 0.5 build progress:</span>
<span class="sd">        progress = self.structure_type_build_progress(UnitTypeId.BARRACKS)</span>
<span class="sd">        print(progress)</span>
<span class="sd">        # This prints out 0.5</span>
<span class="sd">        # If you want to save up money for mutalisks, you can now save up once the spire is nearly completed:</span>
<span class="sd">        spire_almost_completed: bool = self.structure_type_build_progress(UnitTypeId.SPIRE) &gt; 0.75</span>
<span class="sd">        # If you have a Hive completed but no lair, this function returns 1.0 for the following:</span>
<span class="sd">        self.structure_type_build_progress(UnitTypeId.LAIR)</span>
<span class="sd">        # Assume you have 2 command centers in production, one has 0.5 build_progress and the other 0.2, the following returns 0.5</span>
<span class="sd">        highest_progress_of_command_center: float = self.structure_type_build_progress(UnitTypeId.COMMANDCENTER)</span>
<span class="sd">    :param structure_type:</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
        <span class="n">structure_type</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">UnitTypeId</span><span class="p">)</span>
    <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Needs to be int or UnitTypeId, but was: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">structure_type</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">structure_type</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="n">structure_type_value</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">structure_type</span>
        <span class="n">structure_type</span> <span class="o">=</span> <span class="n">UnitTypeId</span><span class="p">(</span><span class="n">structure_type_value</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">structure_type_value</span> <span class="o">=</span> <span class="n">structure_type</span><span class="o">.</span><span class="n">value</span>
    <span class="k">assert</span> <span class="n">structure_type_value</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;structure_type can not be 0 or NOTAUNIT, but was: </span><span class="si">{</span><span class="n">structure_type_value</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">equiv_values</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">structure_type_value</span><span class="p">}</span> <span class="o">|</span> <span class="p">{</span>
        <span class="n">s_type</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">s_type</span> <span class="ow">in</span> <span class="n">EQUIVALENTS_FOR_TECH_PROGRESS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">structure_type</span><span class="p">,</span> <span class="nb">set</span><span class="p">())</span>
    <span class="p">}</span>
    <span class="n">creation_ability</span><span class="p">:</span> <span class="n">AbilityData</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_game_data</span><span class="o">.</span><span class="n">units</span><span class="p">[</span><span class="n">structure_type_value</span><span class="p">]</span><span class="o">.</span><span class="n">creation_ability</span>
    <span class="n">max_value</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
        <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">build_progress</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">structures</span> <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">_proto</span><span class="o">.</span><span class="n">unit_type</span> <span class="ow">in</span> <span class="n">equiv_values</span><span class="p">]</span>
        <span class="o">+</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_abilities_all_units</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">creation_ability</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">max_value</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.synchronous_do">
    <p>def <span class="ident">synchronous_do</span>(</p><p>self, action)</p>
    </div>
    

    
  
    <div class="desc"><p>Not recommended. Use self.do instead to reduce lag.
This function is only useful for realtime=True in the first frame of the game to instantly produce a worker
and split workers on the mineral patches.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.synchronous_do', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.synchronous_do" class="source">
    <div class="codehilite"><pre><span></span><span class="k">async</span> <span class="k">def</span> <span class="nf">synchronous_do</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">:</span> <span class="n">UnitCommand</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Not recommended. Use self.do instead to reduce lag.</span>
<span class="sd">    This function is only useful for realtime=True in the first frame of the game to instantly produce a worker</span>
<span class="sd">    and split workers on the mineral patches.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
        <span class="n">action</span><span class="p">,</span> <span class="n">UnitCommand</span>
    <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Given unit command is not a command, but instead of type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">action</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">can_afford</span><span class="p">(</span><span class="n">action</span><span class="o">.</span><span class="n">ability</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot afford action </span><span class="si">{</span><span class="n">action</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ActionResult</span><span class="o">.</span><span class="n">Error</span>
    <span class="n">r</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">actions</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">r</span><span class="p">:</span>  <span class="c1"># success</span>
        <span class="n">cost</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_game_data</span><span class="o">.</span><span class="n">calculate_ability_cost</span><span class="p">(</span><span class="n">action</span><span class="o">.</span><span class="n">ability</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minerals</span> <span class="o">-=</span> <span class="n">cost</span><span class="o">.</span><span class="n">minerals</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vespene</span> <span class="o">-=</span> <span class="n">cost</span><span class="o">.</span><span class="n">vespene</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unit_tags_received_action</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">action</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">tag</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: </span><span class="si">{</span><span class="n">r</span><span class="si">}</span><span class="s2"> (action: </span><span class="si">{</span><span class="n">action</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">r</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.tech_requirement_progress">
    <p>def <span class="ident">tech_requirement_progress</span>(</p><p>self, structure_type)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns the tech requirement progress for a specific building</p>
<p>Example::</p>
<div class="codehilite"><pre><span></span><span class="err"># Current state: supply depot is at 50% completion</span>
<span class="err">tech_requirement = self.tech_requirement_progress(UnitTypeId.BARRACKS)</span>
<span class="err">print(tech_requirement) # Prints 0.5 because supply depot is half way done</span>
</pre></div>


<p>Example::</p>
<div class="codehilite"><pre><span></span><span class="err"># Current state: your bot has one hive, no lair</span>
<span class="err">tech_requirement = self.tech_requirement_progress(UnitTypeId.HYDRALISKDEN)</span>
<span class="err">print(tech_requirement) # Prints 1 because a hive exists even though only a lair is required</span>
</pre></div>


<p>Example::</p>
<div class="codehilite"><pre><span></span><span class="err"># Current state: One factory is flying and one is half way done</span>
<span class="err">tech_requirement = self.tech_requirement_progress(UnitTypeId.STARPORT)</span>
<span class="err">print(tech_requirement) # Prints 1 because even though the type id of the flying factory is different, it still has build progress of 1 and thus tech requirement is completed</span>
</pre></div>


<p>:param structure_type:</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.tech_requirement_progress', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.tech_requirement_progress" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">tech_requirement_progress</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">structure_type</span><span class="p">:</span> <span class="n">UnitTypeId</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot; Returns the tech requirement progress for a specific building</span>
<span class="sd">    Example::</span>
<span class="sd">        # Current state: supply depot is at 50% completion</span>
<span class="sd">        tech_requirement = self.tech_requirement_progress(UnitTypeId.BARRACKS)</span>
<span class="sd">        print(tech_requirement) # Prints 0.5 because supply depot is half way done</span>
<span class="sd">    Example::</span>
<span class="sd">        # Current state: your bot has one hive, no lair</span>
<span class="sd">        tech_requirement = self.tech_requirement_progress(UnitTypeId.HYDRALISKDEN)</span>
<span class="sd">        print(tech_requirement) # Prints 1 because a hive exists even though only a lair is required</span>
<span class="sd">    Example::</span>
<span class="sd">        # Current state: One factory is flying and one is half way done</span>
<span class="sd">        tech_requirement = self.tech_requirement_progress(UnitTypeId.STARPORT)</span>
<span class="sd">        print(tech_requirement) # Prints 1 because even though the type id of the flying factory is different, it still has build progress of 1 and thus tech requirement is completed</span>
<span class="sd">    :param structure_type: &quot;&quot;&quot;</span>
    <span class="n">race_dict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">Race</span><span class="o">.</span><span class="n">Protoss</span><span class="p">:</span> <span class="n">PROTOSS_TECH_REQUIREMENT</span><span class="p">,</span>
        <span class="n">Race</span><span class="o">.</span><span class="n">Terran</span><span class="p">:</span> <span class="n">TERRAN_TECH_REQUIREMENT</span><span class="p">,</span>
        <span class="n">Race</span><span class="o">.</span><span class="n">Zerg</span><span class="p">:</span> <span class="n">ZERG_TECH_REQUIREMENT</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">unit_info_id</span> <span class="o">=</span> <span class="n">race_dict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">race</span><span class="p">][</span><span class="n">structure_type</span><span class="p">]</span>
    <span class="n">unit_info_id_value</span> <span class="o">=</span> <span class="n">unit_info_id</span><span class="o">.</span><span class="n">value</span>
    <span class="c1"># The following commented out line is unreliable for ghost / thor as they return 0 which is incorrect</span>
    <span class="c1"># unit_info_id_value = self._game_data.units[structure_type.value]._proto.tech_requirement</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">unit_info_id_value</span><span class="p">:</span>  <span class="c1"># Equivalent to &quot;if unit_info_id_value == 0:&quot;</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="n">progresses</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">structure_type_build_progress</span><span class="p">(</span><span class="n">unit_info_id_value</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">equiv_structure</span> <span class="ow">in</span> <span class="n">EQUIVALENTS_FOR_TECH_PROGRESS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">unit_info_id</span><span class="p">,</span> <span class="p">[]):</span>
        <span class="n">progresses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">structure_type_build_progress</span><span class="p">(</span><span class="n">equiv_structure</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
    <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="n">progresses</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.train">
    <p>def <span class="ident">train</span>(</p><p>self, unit_type, amount=1, closest_to=None, train_only_idle_buildings=True)</p>
    </div>
    

    
  
    <div class="desc"><p>Trains a specified number of units. Trains only one if amount is not specified.
Warning: currently has issues with warp gate warp ins</p>
<p>New function. Please report any bugs!</p>
<p>Example Zerg::</p>
<div class="codehilite"><pre><span></span><span class="err">self.train(UnitTypeId.QUEEN, 5)</span>
<span class="err"># This should queue 5 queens in 5 different townhalls if you have enough townhalls, enough minerals and enough free supply left</span>
</pre></div>


<p>Example Terran::</p>
<div class="codehilite"><pre><span></span><span class="err"># Assuming you have 2 idle barracks with reactors, one barracks without addon and one with techlab</span>
<span class="err"># It should only queue 4 marines in the 2 idle barracks with reactors</span>
<span class="err">self.train(UnitTypeId.MARINE, 4)</span>
</pre></div>


<p>Example distance to::</p>
<div class="codehilite"><pre><span></span><span class="err"># If you want to train based on distance to a certain point, you can use &quot;closest_to&quot;</span>
<span class="err">self.train(UnitTypeId.MARINE, 4, closest_to = self.game_info.map_center)</span>
</pre></div>


<p>:param unit_type:
:param amount:
:param closest_to:
:param train_only_idle_buildings:</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.train', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.train" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">train</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">unit_type</span><span class="p">:</span> <span class="n">UnitTypeId</span><span class="p">,</span> <span class="n">amount</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">closest_to</span><span class="p">:</span> <span class="n">Point2</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">train_only_idle_buildings</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot; Trains a specified number of units. Trains only one if amount is not specified.</span>
<span class="sd">    Warning: currently has issues with warp gate warp ins</span>
<span class="sd">    New function. Please report any bugs!</span>
<span class="sd">    Example Zerg::</span>
<span class="sd">        self.train(UnitTypeId.QUEEN, 5)</span>
<span class="sd">        # This should queue 5 queens in 5 different townhalls if you have enough townhalls, enough minerals and enough free supply left</span>
<span class="sd">    Example Terran::</span>
<span class="sd">        # Assuming you have 2 idle barracks with reactors, one barracks without addon and one with techlab</span>
<span class="sd">        # It should only queue 4 marines in the 2 idle barracks with reactors</span>
<span class="sd">        self.train(UnitTypeId.MARINE, 4)</span>
<span class="sd">    Example distance to::</span>
<span class="sd">        # If you want to train based on distance to a certain point, you can use &quot;closest_to&quot;</span>
<span class="sd">        self.train(UnitTypeId.MARINE, 4, closest_to = self.game_info.map_center)</span>
<span class="sd">    :param unit_type:</span>
<span class="sd">    :param amount:</span>
<span class="sd">    :param closest_to:</span>
<span class="sd">    :param train_only_idle_buildings: &quot;&quot;&quot;</span>
    <span class="c1"># Tech requirement not met</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tech_requirement_progress</span><span class="p">(</span><span class="n">unit_type</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">race_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">Race</span><span class="o">.</span><span class="n">Protoss</span><span class="p">:</span> <span class="n">PROTOSS_TECH_REQUIREMENT</span><span class="p">,</span>
            <span class="n">Race</span><span class="o">.</span><span class="n">Terran</span><span class="p">:</span> <span class="n">TERRAN_TECH_REQUIREMENT</span><span class="p">,</span>
            <span class="n">Race</span><span class="o">.</span><span class="n">Zerg</span><span class="p">:</span> <span class="n">ZERG_TECH_REQUIREMENT</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">unit_info_id</span> <span class="o">=</span> <span class="n">race_dict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">race</span><span class="p">][</span><span class="n">unit_type</span><span class="p">]</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> Trying to produce unit </span><span class="si">{}</span><span class="s2"> in self.train() but tech requirement is not met: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">time_formatted</span><span class="p">,</span> <span class="n">unit_type</span><span class="p">,</span> <span class="n">unit_info_id</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="c1"># Not affordable</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">can_afford</span><span class="p">(</span><span class="n">unit_type</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="n">trained_amount</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1"># All train structure types: queen can made from hatchery, lair, hive</span>
    <span class="n">train_structure_type</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="n">UnitTypeId</span><span class="p">]</span> <span class="o">=</span> <span class="n">UNIT_TRAINED_FROM</span><span class="p">[</span><span class="n">unit_type</span><span class="p">]</span>
    <span class="n">train_structures</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structures</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">race</span> <span class="o">!=</span> <span class="n">Race</span><span class="o">.</span><span class="n">Zerg</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">structures</span> <span class="o">|</span> <span class="bp">self</span><span class="o">.</span><span class="n">larva</span>
    <span class="n">requires_techlab</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
        <span class="n">TRAIN_INFO</span><span class="p">[</span><span class="n">structure_type</span><span class="p">][</span><span class="n">unit_type</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;requires_techlab&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">structure_type</span> <span class="ow">in</span> <span class="n">train_structure_type</span>
    <span class="p">)</span>
    <span class="n">is_protoss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">race</span> <span class="o">==</span> <span class="n">Race</span><span class="o">.</span><span class="n">Protoss</span>
    <span class="n">is_terran</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">race</span> <span class="o">==</span> <span class="n">Race</span><span class="o">.</span><span class="n">Terran</span>
    <span class="n">can_have_addons</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
        <span class="n">u</span> <span class="ow">in</span> <span class="n">train_structure_type</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="p">{</span><span class="n">UnitTypeId</span><span class="o">.</span><span class="n">BARRACKS</span><span class="p">,</span> <span class="n">UnitTypeId</span><span class="o">.</span><span class="n">FACTORY</span><span class="p">,</span> <span class="n">UnitTypeId</span><span class="o">.</span><span class="n">STARPORT</span><span class="p">}</span>
    <span class="p">)</span>
    <span class="c1"># Sort structures closest to a point</span>
    <span class="k">if</span> <span class="n">closest_to</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">train_structures</span> <span class="o">=</span> <span class="n">train_structures</span><span class="o">.</span><span class="n">sorted_by_distance_to</span><span class="p">(</span><span class="n">closest_to</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">can_have_addons</span><span class="p">:</span>
        <span class="c1"># This should sort the structures in ascending order: first structures with reactor, then naked, then with techlab</span>
        <span class="n">train_structures</span> <span class="o">=</span> <span class="n">train_structures</span><span class="o">.</span><span class="n">sorted</span><span class="p">(</span>
            <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">structure</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="p">(</span><span class="n">structure</span><span class="o">.</span><span class="n">add_on_tag</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reactor_tags</span><span class="p">)</span>
            <span class="o">+</span> <span class="mi">1</span> <span class="o">*</span> <span class="p">(</span><span class="n">structure</span><span class="o">.</span><span class="n">add_on_tag</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">techlab_tags</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="n">structure</span><span class="p">:</span> <span class="n">Unit</span>
    <span class="k">for</span> <span class="n">structure</span> <span class="ow">in</span> <span class="n">train_structures</span><span class="p">:</span>
        <span class="c1"># Exit early if we can&#39;t afford</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">can_afford</span><span class="p">(</span><span class="n">unit_type</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">trained_amount</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="c1"># If structure hasn&#39;t received an action/order this frame</span>
            <span class="n">structure</span><span class="o">.</span><span class="n">tag</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_tags_received_action</span>
            <span class="c1"># If structure can train this unit at all</span>
            <span class="ow">and</span> <span class="n">structure</span><span class="o">.</span><span class="n">type_id</span> <span class="ow">in</span> <span class="n">train_structure_type</span>
            <span class="c1"># Structure has to be completed to be able to train</span>
            <span class="ow">and</span> <span class="n">structure</span><span class="o">.</span><span class="n">build_progress</span> <span class="o">==</span> <span class="mi">1</span>
            <span class="c1"># If structure is protoss, it needs to be powered to train</span>
            <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">is_protoss</span> <span class="ow">or</span> <span class="n">structure</span><span class="o">.</span><span class="n">is_powered</span><span class="p">)</span>
            <span class="c1"># Either parameter &quot;train_only_idle_buildings&quot; is False or structure is idle or structure has less than 2 orders and has reactor</span>
            <span class="ow">and</span> <span class="p">(</span>
                <span class="ow">not</span> <span class="n">train_only_idle_buildings</span>
                <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">structure</span><span class="o">.</span><span class="n">orders</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">structure</span><span class="o">.</span><span class="n">add_on_tag</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reactor_tags</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="c1"># If structure type_id does not accept addons, it cant require a techlab</span>
            <span class="c1"># Else we have to check if building has techlab as addon</span>
            <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">requires_techlab</span> <span class="ow">or</span> <span class="n">structure</span><span class="o">.</span><span class="n">add_on_tag</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">techlab_tags</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="c1"># Warp in at location</span>
            <span class="c1"># TODO: find fast warp in locations either random location or closest to the given parameter &quot;closest_to&quot;</span>
            <span class="c1"># TODO: find out which pylons have fast warp in by checking distance to nexus and warpgates.ready</span>
            <span class="k">if</span> <span class="n">structure</span><span class="o">.</span><span class="n">type_id</span> <span class="o">==</span> <span class="n">UnitTypeId</span><span class="o">.</span><span class="n">WARPGATE</span><span class="p">:</span>
                <span class="n">pylons</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structures</span><span class="p">(</span><span class="n">UnitTypeId</span><span class="o">.</span><span class="n">PYLON</span><span class="p">)</span>
                <span class="n">location</span> <span class="o">=</span> <span class="n">pylons</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">random_on_distance</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
                <span class="n">successfully_trained</span> <span class="o">=</span> <span class="n">structure</span><span class="o">.</span><span class="n">warp_in</span><span class="p">(</span><span class="n">unit_type</span><span class="p">,</span> <span class="n">location</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Normal train a unit from larva or inside a structure</span>
                <span class="n">successfully_trained</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">do</span><span class="p">(</span>
                    <span class="n">structure</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">unit_type</span><span class="p">),</span> <span class="n">subtract_cost</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">subtract_supply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ignore_warning</span><span class="o">=</span><span class="kc">True</span>
                <span class="p">)</span>
                <span class="c1"># Check if structure has reactor: queue same unit again</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="c1"># Only terran can have reactors</span>
                    <span class="n">is_terran</span>
                    <span class="c1"># Check if we have enough cost or supply for this unit type</span>
                    <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">can_afford</span><span class="p">(</span><span class="n">unit_type</span><span class="p">)</span>
                    <span class="c1"># Structure needs to be idle in the current frame</span>
                    <span class="ow">and</span> <span class="ow">not</span> <span class="n">structure</span><span class="o">.</span><span class="n">orders</span>
                    <span class="c1"># We are at least 2 away from goal</span>
                    <span class="ow">and</span> <span class="n">trained_amount</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">amount</span>
                    <span class="c1"># Unit type does not require techlab</span>
                    <span class="ow">and</span> <span class="ow">not</span> <span class="n">requires_techlab</span>
                    <span class="c1"># Train structure has reactor</span>
                    <span class="ow">and</span> <span class="n">structure</span><span class="o">.</span><span class="n">add_on_tag</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reactor_tags</span>
                <span class="p">):</span>
                    <span class="n">trained_amount</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="c1"># With one command queue=False and one queue=True, you can queue 2 marines in a reactored barracks in one frame</span>
                    <span class="n">successfully_trained</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">do</span><span class="p">(</span>
                        <span class="n">structure</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">unit_type</span><span class="p">,</span> <span class="n">queue</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                        <span class="n">subtract_cost</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">subtract_supply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">ignore_warning</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="p">)</span>
            <span class="k">if</span> <span class="n">successfully_trained</span><span class="p">:</span>
                <span class="n">trained_amount</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">trained_amount</span> <span class="o">==</span> <span class="n">amount</span><span class="p">:</span>
                    <span class="c1"># Target unit train amount reached</span>
                    <span class="k">return</span> <span class="n">trained_amount</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Some error occured and we couldn&#39;t train the unit</span>
                <span class="k">return</span> <span class="n">trained_amount</span>
    <span class="k">return</span> <span class="n">trained_amount</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.unitToId">
    <p>def <span class="ident">unitToId</span>(</p><p>self, unitName)</p>
    </div>
    

    
  
    <div class="desc"><p>Convert unit name to id.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.unitToId', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.unitToId" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">unitToId</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unitName</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convert unit name to id.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">unitName</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">CONVERT_TO_ID</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">unitName</span> <span class="o">+</span> <span class="s2">&quot; is not available in CONVERT_TO_ID!&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">CONVERT_TO_ID</span><span class="p">[</span><span class="n">unitName</span><span class="p">]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="BuildListProcessBotBase.BuildListProcessBotBase.worker_en_route_to_build">
    <p>def <span class="ident">worker_en_route_to_build</span>(</p><p>self, unit_type)</p>
    </div>
    

    
  
    <div class="desc"><p>This function counts how many workers are on the way to start the construction a building.
Warning: this function may change its name in the future!
New function. Please report any bugs!</p>
<p>:param unit_type:</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.BuildListProcessBotBase.worker_en_route_to_build', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.BuildListProcessBotBase.worker_en_route_to_build" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">worker_en_route_to_build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unit_type</span><span class="p">:</span> <span class="n">UnitTypeId</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot; This function counts how many workers are on the way to start the construction a building.</span>
<span class="sd">    Warning: this function may change its name in the future!</span>
<span class="sd">    New function. Please report any bugs!</span>
<span class="sd">    :param unit_type: &quot;&quot;&quot;</span>
    <span class="n">ability</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_game_data</span><span class="o">.</span><span class="n">units</span><span class="p">[</span><span class="n">unit_type</span><span class="o">.</span><span class="n">value</span><span class="p">]</span><span class="o">.</span><span class="n">creation_ability</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_worker_orders</span><span class="p">[</span><span class="n">ability</span><span class="p">]</span>
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Instance variables</h3>
            <div class="item">
            <p id="BuildListProcessBotBase.BuildListProcessBotBase.attackDone" class="name">var <span class="ident">attackDone</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="BuildListProcessBotBase.BuildListProcessBotBase.attacking" class="name">var <span class="ident">attacking</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="BuildListProcessBotBase.BuildListProcessBotBase.bottomExpansions" class="name">var <span class="ident">bottomExpansions</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="BuildListProcessBotBase.BuildListProcessBotBase.buildList" class="name">var <span class="ident">buildList</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="BuildListProcessBotBase.BuildListProcessBotBase.client" class="name">var <span class="ident">client</span></p>
            

            
  
    <div class="desc"><p>See client.py</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="BuildListProcessBotBase.BuildListProcessBotBase.currentTask" class="name">var <span class="ident">currentTask</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="BuildListProcessBotBase.BuildListProcessBotBase.done" class="name">var <span class="ident">done</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="BuildListProcessBotBase.BuildListProcessBotBase.enemy_start_locations" class="name">var <span class="ident">enemy_start_locations</span></p>
            

            
  
    <div class="desc"><p>Possible start locations for enemies.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="BuildListProcessBotBase.BuildListProcessBotBase.expansionLocations" class="name">var <span class="ident">expansionLocations</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="BuildListProcessBotBase.BuildListProcessBotBase.expansionLocationsComputed" class="name">var <span class="ident">expansionLocationsComputed</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="BuildListProcessBotBase.BuildListProcessBotBase.expansion_locations" class="name">var <span class="ident">expansion_locations</span></p>
            

            
  
    <div class="desc"><p>Same as the function above.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="BuildListProcessBotBase.BuildListProcessBotBase.expansion_locations_dict" class="name">var <span class="ident">expansion_locations_dict</span></p>
            

            
  
    <div class="desc"><p>Returns dict with the correct expansion position Point2 object as key,
resources as Units (mineral fields and vespene geysers) as value.</p>
<p>Caution: This function is slow. If you only need the expansion locations, use the property above.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="BuildListProcessBotBase.BuildListProcessBotBase.expansion_locations_list" class="name">var <span class="ident">expansion_locations_list</span></p>
            

            
  
    <div class="desc"><p>Returns a list of expansion positions, not sorted in any way.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="BuildListProcessBotBase.BuildListProcessBotBase.game_data" class="name">var <span class="ident">game_data</span></p>
            

            
  
    <div class="desc"><p>See game_data.py</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="BuildListProcessBotBase.BuildListProcessBotBase.game_info" class="name">var <span class="ident">game_info</span></p>
            

            
  
    <div class="desc"><p>See game_info.py</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="BuildListProcessBotBase.BuildListProcessBotBase.larva_count" class="name">var <span class="ident">larva_count</span></p>
            

            
  
    <div class="desc"><p>Replacement for self.state.common.larva_count https://github.com/Blizzard/s2client-proto/blob/d3d18392f9d7c646067d447df0c936a8ca57d587/s2clientprotocol/sc2api.proto#L614</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="BuildListProcessBotBase.BuildListProcessBotBase.leftExpansions" class="name">var <span class="ident">leftExpansions</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="BuildListProcessBotBase.BuildListProcessBotBase.loggerBase" class="name">var <span class="ident">loggerBase</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="BuildListProcessBotBase.BuildListProcessBotBase.main_base_ramp" class="name">var <span class="ident">main_base_ramp</span></p>
            

            
  
    <div class="desc"><p>Returns the Ramp instance of the closest main-ramp to start location.
Look in game_info.py for more information about the Ramp class</p>
<p>Example: See terran ramp wall bot</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="BuildListProcessBotBase.BuildListProcessBotBase.occupiedGeysers" class="name">var <span class="ident">occupiedGeysers</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="BuildListProcessBotBase.BuildListProcessBotBase.owned_expansions" class="name">var <span class="ident">owned_expansions</span></p>
            

            
  
    <div class="desc"><p>List of expansions owned by the player.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="BuildListProcessBotBase.BuildListProcessBotBase.playerString" class="name">var <span class="ident">playerString</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="BuildListProcessBotBase.BuildListProcessBotBase.remainingBuildTasks" class="name">var <span class="ident">remainingBuildTasks</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="BuildListProcessBotBase.BuildListProcessBotBase.rightExpansions" class="name">var <span class="ident">rightExpansions</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="BuildListProcessBotBase.BuildListProcessBotBase.start_location" class="name">var <span class="ident">start_location</span></p>
            

            
  
    <div class="desc"><p>Returns the spawn location of the bot, using the position of the first created townhall.
This will be None if the bot is run on an arcade or custom map that does not feature townhalls at game start.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="BuildListProcessBotBase.BuildListProcessBotBase.step_time" class="name">var <span class="ident">step_time</span></p>
            

            
  
    <div class="desc"><p>Returns a tuple of step duration in milliseconds.
First value is the minimum step duration - the shortest the bot ever took
Second value is the average step duration
Third value is the maximum step duration - the longest the bot ever took (including on_start())
Fourth value is the step duration the bot took last iteration
If called in the first iteration, it returns (inf, 0, 0, 0)</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="BuildListProcessBotBase.BuildListProcessBotBase.structures_without_construction_SCVs" class="name">var <span class="ident">structures_without_construction_SCVs</span></p>
            

            
  
    <div class="desc"><p>Returns all structures that do not have an SCV constructing it.
Warning: this function may move to become a Units filter.
New function. Please report any bugs!</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="BuildListProcessBotBase.BuildListProcessBotBase.time" class="name">var <span class="ident">time</span></p>
            

            
  
    <div class="desc"><p>Returns time in seconds, assumes the game is played on 'faster'</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="BuildListProcessBotBase.BuildListProcessBotBase.time_formatted" class="name">var <span class="ident">time_formatted</span></p>
            

            
  
    <div class="desc"><p>Returns time as string in min:sec format</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="BuildListProcessBotBase.BuildListProcessBotBase.topExpansions" class="name">var <span class="ident">topExpansions</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="BuildListProcessBotBase.BuildListProcessBotBase.units_created" class="name">var <span class="ident">units_created</span></p>
            

            
  
    <div class="desc"><p>Returns a Counter for all your units and buildings you have created so far.</p>
<p>This may be used for statistics (at the end of the game) or for strategic decision making.</p>
<p>CAUTION: This does not properly work at the moment for morphing units and structures. Please use the 'on_unit_type_changed' event to add these morphing unit types manually to 'self._units_created'.
Issues would arrise in e.g. siege tank morphing to sieged tank, and then morphing back (suddenly the counter counts 2 tanks have been created).</p>
<p>Examples::</p>
<div class="codehilite"><pre><span></span><span class="err">#</span><span class="w"> </span><span class="n">Give</span><span class="w"> </span><span class="n">attack</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">enemy</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="k">every</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="n">marines</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="n">trained</span><span class="w"></span>
<span class="n">async</span><span class="w"> </span><span class="n">def</span><span class="w"> </span><span class="n">on_unit_created</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">unit</span><span class="p">:</span><span class="w"> </span><span class="n">Unit</span><span class="p">)</span><span class="err">:</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">unit</span><span class="p">.</span><span class="nf">type_id</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">UnitTypeId</span><span class="p">.</span><span class="nl">MARINE</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">units_created</span><span class="o">[</span><span class="n">MARINE</span><span class="o">]</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="err">:</span><span class="w"></span>
<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">marine</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">units</span><span class="p">(</span><span class="n">UnitTypeId</span><span class="p">.</span><span class="n">MARINE</span><span class="p">)</span><span class="err">:</span><span class="w"></span>
<span class="w">                </span><span class="n">marine</span><span class="p">.</span><span class="n">attack</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">enemy_start_locations</span><span class="o">[</span><span class="n">0</span><span class="o">]</span><span class="p">)</span><span class="w"></span>
</pre></div></div>
  <div class="source_cont">
</div>

            </div>
      </div>
      </div>
      
      <div class="item">
      <p id="BuildListProcessBotBase.Player" class="name">class <span class="ident">Player</span></p>
      
  
    <div class="desc"><p>A way of differentiating players.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.Player', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.Player" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">Player</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A way of differentiating players.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">PLAYER_ONE</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">PLAYER_TWO</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#BuildListProcessBotBase.Player">Player</a></li>
          <li>enum.Enum</li>
          <li>builtins.object</li>
          </ul>
          <h3>Class variables</h3>
            <div class="item">
            <p id="BuildListProcessBotBase.Player.PLAYER_ONE" class="name">var <span class="ident">PLAYER_ONE</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="BuildListProcessBotBase.Player.PLAYER_TWO" class="name">var <span class="ident">PLAYER_TWO</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="BuildListProcessBotBase.Player.name" class="name">var <span class="ident">name</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="BuildListProcessBotBase.Player.value" class="name">var <span class="ident">value</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
      </div>
      </div>
      
      <div class="item">
      <p id="BuildListProcessBotBase.Winner" class="name">class <span class="ident">Winner</span></p>
      
  
    <div class="desc"><p>A way of differentiating winners.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-BuildListProcessBotBase.Winner', this);">Show source &equiv;</a></p>
  <div id="source-BuildListProcessBotBase.Winner" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">Winner</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A way of differentiating winners.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">PLAYER_ONE</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">PLAYER_TWO</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">UNKNOWN</span> <span class="o">=</span> <span class="mi">3</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#BuildListProcessBotBase.Winner">Winner</a></li>
          <li>enum.Enum</li>
          <li>builtins.object</li>
          </ul>
          <h3>Class variables</h3>
            <div class="item">
            <p id="BuildListProcessBotBase.Winner.PLAYER_ONE" class="name">var <span class="ident">PLAYER_ONE</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="BuildListProcessBotBase.Winner.PLAYER_TWO" class="name">var <span class="ident">PLAYER_TWO</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="BuildListProcessBotBase.Winner.UNKNOWN" class="name">var <span class="ident">UNKNOWN</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="BuildListProcessBotBase.Winner.name" class="name">var <span class="ident">name</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="BuildListProcessBotBase.Winner.value" class="name">var <span class="ident">value</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
      </div>
      </div>

  </section>

    </article>
  <div class="clear"> </div>
  <footer id="footer">
    <p>
      Documentation generated by
      <a href="https://github.com/BurntSushi/pdoc">pdoc 0.3.2</a>
    </p>

    <p>pdoc is in the public domain with the
      <a href="http://unlicense.org">UNLICENSE</a></p>

    <p>Design by <a href="http://nadh.in">Kailash Nadh</a></p>
  </footer>
</div>
</body>
</html>
